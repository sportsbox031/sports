<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤í¬ì¸ ë°•ìŠ¤ - ê²½ê¸°ë„ì²´ìœ¡íšŒ</title>

    <link rel="icon"
        href="https://static.readdy.ai/image/416007a89256a2717806f7776e859886/110ce5261818cd69133e46ef8c6b097a.png"
        type="image/png">

    <!-- ë„¤ì´ë²„ ì„œì¹˜ì–´ë“œë°”ì´ì € ì†Œìœ í™•ì¸ íƒœê·¸ - ì‹¤ì œ íƒœê·¸ëŠ” ë„¤ì´ë²„ì—ì„œ ì œê³µë©ë‹ˆë‹¤ -->
    <meta name="naver-site-verification" content="7d2fc828aa146612d27d875afdcfbad991a2910c" />

    <!-- ì—¬ê¸°ì— SEO ë©”íƒ€íƒœê·¸ ì¶”ê°€ -->
    <meta name="description"
        content="ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤ëŠ” ì°¾ì•„ê°€ëŠ” ìŠ¤í¬ì¸  í”„ë¡œê·¸ë¨, ìŠ¤í¬ì¸ êµì‹¤, ìŠ¤í¬ì¸ ì²´í—˜ì¡´, ìŠ¤í¬ì¸ ì´ë²¤íŠ¸ë¥¼ ìš´ì˜í•˜ì—¬ ëª¨ë“  ê²½ê¸°ë„ë¯¼ì—ê²Œ ìŠ¤í¬ì¸  ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì§€ê¸ˆ ë°”ë¡œ ì˜¨ë¼ì¸ìœ¼ë¡œ ì˜ˆì•½í•˜ì„¸ìš”!">
    <meta name="keywords" content="ê²½ê¸°ë„ì²´ìœ¡íšŒ, ìŠ¤í¬ì¸ ë°•ìŠ¤, ì°¾ì•„ê°€ëŠ” ìŠ¤í¬ì¸ , ìŠ¤í¬ì¸ êµì‹¤, ìŠ¤í¬ì¸ ì²´í—˜ì¡´, ìŠ¤í¬ì¸ ì´ë²¤íŠ¸, ìƒí™œì²´ìœ¡, ê²½ê¸°ë„, ì²´ìœ¡í™œë™, ìŠ¤í¬ì¸  í”„ë¡œê·¸ë¨, ì˜¨ë¼ì¸ ì˜ˆì•½">
    <meta name="author" content="ê²½ê¸°ë„ì²´ìœ¡íšŒ">

    <!-- Open Graph íƒœê·¸ -->
    <meta property="og:title" content="ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤ - ëª¨ë‘ë¥¼ ìœ„í•œ ìŠ¤í¬ì¸ ">
    <meta property="og:description"
        content="ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤ê°€ ì—¬ëŸ¬ë¶„ì˜ ê±´ê°•í•œ ìƒí™œì„ ì§€ì›í•©ë‹ˆë‹¤. ì°¾ì•„ê°€ëŠ” ìŠ¤í¬ì¸  í”„ë¡œê·¸ë¨ìœ¼ë¡œ ëª¨ë“  ë„ë¯¼ì´ ìŠ¤í¬ì¸ ë¥¼ ì¦ê¸¸ ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.">
    <meta property="og:image"
        content="https://static.readdy.ai/image/416007a89256a2717806f7776e859886/110ce5261818cd69133e46ef8c6b097a.png">
    <meta property="og:url" content="https://ggsportsbox.or.kr">
    <meta property="og:type" content="website">

    <!-- Twitter ì¹´ë“œ -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤">
    <meta name="twitter:description" content="ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤ê°€ ì—¬ëŸ¬ë¶„ì˜ ê±´ê°•í•œ ìƒí™œì„ ì§€ì›í•©ë‹ˆë‹¤.">
    <meta name="twitter:image"
        content="https://static.readdy.ai/image/416007a89256a2717806f7776e859886/110ce5261818cd69133e46ef8c6b097a.png">

    <!-- í‘œì¤€ ë§í¬ ì •ì˜ -->
    <link rel="canonical" href="https://ggsportsbox.or.kr">

    <!-- ìŠ¤íƒ€ì¼ì‹œíŠ¸ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet">

    <!-- Tailwind ì„¤ì • -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0066CC',
                        secondary: '#FF6B00'
                    },
                    borderRadius: {
                        'none': '0px',
                        'sm': '4px',
                        DEFAULT: '8px',
                        'md': '12px',
                        'lg': '16px',
                        'xl': '20px',
                        '2xl': '24px',
                        '3xl': '32px',
                        'full': '9999px',
                        'button': '8px'
                    }
                }
            }
        }
    </script>

    <!-- jsPDF ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ - PDF ìƒì„±ìš© -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- canvasë¥¼ ì‚¬ìš©í•˜ì—¬ í°íŠ¸ ë Œë”ë§ -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <!-- ë‚ ì§œ í¬ë§·íŒ… ìœ í‹¸ë¦¬í‹° -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/date-fns/2.29.3/date-fns.min.js"></script>

    <style>
        /* í™ˆí™”ë©´ ìŠ¤íƒ€ì¼ */
        :where([class^="ri-"])::before {
            content: "\f3c2";
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
        }

        .search-input:focus {
            outline: none;
        }

        .program-card:hover .program-detail {
            opacity: 1;
            transform: translateY(0);
        }

        /* ìº˜ë¦°ë” ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .calendar-day:hover {
            background-color: rgba(59, 130, 246, 0.1);
            transition: all 0.3s;
        }

        .selected {
            background-color: #3B82F6 !important;
            color: white !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            /* !important ì œê±° */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            overflow-y: auto;
            padding: 2rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
            /* !important ì œê±° */
            opacity: 1;
            visibility: visible;
        }

        /* ëª¨ë‹¬ ë‚´ìš© ì»¨í…Œì´ë„ˆ (ëª¨ë“  ëª¨ë‹¬ì— ì ìš©) */
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            width: 100%;
            max-width: 32rem;
            margin: 2rem auto;
            position: relative;
            z-index: 10001;
            /* ë†’ì€ z-indexë¡œ í†µì¼ */
            max-height: 80vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        /* ê³µì§€ì‚¬í•­ ëª¨ë‹¬ íŠ¹ë³„ ìŠ¤íƒ€ì¼ (ê³µì§€ì‚¬í•­ ëª¨ë‹¬ì—ë§Œ ì ìš©) */
        #noticeDetailModal {
            z-index: 10000;
            /* ëª¨ë‹¬ ì¤‘ì—ì„œ ê°€ì¥ ë†’ê²Œ ì„¤ì • */
            background-color: rgba(0, 0, 0, 0.7);
            /* ë” ì§„í•œ ë°°ê²½ìƒ‰ */
            padding: 0;
        }

        /* ì´ ë¶€ë¶„ ì¶”ê°€: ê³µì§€ì‚¬í•­ ëª¨ë‹¬ì´ show í´ë˜ìŠ¤ë¥¼ ê°€ì§ˆ ë•Œ */
        #noticeDetailModal.show {
            display: flex;
            opacity: 1;
            visibility: visible;
        }

        #noticeDetailModal:not(.hidden) {
            display: flex;
        }

        /* ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ë‚´ë¶€ ë ˆì´ì•„ì›ƒ */
        #noticeDetailModal>div {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ë‚´ìš©ë¬¼ */
        #noticeDetailModal .bg-white {
            max-width: 32rem;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border-radius: 1rem;
            padding: 2rem;
            width: 100%;
            margin: 2rem;
        }

        /* ìº˜ë¦°ë” ìŠ¤íƒ€ì¼ */
        .calendar-day {
            border-radius: 0.75rem;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .calendar-day.booked {
            background-color: #FEF3C7;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(251, 191, 36, 0.1);
        }

        .calendar-day.full {
            background-color: #FEE2E2 !important;
            cursor: not-allowed !important;
            box-shadow: 0 2px 4px rgba(239, 68, 68, 0.1) !important;
        }

        .calendar-day.past {
            background-color: #F3F4F6;
            cursor: not-allowed;
            color: #9CA3AF;
        }

        .calendar-day.blocked {
            background-color: #4B5563 !important;
            color: white !important;
            cursor: not-allowed !important;
            box-shadow: 0 2px 4px rgba(75, 85, 99, 0.2) !important;
        }

        .calendar-day.partially-blocked {
            background-color: #F97316 !important;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(249, 115, 22, 0.2);
        }

        /* ê´€ë¦¬ì ìº˜ë¦°ë” íŠ¹ìˆ˜ ìŠ¤íƒ€ì¼ */
        #adminCalendar .calendar-day.blocked,
        #adminCalendar .calendar-day.partially-blocked {
            cursor: pointer;
        }

        /* ê³µì§€ì‚¬í•­ ë””ìì¸ ê°œì„  */
        .notice-item {
            transition: all 0.3s ease;
            border-radius: 8px;
            padding: 16px;
        }

        .notice-item.important {
            background-color: #fff3e0;
            border-left: 4px solid #ff5722;
        }

        .notice-item:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
            background-color: rgba(240, 240, 250, 0.7);
        }

        .line-clamp-1 {
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .notice-tabs h3 {
            position: relative;
            transition: all 0.3s ease;
        }

        .notice-tabs h3:hover {
            color: #3B82F6;
        }

        .notice-item h4 {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        /* ë¡œë”© ì¸ë””ì¼€ì´í„° */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(4px);
        }

        .loading.show {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3B82F6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            box-shadow: 0 4px 6px rgba(59, 130, 246, 0.1);
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* ê¸°ì¡´ ë¡œë”© ìŠ¤íƒ€ì¼ í•˜ë‹¨ì— ì¶”ê°€ */
        .upload-progress-text {
            font-size: 16px;
            margin-top: 15px;
            color: white;
            text-align: center;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        .overflow-y-auto {
            scrollbar-width: thin;
            scrollbar-color: #CBD5E0 #EDF2F7;
        }

        .overflow-y-auto::-webkit-scrollbar {
            width: 6px;
        }

        .overflow-y-auto::-webkit-scrollbar-track {
            background: #EDF2F7;
            border-radius: 3px;
        }

        .overflow-y-auto::-webkit-scrollbar-thumb {
            background-color: #CBD5E0;
            border-radius: 3px;
            border: 2px solid #EDF2F7;
        }

        .overflow-y-auto::-webkit-scrollbar-thumb:hover {
            background-color: #A0AEC0;
        }

        /* í¼ ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤ ìŠ¤íƒ€ì¼ */
        .focus\:ring-2:focus {
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }

        /* ì§€ì—­ ì •ë³´ ë±ƒì§€ ìŠ¤íƒ€ì¼ */
        .region-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .region-badge.south {
            background-color: #EBF5FF;
            color: #1E40AF;
        }

        .region-badge.north {
            background-color: #F0FDF4;
            color: #166534;
        }

        /* í¼ ì…ë ¥ í•„ë“œ ê³µí†µ ìŠ¤íƒ€ì¼ */
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #E5E7EB;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            border-color: #3B82F6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.25);
            outline: none;
        }

        .form-input.error {
            border-color: #EF4444;
        }

        /* í¼ ë ˆì´ë¸” ìŠ¤íƒ€ì¼ */
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #374151;
        }

        /* í•„ìˆ˜ ì…ë ¥ í•„ë“œ í‘œì‹œ */
        .required::after {
            content: "*";
            color: #EF4444;
            margin-left: 0.25rem;
        }

        /* ìœ íš¨ì„± ê²€ì‚¬ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .validation-message {
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .validation-message.error {
            color: #EF4444;
        }

        .validation-message.success {
            color: #10B981;
        }
    </style>
</head>

<body class="bg-white">

    <!-- ë¡œë”© ì¸ë””ì¼€ì´í„° -->
    <div id="loading" class="loading">
        <div class="spinner"></div>
    </div>

    <!-- ì•Œë¦¼ ë©”ì‹œì§€ -->
    <div id="alert" class="fixed top-4 right-4 max-w-sm bg-white rounded-lg shadow-lg p-4 hidden z-50">
        <div class="flex items-center">
            <div id="alertIcon" class="flex-shrink-0">
                <i class="fas fa-info-circle text-blue-500"></i>
            </div>
            <div class="ml-3">
                <p id="alertMessage" class="text-sm text-gray-700"></p>
            </div>
            <button onclick="hideAlert()" class="ml-4">
                <i class="fas fa-times text-gray-400 hover:text-gray-500"></i>
            </button>
        </div>
    </div>

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div id="mainContainer">
        <!-- í™ˆí™”ë©´ -->
        <div id="homeScreen">
            <header class="fixed w-full bg-white shadow-sm z-50">
                <div class="container mx-auto px-6 py-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <img src="https://static.readdy.ai/image/416007a89256a2717806f7776e859886/110ce5261818cd69133e46ef8c6b097a.png"
                                alt="ê²½ê¸°ë„ì²´ìœ¡íšŒ ë¡œê³ " class="h-10">
                            <div class="text-2xl font-bold text-primary">ìŠ¤í¬ì¸ ë°•ìŠ¤</div>
                        </div>
                        <nav class="hidden md:flex items-center space-x-8">
                            <a href="#notices" class="text-gray-700 hover:text-primary py-2">ê³µì§€ì‚¬í•­</a>
                            <a href="#intro" class="text-gray-700 hover:text-primary py-2">ì‚¬ì—…ì†Œê°œ</a>
                            <a href="#programs" class="text-gray-700 hover:text-primary py-2">ìš´ì˜í”„ë¡œê·¸ë¨</a>
                            <a href="#process" class="text-gray-700 hover:text-primary py-2">ì‹ ì²­ì ˆì°¨</a>
                            <a href="#faq" class="text-gray-700 hover:text-primary py-2">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</a>
                            <button onclick="showLoginScreen()"
                                class="bg-primary text-white px-4 py-2 !rounded-button hover:bg-primary/90">
                                íšŒì›ê°€ì…/ë¡œê·¸ì¸
                            </button>
                        </nav>
                    </div>
                </div>
            </header>

            <main class="pt-20">
                <!-- ë©”ì¸ ë¹„ì£¼ì–¼ ì„¹ì…˜ -->
                <section class="relative h-[600px] bg-cover bg-no-repeat" style="background-image: url('https://raw.githubusercontent.com/sportsbox031/sports/main/ë©”ì¸ì‚¬ì§„2.png'); 
           background-position: center 20%;
           background-size: cover;">
                    <div class="absolute inset-0 bg-black/30"></div>
                    <div class="container mx-auto px-6 relative h-full flex items-center">
                        <div class="max-w-2xl">
                            <h1 class="text-6xl font-bold mb-6 text-white drop-shadow-lg">SPORTS BOX</h1>
                            <h2 class="text-4xl font-bold mb-6 text-primary drop-shadow">ëª¨ë‘ë¥¼ ìœ„í•œ ìŠ¤í¬ì¸ </h2>
                            <p class="text-xl mb-8 text-white drop-shadow-lg">ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤ê°€ ì—¬ëŸ¬ë¶„ì˜ ê±´ê°•í•œ ìƒí™œì„ ì§€ì›í•©ë‹ˆë‹¤</p>
                            <button onclick="showLoginScreen()"
                                class="!rounded-button bg-primary text-white px-8 py-3 text-lg hover:bg-primary/90 inline-block">
                                ì˜ˆì•½í•˜ê¸°
                            </button>
                        </div>
                    </div>
                </section>

                <!-- ì‚¬ì—…ì†Œê°œ ë° ê³µì§€ì‚¬í•­ ì„¹ì…˜ -->
                <section id="intro" class="py-20 bg-gray-50">
                    <div class="container mx-auto px-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                            <!-- ì™¼ìª½: ì‚¬ì—…ì†Œê°œ -->
                            <div>
                                <h2 class="text-3xl font-bold mb-8">ì‚¬ì—…ì†Œê°œ</h2>
                                <div class="mb-6">
                                    <img src="https://static.readdy.ai/image/416007a89256a2717806f7776e859886/37e4760851bd5a23c2838ccd027fd4f3.png"
                                        class="w-full h-auto rounded-lg shadow-lg" alt="ìŠ¤í¬ì¸ ë°•ìŠ¤ í™œë™">
                                </div>
                                <div>
                                    <h3 class="text-2xl font-bold mb-4">ì°¾ì•„ê°€ëŠ” ìŠ¤í¬ì¸  í”„ë¡œê·¸ë¨</h3>
                                    <p class="text-gray-600 leading-relaxed mb-6">
                                        ìŠ¤í¬ì¸ ë°•ìŠ¤ëŠ” ê²½ê¸°ë„ë¯¼ì˜ ê±´ê°•í•œ ìƒí™œì„ ìœ„í•´ ì°¾ì•„ê°€ëŠ” ìŠ¤í¬ì¸  í”„ë¡œê·¸ë¨ì„ ìš´ì˜í•©ë‹ˆë‹¤.
                                        ìŠ¤í¬ì¸  ì·¨ì•½ê³„ì¸µì„ ìœ„í•œ ë§ì¶¤í˜• í”„ë¡œê·¸ë¨ê³¼ ë‹¤ì–‘í•œ ì²´í—˜ ê¸°íšŒë¥¼ ì œê³µí•˜ì—¬
                                        ëª¨ë“  ë„ë¯¼ì´ ìŠ¤í¬ì¸ ë¥¼ ì¦ê¸¸ ìˆ˜ ìˆë„ë¡ ì§€ì›í•©ë‹ˆë‹¤.
                                    </p>
                                    <div class="flex space-x-4">
                                        <div class="flex items-center space-x-2">
                                            <i class="ri-user-heart-line text-primary text-xl"></i>
                                            <span>ì·¨ì•½ê³„ì¸µ ì§€ì›</span>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <i class="ri-community-line text-primary text-xl"></i>
                                            <span>ìƒí™œì²´ìœ¡ í™œì„±í™”</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ì˜¤ë¥¸ìª½: ê³µì§€ì‚¬í•­ -->
                            <div id="notices">
                                <div class="flex justify-between items-center mb-8">
                                    <h2 class="text-3xl font-bold">ê³µì§€ì‚¬í•­</h2>
                                    <div id="noticeActions" class="hidden"> <!-- ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹œ ë³´ì„ -->
                                        <button onclick="showNoticeWriteModal()"
                                            class="bg-primary text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                                            <i class="fas fa-pen"></i>
                                            <span>ê¸€ì“°ê¸°</span>
                                        </button>
                                    </div>
                                </div>
                                <div id="homeNoticesList"
                                    class="bg-white rounded-lg shadow-lg p-6 max-h-[500px] overflow-y-auto">
                                    <!-- ê³µì§€ì‚¬í•­ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
                                </div>
                            </div>
                        </div>
                    </div>
                </section>


                <!-- ê³µì§€ì‚¬í•­ ì‘ì„± ëª¨ë‹¬ -->
                <div id="noticeWriteModal" class="modal">
                    <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-2xl m-auto">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold">ê³µì§€ì‚¬í•­ ì‘ì„±</h2>
                            <button onclick="closeNoticeWriteModal()" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <form id="noticeWriteForm" class="space-y-4" enctype="multipart/form-data">
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ì œëª©</label>
                                <input type="text" id="noticeTitle" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ë‚´ìš©</label>
                                <textarea id="noticeContent" required rows="6"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"></textarea>
                            </div>
                            <!-- ì²¨ë¶€íŒŒì¼ í•„ë“œ ìˆ˜ì • -->
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ì²¨ë¶€íŒŒì¼</label>
                                <div class="flex items-center space-x-2">
                                    <input type="file" id="noticeFile" name="attachment" class="hidden"
                                        accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.hwp,.jpg,.jpeg,.png,.gif">
                                    <button type="button" onclick="document.getElementById('noticeFile').click()"
                                        class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors">
                                        íŒŒì¼ ì„ íƒ
                                    </button>
                                    <span id="selectedFileName" class="text-sm text-gray-600">ì„ íƒëœ íŒŒì¼ ì—†ìŒ</span>
                                </div>
                                <p class="text-xs text-gray-500 mt-1">ìµœëŒ€ íŒŒì¼ í¬ê¸°: 10MB (PDF, ì›Œë“œ, ì—‘ì…€, íŒŒì›Œí¬ì¸íŠ¸, í•œê¸€, ì´ë¯¸ì§€ íŒŒì¼)
                                </p>
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ê³µê°œ ë²”ìœ„</label>
                                <select id="noticeRegion" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                                    <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                                    <option value="all">ì „ì²´ ê³µê°œ</option>
                                    <option value="south">ë‚¨ë¶€ ì§€ì—­ë§Œ</option>
                                    <option value="north">ë¶ë¶€ ì§€ì—­ë§Œ</option>
                                </select>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="noticeImportant" class="w-4 h-4 text-blue-600 rounded">
                                <label for="noticeImportant" class="ml-2 text-gray-700 text-sm font-bold">ì¤‘ìš” ê³µì§€</label>
                            </div>
                            <button type="submit"
                                class="w-full bg-primary text-white py-2 rounded-lg hover:bg-primary/90 transition duration-200">
                                ë“±ë¡í•˜ê¸°
                            </button>
                        </form>
                    </div>
                </div>

                <!-- ìš´ì˜í”„ë¡œê·¸ë¨ ì„¹ì…˜ -->
                <section id="programs" class="py-20">
                    <div class="container mx-auto px-6">
                        <h2 class="text-3xl font-bold text-center mb-16">ìš´ì˜í”„ë¡œê·¸ë¨</h2>
                        <div class="grid md:grid-cols-3 gap-8">
                            <div class="program-card relative rounded-lg overflow-hidden shadow-lg">
                                <img src="https://static.readdy.ai/image/416007a89256a2717806f7776e859886/32c46d527cf6d2a7c9d564083dfe5195.png"
                                    class="w-full h-[300px] object-cover" alt="ìŠ¤í¬ì¸ êµì‹¤">
                                <div class="p-6 bg-white">
                                    <h3 class="text-xl font-bold mb-3">ìŠ¤í¬ì¸ êµì‹¤</h3>
                                    <p class="text-gray-600 mb-4">ì „ë¬¸ ê°•ì‚¬ì§„ì´ ì§ì ‘ ì°¾ì•„ê°€ëŠ” ë‰´ìŠ¤í¬ì¸  í”„ë¡œê·¸ë¨</p>
                                    <a href="https://www.youtube.com/watch?v=ui3qOANOOTI" target="_blank"
                                        class="inline-block bg-primary text-white px-4 py-2 !rounded-button hover:bg-primary/90">
                                        ìì„¸íˆë³´ê¸°
                                    </a>
                                </div>
                            </div>
                            <div class="program-card relative rounded-lg overflow-hidden shadow-lg">
                                <img src="https://static.readdy.ai/image/416007a89256a2717806f7776e859886/44959af536d5400000e12357a5586b8f.png"
                                    class="w-full h-[300px] object-cover" alt="ìŠ¤í¬ì¸ ì²´í—˜ì¡´">
                                <div class="p-6 bg-white">
                                    <h3 class="text-xl font-bold mb-3">ìŠ¤í¬ì¸ ì²´í—˜ì¡´</h3>
                                    <p class="text-gray-600 mb-4">ê²½ê¸°ë„ ë‚´ ìŠ¤í¬ì¸ ëŒ€íšŒ ë° ì§€ìì²´ ì¶•ì œ ì—°ê³„ ì²´í—˜ì¡´ ìš´ì˜</p>
                                    <a href="https://www.youtube.com/watch?v=cdOh5nLmQ-o" target="_blank"
                                        class="inline-block bg-primary text-white px-4 py-2 !rounded-button hover:bg-primary/90">
                                        ìì„¸íˆë³´ê¸°
                                    </a>
                                </div>
                            </div>
                            <div class="program-card relative rounded-lg overflow-hidden shadow-lg">
                                <img src="https://static.readdy.ai/image/416007a89256a2717806f7776e859886/ca135fc96b572c92d6c08bfcc5782da7.png"
                                    class="w-full h-[300px] object-cover" alt="ìŠ¤í¬ì¸ ì´ë²¤íŠ¸">
                                <div class="p-6 bg-white">
                                    <h3 class="text-xl font-bold mb-3">ìŠ¤í¬ì¸ ì´ë²¤íŠ¸</h3>
                                    <p class="text-gray-600 mb-4">ìˆ˜ìƒë ˆì €ìŠ¤í¬ì¸ , ìŠ¤í‚¤êµì‹¤ ë“± íŠ¹ë³„ í”„ë¡œê·¸ë¨ ìš´ì˜</p>
                                    <a href="https://www.youtube.com/watch?v=4nyB-iATP5k" target="_blank"
                                        class="inline-block bg-primary text-white px-4 py-2 !rounded-button hover:bg-primary/90">
                                        ìì„¸íˆë³´ê¸°
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ì‹ ì²­ì ˆì°¨ ì„¹ì…˜ -->
                <section id="process" class="py-20 bg-gray-50">
                    <div class="container mx-auto px-6">
                        <h2 class="text-3xl font-bold text-center mb-16">ì‹ ì²­ì ˆì°¨</h2>

                        <!-- ê°€ë¡œì„  ì œê±°í•˜ê³  ê·¸ë¦¬ë“œ ê°„ê²© ëŠ˜ë¦¼ -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                            <!-- 1ë²ˆì§¸ ì¤„ -->
                            <div
                                class="bg-white rounded-xl p-6 shadow-lg border-t-4 border-primary hover:shadow-xl transition-all duration-300">
                                <div class="flex items-center mb-4">
                                    <div
                                        class="w-12 h-12 bg-primary text-white rounded-full flex items-center justify-center text-xl font-bold">
                                        1</div>
                                    <h3 class="text-xl font-bold ml-3">íšŒì›ê°€ì…</h3>
                                </div>
                                <div class="text-center mt-2">
                                    <div class="text-3xl mb-3">âœï¸</div>
                                    <p class="text-gray-600">ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸°</p>
                                </div>
                            </div>

                            <div
                                class="bg-white rounded-xl p-6 shadow-lg border-t-4 border-blue-400 hover:shadow-xl transition-all duration-300">
                                <div class="flex items-center mb-4">
                                    <div
                                        class="w-12 h-12 bg-blue-400 text-white rounded-full flex items-center justify-center text-xl font-bold">
                                        2</div>
                                    <h3 class="text-xl font-bold ml-3">ë¡œê·¸ì¸</h3>
                                </div>
                                <div class="text-center mt-2">
                                    <div class="text-3xl mb-3">ğŸ”‘</div>
                                    <p class="text-gray-600">ìŠ¹ì¸ì™„ë£Œ í›„ ë¡œê·¸ì¸</p>
                                </div>
                            </div>

                            <div
                                class="bg-white rounded-xl p-6 shadow-lg border-t-4 border-indigo-400 hover:shadow-xl transition-all duration-300">
                                <div class="flex items-center mb-4">
                                    <div
                                        class="w-12 h-12 bg-indigo-400 text-white rounded-full flex items-center justify-center text-xl font-bold">
                                        3</div>
                                    <h3 class="text-xl font-bold ml-3">ë‚ ì§œ/ì‹œê°„ ì„ íƒ</h3>
                                </div>
                                <div class="text-center mt-2">
                                    <div class="text-3xl mb-3">ğŸ“…</div>
                                    <p class="text-gray-600">í¬ë§ ì¼ì • ì˜ˆì•½</p>
                                </div>
                            </div>

                            <div
                                class="bg-white rounded-xl p-6 shadow-lg border-t-4 border-purple-400 hover:shadow-xl transition-all duration-300">
                                <div class="flex items-center mb-4">
                                    <div
                                        class="w-12 h-12 bg-purple-400 text-white rounded-full flex items-center justify-center text-xl font-bold">
                                        4</div>
                                    <h3 class="text-xl font-bold ml-3">ìŠ¹ì¸ ëŒ€ê¸°</h3>
                                </div>
                                <div class="text-center mt-2">
                                    <div class="text-3xl mb-3">â³</div>
                                    <p class="text-gray-600">ê´€ë¦¬ì ê²€í†  ì¤‘</p>
                                </div>
                            </div>

                            <!-- 2ë²ˆì§¸ ì¤„ -->
                            <div
                                class="bg-white rounded-xl p-6 shadow-lg border-t-4 border-green-400 hover:shadow-xl transition-all duration-300">
                                <div class="flex items-center mb-4">
                                    <div
                                        class="w-12 h-12 bg-green-400 text-white rounded-full flex items-center justify-center text-xl font-bold">
                                        5</div>
                                    <h3 class="text-xl font-bold ml-3">ê´€ë¦¬ì ìŠ¹ì¸</h3>
                                </div>
                                <div class="text-center mt-2">
                                    <div class="text-3xl mb-3">âœ…</div>
                                    <p class="text-gray-600">ì˜ˆì•½ ìŠ¹ì¸ ì™„ë£Œ</p>
                                </div>
                            </div>

                            <div
                                class="bg-white rounded-xl p-6 shadow-lg border-t-4 border-yellow-400 hover:shadow-xl transition-all duration-300">
                                <div class="flex items-center mb-4">
                                    <div
                                        class="w-12 h-12 bg-yellow-400 text-white rounded-full flex items-center justify-center text-xl font-bold">
                                        6</div>
                                    <h3 class="text-xl font-bold ml-3">ì˜ˆì•½í™•ì •</h3>
                                </div>
                                <div class="text-center mt-2">
                                    <div class="text-3xl mb-3">ğŸ«</div>
                                    <p class="text-gray-600">ì„œë¹„ìŠ¤ ì´ìš© ê°€ëŠ¥</p>
                                </div>
                            </div>

                            <div
                                class="bg-white rounded-xl p-6 shadow-lg border-t-4 border-orange-400 hover:shadow-xl transition-all duration-300">
                                <div class="flex items-center mb-4">
                                    <div
                                        class="w-12 h-12 bg-orange-400 text-white rounded-full flex items-center justify-center text-xl font-bold">
                                        7</div>
                                    <h3 class="text-xl font-bold ml-3">ì˜ˆì•½ ì •ë³´í™•ì¸</h3>
                                </div>
                                <div class="text-center mt-2">
                                    <div class="text-3xl mb-3">ğŸ“‹</div>
                                    <p class="text-gray-600">ëŒ€ì‹œë³´ë“œì—ì„œ í™•ì¸</p>
                                </div>
                            </div>

                            <!-- ë²„íŠ¼ ì„¹ì…˜ -->
                            <div
                                class="bg-gradient-to-r from-primary to-primary/80 rounded-xl p-6 shadow-lg flex flex-col justify-center items-center text-white">
                                <div class="text-4xl mb-4">ğŸš€</div>
                                <h3 class="text-xl font-bold mb-2">ì§€ê¸ˆ ë°”ë¡œ ì‹œì‘í•˜ì„¸ìš”!</h3>
                                <p class="mb-4 text-white/80 text-center">ì˜ˆì•½ ë° ê´€ë¦¬ê°€ í¸ë¦¬í•©ë‹ˆë‹¤</p>
                                <button onclick="showLoginScreen()"
                                    class="bg-white text-primary font-bold px-6 py-3 rounded-full hover:bg-gray-100 transition-all duration-200 shadow-md">
                                    ì‹œì‘í•˜ê¸°
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ ì„¹ì…˜ -->
                <section id="faq" class="py-20 bg-white">
                    <div class="container mx-auto px-6">
                        <h2 class="text-3xl font-bold text-center mb-16">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</h2>
                        <div class="max-w-3xl mx-auto">
                            <!-- ì§ˆë¬¸ 1 -->
                            <div class="mb-8 bg-gray-50 rounded-xl overflow-hidden shadow-sm">
                                <div class="p-6">
                                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                        <span
                                            class="bg-primary text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 flex-shrink-0">Q</span>
                                        ìš”ì¼ì„ ì§€ì •í•´ì„œ ì •ê¸°ì ìœ¼ë¡œ ìš´ì˜í•´ì£¼ì‹¤ ìˆ˜ ìˆë‚˜ìš”?
                                    </h3>
                                    <div class="pl-11">
                                        <p class="text-gray-600">ì •ê¸° ìš´ì˜ì€ í˜„ì¬ ì–´ë µìŠµë‹ˆë‹¤. ì €í¬ëŠ” ë” ë§ì€ ì•„ì´ë“¤ì—ê²Œ ê³µí‰í•œ í˜œíƒì„ ì œê³µí•˜ê¸° ìœ„í•´ ë§¤ì›” ì„ ì°©ìˆœ
                                            ì ‘ìˆ˜ ë°©ì‹ìœ¼ë¡œ ìš´ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- ì§ˆë¬¸ 2 -->
                            <div class="mb-8 bg-gray-50 rounded-xl overflow-hidden shadow-sm">
                                <div class="p-6">
                                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                        <span
                                            class="bg-primary text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 flex-shrink-0">Q</span>
                                        ìŠ¤í¬ì¸ ì²´í—˜ì¡´ì€ ì–´ë–»ê²Œ ìš´ì˜ë˜ë‚˜ìš”?
                                    </h3>
                                    <div class="pl-11">
                                        <p class="text-gray-600">ìŠ¤í¬ì¸ ì²´í—˜ì¡´ì€ ë„ë‚´ ê³µì§ìœ ê´€ë‹¨ì²´ ë° ì§€ìì²´ì—ì„œ ì§„í–‰í•˜ëŠ” í–‰ì‚¬ë¥¼ ëŒ€ìƒìœ¼ë¡œ ìš´ì˜ë©ë‹ˆë‹¤. ì²´í—˜ì¡´ì—ì„œëŠ”
                                            í•œê¶ì²´í—˜, í›„í¬ë³¼, ë°°íŒ…ì²´í—˜, íƒêµ¬(ìŠ¤íŒŒì´ë”ë³¼) ë“± ë‹¤ì–‘í•œ ìŠ¤í¬ì¸  í™œë™ì„ ì²´í—˜í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- ì§ˆë¬¸ 3 -->
                            <div class="mb-8 bg-gray-50 rounded-xl overflow-hidden shadow-sm">
                                <div class="p-6">
                                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                        <span
                                            class="bg-primary text-white rounded-full w-8 h-8 flex items-center justify-center mr-3 flex-shrink-0">Q</span>
                                        ìŠ¤í¬ì¸ ì´ë²¤íŠ¸ëŠ” ëˆ„êµ¬ë‚˜ ì‹ ì²­ ê°€ëŠ¥í•œê°€ìš”?
                                    </h3>
                                    <div class="pl-11">
                                        <p class="text-gray-600">ìŠ¤í¬ì¸ ì´ë²¤íŠ¸ëŠ” ìŠ¤í¬ì¸ êµì‹¤ ì°¸ì—¬ìì— í•œí•˜ì—¬ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê³„ì ˆì— ë”°ë¼ ì—¬ë¦„ì—ëŠ” ìˆ˜ìƒë ˆì €ìŠ¤í¬ì¸ ,
                                            ê²¨ìš¸ì—ëŠ” ìŠ¤í‚¤êµì‹¤ì„ ìš´ì˜í•˜ê³  ìˆìœ¼ë‹ˆ ë§ì€ ê´€ì‹¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- í‘¸í„° -->
                <footer class="bg-gray-900 text-white py-12">
                    <div class="container mx-auto px-6">
                        <div class="grid md:grid-cols-4 gap-8">
                            <div>
                                <h3 class="text-lg font-bold mb-4">ìŠ¤í¬ì¸ ë°•ìŠ¤</h3>
                                <p class="text-gray-400">ê²½ê¸°ë„ì²´ìœ¡íšŒ</p>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold mb-4">ì—°ë½ì²˜</h3>
                                <p class="text-gray-400">ì „í™”: 031-250-0474~7</p>
                                <p class="text-gray-400">ì´ë©”ì¼: <a href="mailto:hoseok0119@ggsc.or.kr"
                                        class="hover:text-white">hoseok0119@ggsc.or.kr</a></p>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold mb-4">ìš´ì˜ì‹œê°„</h3>
                                <p class="text-gray-400">í‰ì¼: 09:00 - 18:00</p>
                                <p class="text-gray-400">ì£¼ë§ ë° ê³µíœ´ì¼ íœ´ë¬´</p>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold mb-4">SNS</h3>
                                <div class="flex space-x-4">
                                    <a href="https://www.youtube.com/@%EC%8A%A4%ED%8F%AC%EC%B8%A0%EB%B0%95%EC%8A%A4-l7e"
                                        target="_blank" class="text-gray-400 hover:text-white">
                                        <i class="ri-youtube-fill text-xl"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                            <p>&copy; 2025 ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤. All rights reserved.</p>
                        </div>
                    </div>
                </footer>
            </main>
        </div>

        <!-- ë¡œê·¸ì¸/ì˜ˆì•½ì‹œìŠ¤í…œ ì»¨í…Œì´ë„ˆ -->
        <div id="loginAndReservationSystem" class="hidden">
            <!-- ë¡œê·¸ì¸ í™”ë©´ -->
            <div id="loginScreen"
                class="min-h-screen bg-gradient-to-br from-indigo-50 to-purple-50 flex items-center justify-center p-4">
                <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-md">
                    <!-- í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼ -->
                    <div class="text-right mb-4">
                        <button onclick="showHomeScreen()" class="text-gray-600 hover:text-gray-800">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="text-center mb-8">
                        <i class="fas fa-running text-4xl text-indigo-600 mb-4"></i>
                        <h1 class="text-2xl font-bold text-gray-800">ìŠ¤í¬ì¸ ë°•ìŠ¤ ë¡œê·¸ì¸</h1>
                        <p class="text-gray-500 mt-2">ìŠ¤í¬ì¸ ë°•ìŠ¤ ì˜ˆì•½ ì‹œìŠ¤í…œì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤</p>
                    </div>
                    <form id="loginForm" class="space-y-6">
                        <div>
                            <label class="block text-gray-700 text-sm font-semibold mb-2">ë‹¨ì²´ëª…</label>
                            <div class="relative">
                                <i class="fas fa-user absolute left-3 top-3.5 text-gray-400"></i>
                                <input type="text" id="username" required
                                    class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent">
                            </div>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-semibold mb-2">ë¹„ë°€ë²ˆí˜¸</label>
                            <div class="relative">
                                <i class="fas fa-lock absolute left-3 top-3.5 text-gray-400"></i>
                                <input type="password" id="password" required
                                    class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent">
                            </div>
                        </div>
                        <button type="submit"
                            class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-lg hover:from-indigo-700 hover:to-purple-700 transition duration-200 font-medium shadow-lg">
                            ë¡œê·¸ì¸
                        </button>
                    </form>
                    <button id="showSignup"
                        class="w-full mt-4 bg-gray-50 text-gray-700 py-3 rounded-lg hover:bg-gray-100 transition duration-200 font-medium border border-gray-200">
                        íšŒì›ê°€ì…
                    </button>
                </div>
            </div>

            <!-- ê³µì§€ì‚¬í•­ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ -->
            <div id="noticeDetailModal" class="fixed inset-0 bg-black bg-opacity-50 z-50">
                <div class="flex items-center justify-center min-h-screen p-4">
                    <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full p-6 relative">
                        <button onclick="closeNoticeDetail()"
                            class="absolute top-4 right-4 text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                        <h2 id="noticeDetailTitle" class="text-2xl font-bold mb-4"></h2>
                        <div class="flex justify-between text-sm text-gray-500 mb-4">
                            <span id="noticeDetailAuthor"></span>
                            <span id="noticeDetailDate"></span>
                        </div>
                        <div class="border-t pt-4">
                            <p id="noticeDetailContent" class="text-gray-700 whitespace-pre-line"></p>
                        </div>
                        <div id="noticeDetailActions" class="flex justify-end space-x-2 mt-6 pt-4 border-t hidden">
                            <button onclick="editNotice()"
                                class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                                ìˆ˜ì •
                            </button>
                            <button onclick="deleteNotice()"
                                class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                                ì‚­ì œ
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- íšŒì›ê°€ì… ëª¨ë‹¬ -->
            <div id="signupModal" class="modal">
                <div class="bg-white p-8 rounded-lg shadow-md w-96 m-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">íšŒì›ê°€ì…</h2>
                        <button id="closeSignup" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="signupForm" class="space-y-4">
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">ë‹¨ì²´ëª…</label>
                            <input type="text" id="groupName" required placeholder="ì˜ˆ: ìˆ˜ì›ì´ˆë“±í•™êµ ë˜ëŠ” í–‰ë³µí•œì§€ì—­ì•„ë™ì„¼í„°"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">ë¹„ë°€ë²ˆí˜¸</label>
                            <input type="password" id="signupPassword" required minlength="6"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                            <p class="text-sm text-gray-500 mt-1">6ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">ë‹´ë‹¹ì</label>
                            <input type="text" id="manager" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">ì‹œ/êµ°</label>
                            <select id="city" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                                <option value="">ì‹œ/êµ°ì„ ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                            <p id="regionInfo" class="text-sm text-gray-500 mt-1"></p>
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">ì—°ë½ì²˜</label>
                            <input type="text" id="contact" required placeholder="ì˜ˆ: 01012345678 ë˜ëŠ” 010-1234-5678"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                        </div>

                        <!-- ê°œì¸ì •ë³´ë™ì˜ ì„¹ì…˜ ì¶”ê°€ -->
                        <div class="mt-4">
                            <label class="block text-gray-700 text-sm font-bold mb-2">ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜</label>
                            <div
                                class="bg-gray-50 p-3 rounded-lg text-sm h-40 overflow-y-auto mb-2 text-gray-700 border border-gray-300">
                                <p class="font-bold mb-2">ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜</p>
                                <p class="mb-2">ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤ëŠ” íšŒì›ê°€ì… ë° ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ ê°œì¸ì •ë³´ë¥¼ ìˆ˜ì§‘Â·ì´ìš©í•©ë‹ˆë‹¤.</p>
                                <p class="font-semibold mt-3">1. ìˆ˜ì§‘í•˜ëŠ” ê°œì¸ì •ë³´ í•­ëª©</p>
                                <p>- í•„ìˆ˜í•­ëª©: ë‹¨ì²´ëª…, ë‹´ë‹¹ìëª…, ì‹œ/êµ°, ì—°ë½ì²˜</p>
                                <p class="font-semibold mt-3">2. ê°œì¸ì •ë³´ì˜ ìˆ˜ì§‘ ë° ì´ìš© ëª©ì </p>
                                <p>- ìŠ¤í¬ì¸ ë°•ìŠ¤ ì˜ˆì•½ ì„œë¹„ìŠ¤ ì œê³µ ë° ê´€ë¦¬</p>
                                <p>- í”„ë¡œê·¸ë¨ ì•ˆë‚´ ë° ê³µì§€ì‚¬í•­ ì „ë‹¬</p>
                                <p class="font-semibold mt-3">3. ê°œì¸ì •ë³´ì˜ ë³´ìœ  ë° ì´ìš© ê¸°ê°„</p>
                                <p>- íšŒì› íƒˆí‡´ ì‹œê¹Œì§€ (ë‹¨, ê´€ê³„ ë²•ë ¹ì— ë”°ë¼ ë³´ì¡´í•  í•„ìš”ê°€ ìˆëŠ” ê²½ìš° í•´ë‹¹ ê¸°ê°„ ë™ì•ˆ ë³´ì¡´)</p>
                                <p class="font-semibold mt-3">4. ë™ì˜ ê±°ë¶€ ê¶Œë¦¬ ë° ê±°ë¶€ ì‹œ ë¶ˆì´ìµ</p>
                                <p>- ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜ë¥¼ ê±°ë¶€í•  ê¶Œë¦¬ê°€ ìˆìœ¼ë‚˜, ë™ì˜ ê±°ë¶€ ì‹œ íšŒì›ê°€ì… ë° ì„œë¹„ìŠ¤ ì´ìš©ì´ ì œí•œë©ë‹ˆë‹¤.</p>
                            </div>
                            <div class="flex items-center">
                                <input type="checkbox" id="privacyConsent" required class="w-4 h-4 text-blue-600">
                                <label for="privacyConsent" class="ml-2 text-gray-700 text-sm">
                                    ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤. <span class="text-red-500">(í•„ìˆ˜)</span>
                                </label>
                            </div>
                        </div>

                        <button type="submit"
                            class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition duration-200">
                            ê°€ì…í•˜ê¸°
                        </button>
                    </form>
                </div>
            </div>

            <!-- ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ -->
            <div id="userDashboard" class="hidden">
                <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
                <nav class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg">
                    <div class="container mx-auto px-4 py-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-running text-2xl"></i>
                                <span class="dashboard-title text-2xl font-bold">ìŠ¤í¬ì¸ ë°•ìŠ¤</span>
                            </div>
                            <div class="flex items-center space-x-4">
                                <span id="regionBadge"
                                    class="px-3 py-1 rounded-full text-sm font-medium bg-white/20"></span>
                                <span id="userGroupName" class="text-sm bg-white/20 px-4 py-2 rounded-full"></span>
                                <button onclick="showUserProfileModal()"
                                    class="flex items-center space-x-2 hover:bg-white/20 px-4 py-2 rounded-full transition-all duration-200">
                                    <i class="fas fa-user"></i>
                                    <span>ê³„ì •ê´€ë¦¬</span>
                                </button>
                                <button onclick="showHomeScreen()"
                                    class="flex items-center space-x-2 hover:bg-white/20 px-4 py-2 rounded-full transition-all duration-200">
                                    <i class="fas fa-home"></i>
                                    <span>í™ˆìœ¼ë¡œ</span>
                                </button>
                                <button id="logoutBtn"
                                    class="flex items-center space-x-2 hover:bg-white/20 px-4 py-2 rounded-full transition-all duration-200">
                                    <i class="fas fa-sign-out-alt"></i>
                                    <span>ë¡œê·¸ì•„ì›ƒ</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </nav>

                <main class="container mx-auto px-4 py-8">
                    <div class="grid md:grid-cols-2 gap-8">
                        <!-- ìº˜ë¦°ë” ì„¹ì…˜ -->
                        <div class="bg-white rounded-2xl shadow-xl p-8">
                            <div class="flex justify-between items-center mb-8">
                                <h2 class="text-xl font-bold text-gray-800">ì˜ˆì•½ í˜„í™©</h2>
                                <div class="flex items-center space-x-4 bg-gray-50 p-2 rounded-xl">
                                    <button id="prevMonth"
                                        class="w-10 h-10 flex items-center justify-center hover:bg-white rounded-lg transition-colors duration-200">
                                        <i class="fas fa-chevron-left text-indigo-600"></i>
                                    </button>
                                    <span id="currentMonth"
                                        class="text-lg font-medium text-gray-700 min-w-[120px] text-center"></span>
                                    <button id="nextMonth"
                                        class="w-10 h-10 flex items-center justify-center hover:bg-white rounded-lg transition-colors duration-200">
                                        <i class="fas fa-chevron-right text-indigo-600"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="grid grid-cols-7 gap-2 mb-2">
                                <div class="text-center font-medium text-gray-600">ì¼</div>
                                <div class="text-center font-medium text-gray-600">ì›”</div>
                                <div class="text-center font-medium text-gray-600">í™”</div>
                                <div class="text-center font-medium text-gray-600">ìˆ˜</div>
                                <div class="text-center font-medium text-gray-600">ëª©</div>
                                <div class="text-center font-medium text-gray-600">ê¸ˆ</div>
                                <div class="text-center font-medium text-gray-600">í† </div>
                            </div>
                            <div id="calendar" class="grid grid-cols-7 gap-2"></div>
                            <div class="mt-4 flex justify-end space-x-4">
                                <div class="flex items-center">
                                    <div class="w-4 h-4 bg-yellow-100 rounded mr-2"></div>
                                    <span class="text-sm text-gray-600">1ê°œë§ˆê°</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-4 h-4 bg-red-100 rounded mr-2"></div>
                                    <span class="text-sm text-gray-600">ì˜ˆì•½ë§ˆê°</span>
                                </div>
                                <div class="flex items-center">
                                    <div class="w-4 h-4 bg-gray-600 rounded mr-2"></div>
                                    <span class="text-sm text-gray-600">ê´€ë¦¬ìë§ˆê°</span>
                                </div>
                            </div>
                        </div>

                        <!-- ì˜ˆì•½ ì •ë³´ ì„¹ì…˜ -->
                        <div class="bg-white rounded-2xl shadow-xl p-8">
                            <div class="flex justify-between items-center mb-8">
                                <h2 class="text-xl font-bold text-gray-800">ì˜ˆì•½í•˜ê¸°</h2>
                                <div id="remainingBookings"
                                    class="px-4 py-2 bg-green-50 text-green-700 rounded-full text-sm font-medium">
                                    ì´ë²ˆ ë‹¬ ë‚¨ì€ ì˜ˆì•½ ê°€ëŠ¥ íšŸìˆ˜: 4íšŒ
                                </div>
                            </div>
                            <form id="bookingForm" class="space-y-8">
                                <div class="bg-gray-50 p-6 rounded-xl">
                                    <label class="block text-gray-700 font-medium mb-2">ì„ íƒëœ ë‚ ì§œ</label>
                                    <input type="text" id="selectedDate" readonly required
                                        class="w-full p-4 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-400 focus:border-transparent">
                                </div>

                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-gray-700 font-medium mb-2">ì‹œì‘ ì‹œê°„</label>
                                        <select id="startTime" required
                                            class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:border-transparent">
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 font-medium mb-2">ì¢…ë£Œ ì‹œê°„</label>
                                        <select id="endTime" required
                                            class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:border-transparent">
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 font-medium mb-2">ì¸ì›</label>
                                        <input type="number" id="people" required min="1"
                                            class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:border-transparent">
                                        <p class="text-sm text-gray-500 mt-2">ìˆ˜ì—… ì¸ì›ì„ ì…ë ¥í•˜ì„¸ìš”</p>
                                    </div>
                                    <div>
                                        <label class="block text-gray-700 font-medium mb-2">ì¥ì†Œ</label>
                                        <input type="text" id="place" required
                                            class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-400 focus:border-transparent"
                                            placeholder="ìˆ˜ì—… ì¥ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                                    </div>
                                </div>

                                <button type="submit"
                                    class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-4 rounded-xl hover:from-indigo-700 hover:to-purple-700 transition duration-200 font-medium shadow-lg">
                                    ì˜ˆì•½í•˜ê¸°
                                </button>
                            </form>
                        </div>

                        <!-- ë‚´ ì˜ˆì•½ ëª©ë¡ -->
                        <div class="mt-8 bg-white rounded-lg shadow-lg p-6 col-span-2">
                            <h2 class="text-xl font-bold text-gray-700 mb-6">ë‚´ ì˜ˆì•½ ëª©ë¡</h2>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead>
                                        <tr>
                                            <th
                                                class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ë‚ ì§œ</th>
                                            <th
                                                class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ì‹œê°„</th>
                                            <th
                                                class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ì¥ì†Œ</th>
                                            <th
                                                class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ì¸ì›</th>
                                            <th
                                                class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ìƒíƒœ</th>
                                            <th
                                                class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ê´€ë¦¬</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bookingsList" class="bg-white divide-y divide-gray-200">
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- ì—¬ê¸°ì— ê³µì§€ì‚¬í•­ ì„¹ì…˜ ì¶”ê°€ -->
                        <div class="mt-8 bg-white rounded-2xl shadow-xl p-8 col-span-2">
                            <h2 class="text-xl font-bold text-gray-800 mb-6">ê³µì§€ì‚¬í•­</h2>
                            <div id="noticesListSection" class="grid gap-6">
                                <!-- ê³µì§€ì‚¬í•­ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
                            </div>
                        </div>
                    </div>

                    <!-- ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ë‚´ì— ë¬¸ì˜ì‚¬í•­ ì„¹ì…˜ ì¶”ê°€ -->
                    <div class="mt-8 bg-white rounded-2xl shadow-xl p-8 col-span-2">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-bold text-gray-800">ë‚´ ë¬¸ì˜ì‚¬í•­</h2>
                            <button onclick="showInquiryWriteModal()"
                                class="bg-primary text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                                <i class="fas fa-pen"></i>
                                <span>ë¬¸ì˜í•˜ê¸°</span>
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead>
                                    <tr>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì¹´í…Œê³ ë¦¬</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì œëª©</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì‘ì„±ì¼</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ìƒíƒœ</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ê´€ë¦¬</th>
                                    </tr>
                                </thead>
                                <tbody id="userInquiriesList" class="bg-white divide-y divide-gray-200">
                                    <!-- ì‚¬ìš©ì ë¬¸ì˜ì‚¬í•­ ëª©ë¡ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </main>
            </div>

            <!-- ì‚¬ìš©ì í”„ë¡œí•„ ê´€ë¦¬ ëª¨ë‹¬ -->
            <div id="userProfileModal" class="modal">
                <div class="bg-white p-8 rounded-lg shadow-md w-[500px] m-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">ê³„ì • ì •ë³´ ê´€ë¦¬</h2>
                        <button id="closeUserProfile" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="userProfileForm" class="space-y-6">
                        <!-- ê¸°ë³¸ ì •ë³´ ì„¹ì…˜ -->
                        <div class="space-y-4">
                            <h3 class="text-lg font-semibold text-gray-700">ê¸°ë³¸ ì •ë³´</h3>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ë‹¨ì²´ëª…</label>
                                <input type="text" id="userGroupName" disabled
                                    class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ë‹´ë‹¹ì</label>
                                <input type="text" id="userManager" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ì—°ë½ì²˜</label>
                                <input type="text" id="userContact" required pattern="[0-9]{2,3}-[0-9]{3,4}-[0-9]{4}"
                                    placeholder="ì˜ˆ: 010-1234-5678"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>
                        </div>

                        <!-- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì„¹ì…˜ -->
                        <div class="space-y-4 pt-4 border-t">
                            <h3 class="text-lg font-semibold text-gray-700">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h3>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
                                <input type="password" id="userCurrentPassword"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                                <input type="password" id="userNewPassword"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                                <input type="password" id="userConfirmPassword"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                            </div>
                            <p class="text-sm text-gray-500">* ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ë¹„ì›Œë‘ì„¸ìš”</p>
                        </div>

                        <button type="submit"
                            class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition duration-200">
                            ì •ë³´ ìˆ˜ì •
                        </button>
                    </form>
                </div>
            </div>

            <!-- ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ -->
            <div id="adminDashboard" class="hidden">
                <!-- ê´€ë¦¬ì ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
                <nav class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg">
                    <div class="container mx-auto px-4 py-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-running text-2xl"></i>
                                <span class="dashboard-title text-2xl font-bold">ìŠ¤í¬ì¸ ë°•ìŠ¤ ê´€ë¦¬ì</span>
                            </div>
                            <div class="flex items-center space-x-6">
                                <!-- ì§€ì—­ ì„ íƒ í•„í„° -->
                                <div id="regionFilterContainer"
                                    class="flex items-center space-x-2 bg-white/20 rounded-lg px-4 py-2">
                                    <span class="text-sm font-medium">ì§€ì—­ ì„ íƒ:</span>
                                    <select id="regionFilter"
                                        class="bg-transparent border-none text-white focus:ring-0 cursor-pointer font-medium">
                                        <option value="all" class="bg-white text-gray-700">ì „ì²´ ì§€ì—­</option>
                                        <option value="south" class="bg-white text-gray-700">ë‚¨ë¶€</option>
                                        <option value="north" class="bg-white text-gray-700">ë¶ë¶€</option>
                                    </select>
                                </div>
                                <!-- ê´€ë¦¬ì ì •ë³´ -->
                                <span id="adminRegionBadge"
                                    class="px-3 py-1 rounded-full text-sm font-medium bg-white/20"></span>
                                <span id="adminName" class="text-sm bg-white/20 px-4 py-2 rounded-full"></span>
                                <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
                                <button onclick="showHomeScreen()"
                                    class="flex items-center space-x-2 hover:bg-white/20 px-4 py-2 rounded-full transition-all duration-200">
                                    <i class="fas fa-home"></i>
                                    <span>í™ˆìœ¼ë¡œ</span>
                                </button>
                                <!-- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ë²„íŠ¼ ì¶”ê°€ -->
                                <button onclick="showChangePasswordModal()"
                                    class="flex items-center space-x-2 hover:bg-white/20 px-4 py-2 rounded-full transition-all duration-200">
                                    <i class="fas fa-key"></i>
                                    <span>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</span>
                                </button>

                                <!-- ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ -->
                                <button id="adminLogoutBtn"
                                    class="flex items-center space-x-2 hover:bg-white/20 px-4 py-2 rounded-full transition-all duration-200">
                                    <i class="fas fa-sign-out-alt"></i>
                                    <span>ë¡œê·¸ì•„ì›ƒ</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </nav>

                <!-- ê´€ë¦¬ì í†µê³„ ì„¹ì…˜ -->
                <div class="container mx-auto px-4 py-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                        <!-- ë‚¨ë¶€ í†µê³„ -->
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">ë‚¨ë¶€ ì§€ì—­ í˜„í™©</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="bg-blue-50 rounded-lg p-4">
                                    <p class="text-sm text-gray-600">ê¸ˆì¼ ì˜ˆì•½</p>
                                    <p id="southTodayBookings" class="text-2xl font-bold text-blue-600">0ê±´</p>
                                </div>
                                <div class="bg-green-50 rounded-lg p-4">
                                    <p class="text-sm text-gray-600">ì´ë²ˆ ë‹¬ ì´ ì˜ˆì•½</p>
                                    <p id="southMonthBookings" class="text-2xl font-bold text-green-600">0ê±´</p>
                                </div>
                            </div>
                        </div>
                        <!-- ë¶ë¶€ í†µê³„ -->
                        <div class="bg-white rounded-xl shadow-lg p-6">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">ë¶ë¶€ ì§€ì—­ í˜„í™©</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="bg-blue-50 rounded-lg p-4">
                                    <p class="text-sm text-gray-600">ê¸ˆì¼ ì˜ˆì•½</p>
                                    <p id="northTodayBookings" class="text-2xl font-bold text-blue-600">0ê±´</p>
                                </div>
                                <div class="bg-green-50 rounded-lg p-4">
                                    <p class="text-sm text-gray-600">ì´ë²ˆ ë‹¬ ì´ ì˜ˆì•½</p>
                                    <p id="northMonthBookings" class="text-2xl font-bold text-green-600">0ê±´</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ê´€ë¦¬ì ë©”ì¸ ì»¨í…ì¸  -->
                <div class="container mx-auto px-4 py-8">
                    <!-- ì˜ˆì•½ ì‹œìŠ¤í…œ ì„¤ì • ì„¹ì…˜ -->
                    <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
                        <h2 class="text-xl font-bold text-gray-800 mb-6">ì˜ˆì•½ ì‹œìŠ¤í…œ ê´€ë¦¬</h2>
                        <div class="flex items-center justify-between p-6 bg-gray-50 rounded-xl">
                            <div class="flex flex-col">
                                <span class="text-lg font-semibold text-gray-700">ì˜ˆì•½ ìƒíƒœ</span>
                                <span id="bookingStatusText" class="text-sm text-gray-500">
                                    í˜„ì¬ ì˜ˆì•½ì„ ë°›ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤
                                </span>
                            </div>
                            <button type="button" id="toggleBookingStatus"
                                class="px-6 py-3 rounded-xl font-medium transition-all duration-200">
                                ì˜ˆì•½ ì‹œì‘í•˜ê¸°
                            </button>
                        </div>
                    </div>

                    <!-- ìº˜ë¦°ë” ì„¹ì…˜ -->
                    <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
                        <div class="flex justify-between items-center mb-8">
                            <h2 class="text-2xl font-bold text-gray-800">ì˜ˆì•½ í˜„í™©</h2>
                            <div class="flex items-center space-x-6">
                                <button id="downloadExcel"
                                    class="bg-green-500 text-white px-6 py-3 rounded-xl hover:bg-green-600 flex items-center space-x-2 transition-colors duration-200 shadow-lg">
                                    <i class="fas fa-file-pdf"></i>
                                    <span>ì›”ê°„ ì¼ì •í‘œ ë‹¤ìš´ë¡œë“œ (PDF)</span>
                                </button>
                                <div class="flex items-center space-x-4 bg-gray-50 p-2 rounded-xl">
                                    <button id="adminPrevMonth"
                                        class="w-10 h-10 flex items-center justify-center hover:bg-white rounded-lg transition-colors duration-200">
                                        <i class="fas fa-chevron-left text-indigo-600"></i>
                                    </button>
                                    <span id="adminCurrentMonth"
                                        class="text-lg font-medium text-gray-700 min-w-[120px] text-center"></span>
                                    <button id="adminNextMonth"
                                        class="w-10 h-10 flex items-center justify-center hover:bg-white rounded-lg transition-colors duration-200">
                                        <i class="fas fa-chevron-right text-indigo-600"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- ê´€ë¦¬ì ìº˜ë¦°ë” -->
                        <div class="mb-4">
                            <div class="grid grid-cols-7 gap-4 mb-4">
                                <div class="text-center font-semibold text-gray-600 py-2">ì¼</div>
                                <div class="text-center font-semibold text-gray-600 py-2">ì›”</div>
                                <div class="text-center font-semibold text-gray-600 py-2">í™”</div>
                                <div class="text-center font-semibold text-gray-600 py-2">ìˆ˜</div>
                                <div class="text-center font-semibold text-gray-600 py-2">ëª©</div>
                                <div class="text-center font-semibold text-gray-600 py-2">ê¸ˆ</div>
                                <div class="text-center font-semibold text-gray-600 py-2">í† </div>
                            </div>
                            <div id="adminCalendar" class="grid grid-cols-7 gap-4"></div>
                        </div>

                        <!-- ìº˜ë¦°ë” ë²”ë¡€ -->
                        <div class="flex justify-end space-x-6 pt-6 border-t">
                            <div class="flex items-center">
                                <div class="w-4 h-4 bg-yellow-100 rounded-full mr-2 shadow-sm"></div>
                                <span class="text-sm text-gray-600 font-medium">ì˜ˆì•½ê°€ëŠ¥</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-4 h-4 rounded-full mr-2 shadow-sm" style="background-color: #F97316;">
                                </div>
                                <span class="text-sm text-gray-600 font-medium">ë¶€ë¶„ë§ˆê°</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-4 h-4 bg-red-100 rounded-full mr-2 shadow-sm"></div>
                                <span class="text-sm text-gray-600 font-medium">ì˜ˆì•½ë§ˆê°</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-4 h-4 bg-gray-600 rounded-full mr-2 shadow-sm"></div>
                                <span class="text-sm text-gray-600 font-medium">ì „ì²´ë§ˆê°</span>
                            </div>
                        </div>
                    </div>

                    <!-- ìŠ¹ì¸ ê´€ë¦¬ ì„¹ì…˜ -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- íšŒì›ê°€ì… ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡ -->
                        <div class="bg-white rounded-2xl shadow-xl p-8">
                            <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                                <i class="fas fa-user-plus text-indigo-600 mr-2"></i>
                                íšŒì›ê°€ì… ìŠ¹ì¸ ëŒ€ê¸°
                            </h2>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ë‹¨ì²´ëª…</th>
                                            <th
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ë‹´ë‹¹ì</th>
                                            <th
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ì—°ë½ì²˜</th>
                                            <th
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ê´€ë¦¬</th>
                                        </tr>
                                    </thead>
                                    <tbody id="pendingUsersList" class="bg-white divide-y divide-gray-200"></tbody>
                                </table>
                            </div>
                        </div>

                        <!-- ì˜ˆì•½ ìŠ¹ì¸ ëª©ë¡ -->
                        <div class="bg-white rounded-2xl shadow-xl p-8">
                            <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                                <i class="fas fa-calendar-check text-indigo-600 mr-2"></i>
                                ì˜ˆì•½ ìŠ¹ì¸ ëŒ€ê¸°
                            </h2>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ë‹¨ì²´ëª…</th>
                                            <th
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ì‹œ/êµ°</th>
                                            <th
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ë‚ ì§œ</th>
                                            <th
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ì‹œê°„</th>
                                            <th
                                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                                ê´€ë¦¬</th>
                                        </tr>
                                    </thead>
                                    <tbody id="pendingBookingsList" class="bg-white divide-y divide-gray-200"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì— ë¬¸ì˜ì‚¬í•­ ê´€ë¦¬ ì„¹ì…˜ ì¶”ê°€ -->
                    <div class="mt-8 bg-white rounded-2xl shadow-xl p-8" id="inquiryManagementSection"
                        style="display: none;">
                        <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-question-circle text-indigo-600 mr-2"></i>
                            ë¬¸ì˜ì‚¬í•­ ê´€ë¦¬
                        </h2>
                        <div class="mb-4 flex justify-between items-center">
                            <div class="flex space-x-4">
                                <select id="adminInquiryStatusFilter"
                                    class="pl-4 pr-8 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                                    <option value="all">ì „ì²´ ìƒíƒœ</option>
                                    <option value="waiting">ë‹µë³€ ëŒ€ê¸°</option>
                                    <option value="answered">ë‹µë³€ ì™„ë£Œ</option>
                                </select>
                                <select id="adminInquiryCategoryFilter"
                                    class="pl-4 pr-8 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                                    <option value="all">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
                                    <option value="program">í”„ë¡œê·¸ë¨ ë¬¸ì˜</option>
                                    <option value="reservation">ì˜ˆì•½ ë¬¸ì˜</option>
                                    <option value="other">ê¸°íƒ€ ë¬¸ì˜</option>
                                </select>
                            </div>
                            <div class="relative w-64">
                                <input type="text" id="adminInquirySearch" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                                    class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead>
                                    <tr>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ë²ˆí˜¸</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì¹´í…Œê³ ë¦¬</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì œëª©</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì‘ì„±ì</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì‘ì„±ì¼</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ìƒíƒœ</th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ê´€ë¦¬</th>
                                    </tr>
                                </thead>
                                <tbody id="adminInquiriesList" class="bg-white divide-y divide-gray-200">
                                    <!-- ê´€ë¦¬ììš© ë¬¸ì˜ì‚¬í•­ ëª©ë¡ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                                </tbody>
                            </table>
                        </div>
                        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                        <div class="mt-6 flex justify-center">
                            <nav class="flex items-center space-x-2">
                                <button
                                    class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50">
                                    <i class="fas fa-chevron-left text-gray-500"></i>
                                </button>
                                <button
                                    class="w-10 h-10 flex items-center justify-center rounded-lg bg-primary text-white">1</button>
                                <button
                                    class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50">2</button>
                                <button
                                    class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50">3</button>
                                <button
                                    class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50">
                                    <i class="fas fa-chevron-right text-gray-500"></i>
                                </button>
                            </nav>
                        </div>
                    </div>

                    <!-- ì „ì²´ íšŒì› ê´€ë¦¬ ì„¹ì…˜ -->
                    <div class="mt-8 bg-white rounded-2xl shadow-xl p-8">
                        <h2 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-users text-indigo-600 mr-2"></i>
                            ì „ì²´ íšŒì› ê´€ë¦¬
                        </h2>
                        <!-- ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€ -->
                        <div class="flex items-center space-x-4">
                            <div class="relative w-64">
                                <input type="text" id="userSearchInput" placeholder="ë‹¨ì²´ëª… ë˜ëŠ” ë‹´ë‹¹ì ê²€ìƒ‰"
                                    class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                            </div>
                            <button id="clearUserSearch" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        ë²ˆí˜¸</th>
                                    <th
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        ë‹¨ì²´ëª…</th>
                                    <th
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        ë‹´ë‹¹ì</th>
                                    <th
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        ì—°ë½ì²˜</th>
                                    <th
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        ì‹œ/êµ°</th>
                                    <th
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        ì§€ì—­</th>
                                    <th
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        ìƒíƒœ</th>
                                    <th
                                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        ê´€ë¦¬</th>
                                </tr>
                            </thead>
                            <tbody id="allUsersList" class="bg-white divide-y divide-gray-200"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ë‚ ì§œë³„ ì˜ˆì•½ ë‚´ì—­ ëª¨ë‹¬ -->
            <div id="dateBookingsModal" class="modal">
                <div
                    class="bg-white p-8 rounded-lg shadow-md w-full max-w-2xl m-auto max-h-[80vh] flex flex-col overflow-hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h2 id="modalDate" class="text-xl font-bold text-gray-700"></h2>
                        <button id="closeDateBookingsModal" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="mb-4 flex justify-end space-x-2">
                        <button id="partialBlockDateBtn"
                            class="bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600">
                            ë¶€ë¶„ ë§ˆê°
                        </button>
                        <button id="fullBlockDateBtn" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                            ì „ì²´ ë§ˆê°
                        </button>
                        <button id="unblockDateBtn"
                            class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 hidden">
                            ë§ˆê° í•´ì œ
                        </button>
                    </div>
                    <div class="flex-1 overflow-y-auto min-h-0">
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-white sticky top-0 z-10">
                                    <tr>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ë‹¨ì²´ëª…
                                        </th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì‹œê°„
                                        </th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì¥ì†Œ
                                        </th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ì¸ì›
                                        </th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ìƒíƒœ
                                        </th>
                                        <th
                                            class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ê´€ë¦¬
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="dateBookingsList" class="bg-white divide-y divide-gray-200">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì‚¬ìš©ì ì‚­ì œ í™•ì¸ ëª¨ë‹¬ -->
            <div id="deleteUserModal" class="modal">
                <div class="bg-white p-8 rounded-lg shadow-md w-96 m-auto">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-red-600">ê³„ì • ì‚­ì œ í™•ì¸</h2>
                    </div>
                    <p class="mb-6">
                        <span id="deleteUserName" class="font-bold"></span> ê³„ì •ì„ ì™„ì „íˆ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?
                    </p>
                    <p class="mb-8 text-sm text-gray-600">
                        ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë©° í•´ë‹¹ ì‚¬ìš©ìì˜ ëª¨ë“  ì˜ˆì•½ ë° ë¬¸ì˜ ë‚´ì—­ì´ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.
                    </p>
                    <div class="flex justify-end space-x-4">
                        <button id="cancelDeleteUser" class="px-4 py-2 bg-gray-200 text-gray-700 rounded">
                            ì·¨ì†Œ
                        </button>
                        <button id="confirmDeleteUser" class="px-4 py-2 bg-red-500 text-white rounded">
                            ì‚­ì œ
                        </button>
                    </div>
                </div>
            </div>

            <!-- ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ëª¨ë‹¬ -->
            <div id="changePasswordModal" class="modal">
                <div class="bg-white p-8 rounded-lg shadow-md w-96 m-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h2>
                        <button id="closeChangePassword" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <form id="changePasswordForm" class="space-y-4">
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
                            <input type="password" id="currentPassword" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                            <input type="password" id="newPassword" required minlength="6"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-bold mb-2">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                            <input type="password" id="confirmPassword" required minlength="6"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                        </div>
                        <button type="submit"
                            class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition duration-200">
                            ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- ì—°ë½ì²˜ ëª¨ë‹¬ -->
        <div id="contactModal" class="modal">
            <div class="bg-white p-8 rounded-lg max-w-md w-full mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold">ë‹´ë‹¹ì ì—°ë½ì²˜</h3>
                    <button onclick="hideContactInfo()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="space-y-4">
                    <p class="text-gray-600">ì „í™”: 031-250-0474~7</p>
                    <p class="text-gray-600">ì´ë©”ì¼: hoseok0119@ggsc.or.kr</p>
                    <p class="text-gray-600">ìš´ì˜ì‹œê°„: í‰ì¼ 09:00 - 18:00</p>
                </div>
            </div>
        </div>

        <!-- ë¬¸ì˜ì‚¬í•­ ì‘ì„± ëª¨ë‹¬ -->
        <div id="inquiryWriteModal" class="modal">
            <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-2xl m-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">ë¬¸ì˜í•˜ê¸°</h2>
                    <button onclick="closeInquiryWriteModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <form id="inquiryWriteForm" class="space-y-4">
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">ì¹´í…Œê³ ë¦¬</label>
                        <select id="writeInquiryCategory" required
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                            <option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>
                            <option value="program">í”„ë¡œê·¸ë¨ ë¬¸ì˜</option>
                            <option value="reservation">ì˜ˆì•½ ë¬¸ì˜</option>
                            <option value="other">ê¸°íƒ€ ë¬¸ì˜</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">ì œëª©</label>
                        <input type="text" id="inquiryTitle" required
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">ë‚´ìš©</label>
                        <textarea id="inquiryContent" required rows="6"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"></textarea>
                    </div>
                    <div>
                        <label class="block text-gray-700 text-sm font-bold mb-2">ì²¨ë¶€íŒŒì¼</label>
                        <div class="flex items-center space-x-2">
                            <input type="file" id="inquiryFile" class="hidden"
                                accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.hwp,.jpg,.jpeg,.png,.gif">
                            <button type="button" onclick="document.getElementById('inquiryFile').click()"
                                class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors">
                                íŒŒì¼ ì„ íƒ
                            </button>
                            <span id="inquirySelectedFileName" class="text-sm text-gray-600">ì„ íƒëœ íŒŒì¼ ì—†ìŒ</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">ìµœëŒ€ íŒŒì¼ í¬ê¸°: 10MB</p>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="inquiryIsPrivate" class="w-4 h-4 text-blue-600 rounded">
                        <label for="inquiryIsPrivate" class="ml-2 text-gray-700 text-sm font-bold">ë¹„ë°€ê¸€ë¡œ ì‘ì„±</label>
                    </div>
                    <button type="submit"
                        class="w-full bg-primary text-white py-2 rounded-lg hover:bg-primary/90 transition duration-200">
                        ë¬¸ì˜í•˜ê¸°
                    </button>
                </form>
            </div>
        </div>

        <!-- ë¬¸ì˜ì‚¬í•­ ìƒì„¸ ë³´ê¸° ëª¨ë‹¬ -->
        <div id="inquiryDetailModal" class="modal">
            <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-2xl m-auto max-h-[80vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 id="detailInquiryTitle" class="text-2xl font-bold">ë¬¸ì˜ì‚¬í•­ ì œëª©</h2>
                    <button onclick="closeInquiryDetailModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="flex justify-between text-sm text-gray-500 mb-4">
                    <div class="flex space-x-4">
                        <span id="detailInquiryCategory"
                            class="px-2 py-1 bg-blue-100 text-blue-700 rounded-full"></span>
                        <span id="detailInquiryAuthor"></span>
                    </div>
                    <span id="detailInquiryDate"></span>
                </div>
                <div class="border-t border-b py-6">
                    <p id="detailInquiryContent" class="text-gray-700 whitespace-pre-line"></p>

                    <!-- ì²¨ë¶€íŒŒì¼ ì˜ì—­ -->
                    <div id="detailInquiryAttachment" class="mt-4 hidden">
                        <p class="text-sm font-medium text-gray-600 mb-2">ì²¨ë¶€íŒŒì¼</p>
                        <a id="detailInquiryFileLink" href="#" target="_blank" download
                            class="flex items-center space-x-2 text-blue-600 hover:text-blue-800">
                            <i class="fas fa-paperclip"></i>
                            <span id="detailInquiryFileName"></span>
                        </a>
                    </div>
                </div>

                <!-- ë‹µë³€ ì˜ì—­ -->
                <div id="inquiryAnswerSection" class="mt-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">ë‹µë³€</h3>
                    <div id="inquiryNoAnswer" class="p-4 bg-gray-100 rounded-lg">
                        <p class="text-gray-500">ì•„ì§ ë‹µë³€ì´ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
                    </div>
                    <div id="inquiryAnswerContent" class="hidden">
                        <div class="flex justify-between text-sm text-gray-500 mb-2">
                            <span id="answerAuthor">ê´€ë¦¬ì</span>
                            <span id="answerDate"></span>
                        </div>
                        <div class="p-4 bg-gray-100 rounded-lg">
                            <p id="answerContent" class="text-gray-700 whitespace-pre-line"></p>
                        </div>
                    </div>
                </div>

                <!-- ê´€ë¦¬ììš© ë‹µë³€ ì…ë ¥ ì˜ì—­ -->
                <div id="adminAnswerSection" class="mt-6 hidden">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">ë‹µë³€ ì‘ì„±</h3>
                    <form id="inquiryAnswerForm" class="space-y-4">
                        <textarea id="adminAnswerContent" rows="4" placeholder="ë‹µë³€ì„ ì‘ì„±í•´ì£¼ì„¸ìš”"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"></textarea>
                        <div class="flex justify-end">
                            <button type="submit"
                                class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary/90 transition duration-200">
                                ë‹µë³€ ë“±ë¡
                            </button>
                        </div>
                    </form>
                </div>

                <!-- ì‘ì„±ììš© ë¬¸ì˜ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ -->
                <div id="inquiryOwnerActions" class="mt-6 flex justify-end space-x-2 hidden">
                    <button onclick="showEditInquiryModal()"
                        class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                        ìˆ˜ì •
                    </button>
                    <button onclick="deleteInquiry()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                        ì‚­ì œ
                    </button>
                </div>
            </div>
        </div>

        <!-- ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ -->
        <div id="inquiryPage" class="hidden">
            <header class="fixed w-full bg-white shadow-sm z-50">
                <div class="container mx-auto px-6 py-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <img src="https://static.readdy.ai/image/416007a89256a2717806f7776e859886/110ce5261818cd69133e46ef8c6b097a.png"
                                alt="ê²½ê¸°ë„ì²´ìœ¡íšŒ ë¡œê³ " class="h-10">
                            <div class="text-2xl font-bold text-primary">ìŠ¤í¬ì¸ ë°•ìŠ¤</div>
                        </div>
                        <nav class="hidden md:flex items-center space-x-8">
                            <a href="javascript:showHomeScreen()" class="text-gray-700 hover:text-primary py-2">í™ˆ</a>
                            <a href="javascript:showInquiryPage()"
                                class="text-primary font-semibold py-2 border-b-2 border-primary">ë¬¸ì˜ì‚¬í•­</a>
                            <button id="inquiryLoginButton" onclick="showLoginScreen()"
                                class="bg-primary text-white px-4 py-2 !rounded-button hover:bg-primary/90">
                                íšŒì›ê°€ì…/ë¡œê·¸ì¸
                            </button>
                            <div id="inquiryLoggedInNav" class="hidden space-x-4"></div>
                        </nav>
                    </div>
                </div>
            </header>

            <main class="pt-24 pb-16 container mx-auto px-6">
                <div class="mb-8 flex justify-between items-center">
                    <h1 class="text-3xl font-bold text-gray-800">ë¬¸ì˜ì‚¬í•­</h1>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center">
                            <span class="w-3 h-3 bg-red-500 rounded-full inline-block mr-1"></span>
                            <span class="text-sm text-gray-600">ë¹„ë°€ê¸€</span>
                        </div>
                        <div id="inquiryWriteButtonContainer" class="hidden">
                            <button onclick="showInquiryWriteModal()"
                                class="bg-primary text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                                <i class="fas fa-pen"></i>
                                <span>ë¬¸ì˜í•˜ê¸°</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ê²€ìƒ‰ ë° í•„í„° -->
                <div class="mb-6 flex justify-between">
                    <div class="relative w-64">
                        <input type="text" id="inquirySearch" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
                            class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    </div>
                    <select id="inquiryCategory"
                        class="pl-4 pr-8 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        <option value="all">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
                        <option value="program">í”„ë¡œê·¸ë¨ ë¬¸ì˜</option>
                        <option value="reservation">ì˜ˆì•½ ë¬¸ì˜</option>
                        <option value="other">ê¸°íƒ€ ë¬¸ì˜</option>
                    </select>
                </div>

                <!-- ë¬¸ì˜ì‚¬í•­ ëª©ë¡ í…Œì´ë¸” -->
                <div class="bg-white rounded-lg shadow-md overflow-hidden">
                    <table class="min-w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    ë²ˆí˜¸</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    ì¹´í…Œê³ ë¦¬</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    ì œëª©</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    ì‘ì„±ì</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    ì‘ì„±ì¼</th>
                                <th
                                    class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    ìƒíƒœ</th>
                            </tr>
                        </thead>
                        <tbody id="inquiryList" class="bg-white divide-y divide-gray-200">
                            <!-- ë¬¸ì˜ì‚¬í•­ ëª©ë¡ì´ ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
                        </tbody>
                    </table>
                </div>

                <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                <div class="mt-6 flex justify-center">
                    <nav class="flex items-center space-x-2">
                        <button
                            class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50">
                            <i class="fas fa-chevron-left text-gray-500"></i>
                        </button>
                        <button
                            class="w-10 h-10 flex items-center justify-center rounded-lg bg-primary text-white">1</button>
                        <button
                            class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50">2</button>
                        <button
                            class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50">3</button>
                        <button
                            class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50">
                            <i class="fas fa-chevron-right text-gray-500"></i>
                        </button>
                    </nav>
                </div>
            </main>

            <!-- í‘¸í„° -->
            <footer class="bg-gray-900 text-white py-12">
                <div class="container mx-auto px-6">
                    <div class="grid md:grid-cols-4 gap-8">
                        <div>
                            <h3 class="text-lg font-bold mb-4">ìŠ¤í¬ì¸ ë°•ìŠ¤</h3>
                            <p class="text-gray-400">ê²½ê¸°ë„ì²´ìœ¡íšŒ</p>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold mb-4">ì—°ë½ì²˜</h3>
                            <p class="text-gray-400">ì „í™”: 031-250-0474~7</p>
                            <p class="text-gray-400">ì´ë©”ì¼: <a href="mailto:hoseok0119@ggsc.or.kr"
                                    class="hover:text-white">hoseok0119@ggsc.or.kr</a></p>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold mb-4">ìš´ì˜ì‹œê°„</h3>
                            <p class="text-gray-400">í‰ì¼: 09:00 - 18:00</p>
                            <p class="text-gray-400">ì£¼ë§ ë° ê³µíœ´ì¼ íœ´ë¬´</p>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold mb-4">SNS</h3>
                            <div class="flex space-x-4">
                                <a href="https://www.youtube.com/@%EC%8A%A4%ED%8F%AC%EC%B8%A0%EB%B0%95%EC%8A%A4-l7e"
                                    target="_blank" class="text-gray-400 hover:text-white">
                                    <i class="ri-youtube-fill text-xl"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                        <p>&copy; 2025 ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤. All rights reserved.</p>
                    </div>
                </div>
            </footer>
        </div>

        <!-- Excel.js ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

        <!-- JavaScript ì½”ë“œ ì‹œì‘ -->
        <script>
            // ì „ì—­ ìŠ¤ì½”í”„ì— í•¨ìˆ˜ ì •ì˜ ë° window ê°ì²´ì— ëª…ì‹œì  í• ë‹¹
            window.addDirectNoticeListeners = function () {
                // ëª¨ë“  ê³µì§€ì‚¬í•­ í•­ëª©ì— ì´ë²¤íŠ¸ ì¶”ê°€ (í™ˆí™”ë©´ + ëŒ€ì‹œë³´ë“œ)
                const noticeItems = document.querySelectorAll('.notice-item, [data-notice-id]');
                console.log('ê³µì§€ì‚¬í•­ í•­ëª© ìˆ˜:', noticeItems.length);

                if (noticeItems.length === 0) {
                    console.log('ê³µì§€ì‚¬í•­ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                noticeItems.forEach(item => {
                    // ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±° (ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì§€)
                    const newItem = item.cloneNode(true);
                    item.parentNode.replaceChild(newItem, item);

                    // ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€ - ì—¬ê¸°ì„œ handleNoticeClick í•¨ìˆ˜ ì‚¬ìš©
                    newItem.addEventListener('click', window.handleNoticeClick || function (e) {
                        e.preventDefault();
                        e.stopPropagation();

                        const noticeId = parseInt(this.getAttribute('data-notice-id'));
                        const realNoticeId = parseInt(this.getAttribute('data-notice-real-id'));

                        console.log('ê³µì§€ì‚¬í•­ í´ë¦­:', noticeId, realNoticeId);

                        if (window.noticesData && noticeId >= 0 && noticeId < window.noticesData.length) {
                            const notice = window.noticesData[noticeId];

                            // ID ì €ì¥
                            window.currentNoticeId = realNoticeId || notice.id;

                            // ëª¨ë‹¬ ë‚´ìš© ì„¤ì •
                            const modal = document.getElementById('independentNoticeModal');
                            if (modal) {
                                document.getElementById('independentModalTitle').textContent = notice.title;
                                document.getElementById('independentModalContent').textContent = notice.content;
                                document.getElementById('independentModalAuthor').textContent = `ì‘ì„±ì: ${notice.author || 'ê´€ë¦¬ì'}`;
                                document.getElementById('independentModalDate').textContent = new Date(notice.created_at).toLocaleDateString();

                                // ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ ì²˜ë¦¬
                                const attachmentSection = document.getElementById('independentModalAttachment');
                                if (attachmentSection) {
                                    if (notice.attachment_url) {
                                        document.getElementById('independentModalFileName').textContent = notice.attachment_name || 'ì²¨ë¶€íŒŒì¼';
                                        document.getElementById('independentModalFileLink').href = notice.attachment_url;
                                        attachmentSection.style.display = 'block';
                                    } else {
                                        attachmentSection.style.display = 'none';
                                    }
                                }

                                // ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ë° ë²„íŠ¼ í‘œì‹œ
                                const adminActions = document.getElementById('independentModalActions');
                                if (adminActions) {
                                    const isAdmin = sessionStorage.getItem('role') === 'admin';
                                    adminActions.style.display = isAdmin ? 'flex' : 'none';
                                }

                                // ëª¨ë‹¬ í‘œì‹œ
                                modal.style.display = 'flex';
                                document.body.style.overflow = 'hidden';
                            }
                        }
                    });
                });

                console.log('ê³µì§€ì‚¬í•­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ');
            };

            // ê¸°ì¡´ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ ëª¨ë‹¬ ì‹œìŠ¤í…œ ì¶”ê°€
            function setupIndependentNoticeSystem() {
                console.log('ë…ë¦½ì ì¸ ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ì‹œìŠ¤í…œ ì„¤ì • ì‹œì‘');

                // 1. ê¸°ì¡´ ëª¨ë‹¬ ì œê±° (ì´ë¯¸ ìˆë‹¤ë©´)
                const existingModal = document.getElementById('independentNoticeModal');
                if (existingModal) {
                    existingModal.remove();
                }

                // 2. ìƒˆ ëª¨ë‹¬ HTML ì¶”ê°€
                const newModalHTML = `
        <div id="independentNoticeModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
            background-color:rgba(0,0,0,0.75); z-index:99999; align-items:center; justify-content:center;">
            <div style="background:white; max-width:800px; width:90%; border-radius:10px; padding:20px; position:relative; max-height:80vh; overflow-y:auto;">
                <button id="independentModalClose" style="position:absolute; top:10px; right:10px; background:none; border:none; 
                font-size:24px; cursor:pointer; width:30px; height:30px; line-height:30px; text-align:center;">Ã—</button>
                <h2 id="independentModalTitle" style="margin-bottom:15px; font-size:22px; font-weight:bold;"></h2>
                <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:14px; color:#666;">
                    <span id="independentModalAuthor"></span>
                    <span id="independentModalDate"></span>
                </div>
                <div style="border-top:1px solid #eee; padding-top:15px;">
                    <p id="independentModalContent" style="white-space:pre-line; line-height:1.5;"></p>
                </div>
                <!-- ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ -->
                <div id="independentModalAttachment" style="margin-top:20px; padding-top:15px; border-top:1px solid #eee; display:none;">
                    <h3 style="font-weight:bold; margin-bottom:10px; font-size:16px;">ì²¨ë¶€íŒŒì¼</h3>
                    <div id="independentModalFile" style="display:flex; align-items:center;">
                        <a id="independentModalFileLink" href="#" target="_blank" download
                           style="display:inline-flex; align-items:center; padding:8px 12px; background:#f3f4f6; border-radius:4px; text-decoration:none; color:#374151; font-size:14px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" style="margin-right:8px;" viewBox="0 0 16 16">
                                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                            </svg>
                            <span id="independentModalFileName">íŒŒì¼ëª…</span>
                        </a>
                    </div>
                </div>
                <!-- ê´€ë¦¬ì ì•¡ì…˜ ë²„íŠ¼ ì„¹ì…˜ -->
                <div id="independentModalActions" style="display:none; margin-top:20px; padding-top:15px; border-top:1px solid #eee; justify-content:flex-end;">
                    <button id="editNoticeBtn" style="background:#3B82F6; color:white; padding:8px 16px; border-radius:4px; margin-right:8px; cursor:pointer; border:none;">ìˆ˜ì •</button>
                    <button id="deleteNoticeBtn" style="background:#EF4444; color:white; padding:8px 16px; border-radius:4px; cursor:pointer; border:none;">ì‚­ì œ</button>
                </div>
            </div>
        </div>
    `;
                document.body.insertAdjacentHTML('beforeend', newModalHTML);

                // 3. ëª¨ë‹¬ ë‹«ê¸° ì´ë²¤íŠ¸ ì„¤ì •
                document.getElementById('independentModalClose').onclick = function () {
                    document.getElementById('independentNoticeModal').style.display = 'none';
                    document.body.style.overflow = '';
                };

                // 5. ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸° ê¸°ëŠ¥ ì¶”ê°€
                document.addEventListener('keydown', function (e) {
                    if (e.key === 'Escape') {
                        const modal = document.getElementById('independentNoticeModal');
                        if (modal && modal.style.display === 'flex') {
                            modal.style.display = 'none';
                            document.body.style.overflow = '';
                            console.log('ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«í˜');
                        }
                    }
                });

                // 6. ê´€ë¦¬ì ì•¡ì…˜ ë²„íŠ¼ ì´ë²¤íŠ¸ ì„¤ì •
                document.getElementById('editNoticeBtn').addEventListener('click', function () {
                    const modal = document.getElementById('independentNoticeModal');
                    modal.style.display = 'none';
                    document.body.style.overflow = '';

                    // ìˆ˜ì • í•¨ìˆ˜ í˜¸ì¶œ
                    if (typeof editNotice === 'function') {
                        editNotice();
                    } else {
                        console.error('editNotice í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    }
                });

                // ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸ - ì™„ì „íˆ ìƒˆë¡œ ì‘ì„±
                document.getElementById('deleteNoticeBtn').addEventListener('click', async function () {
                    // í˜„ì¬ í‘œì‹œëœ ê³µì§€ì‚¬í•­ ID í™•ì¸
                    const noticeId = window.currentNoticeId;
                    console.log('ì‚­ì œ ì‹œë„: ê³µì§€ì‚¬í•­ ID =', noticeId);

                    if (!noticeId) {
                        showAlert('ê³µì§€ì‚¬í•­ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                        return;
                    }

                    // ì‚­ì œ í™•ì¸
                    if (!confirm('ì •ë§ ì´ ê³µì§€ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        return;
                    }

                    try {
                        // ë¡œë”© í‘œì‹œ
                        document.getElementById('loading').classList.add('show');

                        // API ìš”ì²­
                        const response = await fetch(`https://sports-box-api.parkkwangmin9209.workers.dev/api/admin/notices/${noticeId}`, {
                            method: 'DELETE',
                            headers: {
                                'Authorization': `Bearer ${sessionStorage.getItem('token')}`
                            }
                        });

                        const data = await response.json();

                        if (data.success) {
                            showAlert('ê³µì§€ì‚¬í•­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                            // ëª¨ë‹¬ ë‹«ê¸°
                            document.getElementById('independentNoticeModal').style.display = 'none';
                            document.body.style.overflow = '';
                            // ê³µì§€ì‚¬í•­ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                            loadHomeNotices();
                            // ëŒ€ì‹œë³´ë“œì— ìˆëŠ” ê²½ìš° í•´ë‹¹ ëª©ë¡ë„ ìƒˆë¡œê³ ì¹¨
                            if (document.getElementById('noticesListSection')) {
                                loadUserNotices();
                            }
                        } else {
                            throw new Error(data.message || 'ê³µì§€ì‚¬í•­ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                        }
                    } catch (error) {
                        console.error('ê³µì§€ì‚¬í•­ ì‚­ì œ ì˜¤ë¥˜:', error);
                        showAlert(error.message || 'ê³µì§€ì‚¬í•­ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    } finally {
                        document.getElementById('loading').classList.remove('show');
                    }
                });

                // 7. ê³µì§€ì‚¬í•­ í‘œì‹œ í•¨ìˆ˜ ì •ì˜ (ID ì €ì¥ í¬í•¨)
                window.handleNoticeClick = function (e) {
                    e.preventDefault();
                    e.stopPropagation();

                    const noticeItem = e.currentTarget;
                    const noticeId = parseInt(noticeItem.getAttribute('data-notice-id'));

                    // ëª…ì‹œì ìœ¼ë¡œ ì‹¤ì œ ID ê°€ì ¸ì˜¤ê¸°
                    const realNoticeId = parseInt(noticeItem.getAttribute('data-notice-real-id'));

                    console.log('í´ë¦­í•œ ê³µì§€ì‚¬í•­ - ì¸ë±ìŠ¤:', noticeId, 'ì‹¤ì œ ID:', realNoticeId);

                    if (window.noticesData && noticeId >= 0 && noticeId < window.noticesData.length) {
                        const notice = window.noticesData[noticeId];

                        // ì¤‘ìš”: ID ì €ì¥ ë°©ì‹ ê°œì„ 
                        if (realNoticeId) {
                            window.currentNoticeId = realNoticeId;
                        } else if (notice.id) {
                            window.currentNoticeId = notice.id;
                        } else {
                            console.error('ê³µì§€ì‚¬í•­ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ:', notice);
                            window.currentNoticeId = null;
                        }

                        console.log('ì €ì¥ëœ currentNoticeId:', window.currentNoticeId);

                        // ëª¨ë‹¬ ë‚´ìš© ì„¤ì •
                        document.getElementById('independentModalTitle').textContent = notice.title;

                        // ë§í¬ ë³€í™˜ ì ìš©
                        const contentElement = document.getElementById('independentModalContent');
                        if (contentElement) {
                            contentElement.innerHTML = convertLinksToHyperlinks(notice.content.replace(/\n/g, '<br>'));
                        }

                        document.getElementById('independentModalAuthor').textContent = `ì‘ì„±ì: ${notice.author || 'ê´€ë¦¬ì'}`;
                        document.getElementById('independentModalDate').textContent = new Date(notice.created_at).toLocaleDateString();

                        // ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ ì²˜ë¦¬
                        const attachmentSection = document.getElementById('independentModalAttachment');
                        if (attachmentSection) {
                            if (notice.attachment_url) {
                                document.getElementById('independentModalFileName').textContent = notice.attachment_name || 'ì²¨ë¶€íŒŒì¼';
                                document.getElementById('independentModalFileLink').href = notice.attachment_url;
                                attachmentSection.style.display = 'block';
                            } else {
                                attachmentSection.style.display = 'none';
                            }
                        }

                        // ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ë° ë²„íŠ¼ í‘œì‹œ
                        const adminActions = document.getElementById('independentModalActions');
                        if (adminActions) {
                            const isAdmin = sessionStorage.getItem('role') === 'admin';
                            adminActions.style.display = isAdmin ? 'flex' : 'none';
                            console.log('ê´€ë¦¬ì ê¶Œí•œ í™•ì¸:', isAdmin ? 'ê´€ë¦¬ì ë§ìŒ' : 'ê´€ë¦¬ì ì•„ë‹˜');
                        }

                        // ëª¨ë‹¬ í‘œì‹œ
                        const modal = document.getElementById('independentNoticeModal');
                        modal.style.display = 'flex';
                        document.body.style.overflow = 'hidden';
                    }
                };

                // 8. ê³µì§€ì‚¬í•­ í•­ëª©ì— ì§ì ‘ ì´ë²¤íŠ¸ ì¶”ê°€
                function addDirectNoticeListeners() {
                    console.log('ê³µì§€ì‚¬í•­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ í•¨ìˆ˜ ì‹¤í–‰');

                    // ëª¨ë“  ê³µì§€ì‚¬í•­ í•­ëª©ì— ì´ë²¤íŠ¸ ì¶”ê°€ (í™ˆí™”ë©´ + ëŒ€ì‹œë³´ë“œ)
                    const noticeItems = document.querySelectorAll('.notice-item, [data-notice-id]');
                    console.log('ê³µì§€ì‚¬í•­ í•­ëª© ìˆ˜:', noticeItems.length);

                    if (noticeItems.length === 0) {
                        console.log('ê³µì§€ì‚¬í•­ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');

                        // ì§€ì—° í›„ ë‹¤ì‹œ ì‹œë„
                        setTimeout(() => {
                            const retryItems = document.querySelectorAll('.notice-item, [data-notice-id]');
                            console.log('ì§€ì—° í›„ ì¬ì‹œë„ - ê³µì§€ì‚¬í•­ í•­ëª© ìˆ˜:', retryItems.length);

                            if (retryItems.length > 0) {
                                retryItems.forEach(item => {
                                    // ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±°
                                    const newItem = item.cloneNode(true);
                                    item.parentNode.replaceChild(newItem, item);

                                    // ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€
                                    newItem.addEventListener('click', window.handleNoticeClick || function (e) {
                                        e.preventDefault();
                                        e.stopPropagation();

                                        const noticeId = parseInt(this.getAttribute('data-notice-id'));
                                        const realNoticeId = parseInt(this.getAttribute('data-notice-real-id'));

                                        console.log('ê³µì§€ì‚¬í•­ í´ë¦­ (ì¬ì‹œë„):', noticeId, realNoticeId);

                                        if (window.noticesData && noticeId >= 0 && noticeId < window.noticesData.length) {
                                            const notice = window.noticesData[noticeId];

                                            // ID ì €ì¥
                                            window.currentNoticeId = realNoticeId || notice.id;

                                            // ëª¨ë‹¬ ë‚´ìš© ì„¤ì •
                                            const modal = document.getElementById('independentNoticeModal');
                                            if (modal) {
                                                document.getElementById('independentModalTitle').textContent = notice.title;
                                                document.getElementById('independentModalContent').textContent = notice.content;
                                                document.getElementById('independentModalAuthor').textContent = `ì‘ì„±ì: ${notice.author || 'ê´€ë¦¬ì'}`;
                                                document.getElementById('independentModalDate').textContent = new Date(notice.created_at).toLocaleDateString();

                                                // ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ ì²˜ë¦¬
                                                const attachmentSection = document.getElementById('independentModalAttachment');
                                                if (attachmentSection) {
                                                    if (notice.attachment_url) {
                                                        document.getElementById('independentModalFileName').textContent = notice.attachment_name || 'ì²¨ë¶€íŒŒì¼';
                                                        document.getElementById('independentModalFileLink').href = notice.attachment_url;
                                                        attachmentSection.style.display = 'block';
                                                    } else {
                                                        attachmentSection.style.display = 'none';
                                                    }
                                                }

                                                // ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ë° ë²„íŠ¼ í‘œì‹œ
                                                const adminActions = document.getElementById('independentModalActions');
                                                if (adminActions) {
                                                    const isAdmin = sessionStorage.getItem('role') === 'admin';
                                                    adminActions.style.display = isAdmin ? 'flex' : 'none';
                                                }

                                                // ëª¨ë‹¬ í‘œì‹œ
                                                modal.style.display = 'flex';
                                                document.body.style.overflow = 'hidden';
                                            }
                                        }
                                    });
                                });

                                console.log('ì§€ì—° í›„ ê³µì§€ì‚¬í•­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ');
                            }
                        }, 500);

                        return;
                    }

                    noticeItems.forEach(item => {
                        // ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±° (ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì§€)
                        const newItem = item.cloneNode(true);
                        item.parentNode.replaceChild(newItem, item);

                        // ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€ - ì—¬ê¸°ì„œ handleNoticeClick í•¨ìˆ˜ ì‚¬ìš©
                        newItem.addEventListener('click', window.handleNoticeClick || function (e) {
                            e.preventDefault();
                            e.stopPropagation();

                            const noticeId = parseInt(this.getAttribute('data-notice-id'));
                            const realNoticeId = parseInt(this.getAttribute('data-notice-real-id'));

                            console.log('ê³µì§€ì‚¬í•­ í´ë¦­:', noticeId, realNoticeId);

                            if (window.noticesData && noticeId >= 0 && noticeId < window.noticesData.length) {
                                const notice = window.noticesData[noticeId];

                                // ID ì €ì¥
                                window.currentNoticeId = realNoticeId || notice.id;

                                // ëª¨ë‹¬ ë‚´ìš© ì„¤ì •
                                const modal = document.getElementById('independentNoticeModal');
                                if (modal) {
                                    document.getElementById('independentModalTitle').textContent = notice.title;
                                    document.getElementById('independentModalContent').textContent = notice.content;
                                    document.getElementById('independentModalAuthor').textContent = `ì‘ì„±ì: ${notice.author || 'ê´€ë¦¬ì'}`;
                                    document.getElementById('independentModalDate').textContent = new Date(notice.created_at).toLocaleDateString();

                                    // ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ ì²˜ë¦¬
                                    const attachmentSection = document.getElementById('independentModalAttachment');
                                    if (attachmentSection) {
                                        if (notice.attachment_url) {
                                            document.getElementById('independentModalFileName').textContent = notice.attachment_name || 'ì²¨ë¶€íŒŒì¼';
                                            document.getElementById('independentModalFileLink').href = notice.attachment_url;
                                            attachmentSection.style.display = 'block';
                                        } else {
                                            attachmentSection.style.display = 'none';
                                        }
                                    }

                                    // ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ë° ë²„íŠ¼ í‘œì‹œ
                                    const adminActions = document.getElementById('independentModalActions');
                                    if (adminActions) {
                                        const isAdmin = sessionStorage.getItem('role') === 'admin';
                                        adminActions.style.display = isAdmin ? 'flex' : 'none';
                                    }

                                    // ëª¨ë‹¬ í‘œì‹œ
                                    modal.style.display = 'flex';
                                    document.body.style.overflow = 'hidden';
                                }
                            }
                        });
                    });

                    console.log('ê³µì§€ì‚¬í•­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ');
                }

                // 9. í˜ì´ì§€ ë¡œë“œ ë° ê³µì§€ì‚¬í•­ ë¡œë“œ í›„ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                const originalLoadHomeNotices = window.loadHomeNotices;
                if (originalLoadHomeNotices && !window.noticeSystemPatched) {
                    window.noticeSystemPatched = true;
                    window.loadHomeNotices = async function () {
                        await originalLoadHomeNotices.apply(this, arguments);
                        setTimeout(addDirectNoticeListeners, 500);
                    };
                }

                // 10. ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ê³µì§€ì‚¬í•­ ë¡œë“œ í•¨ìˆ˜ ì¶”ê°€ (ì¤‘ìš”!)
                window.loadUserNotices = async function () {
                    try {
                        console.log('ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ê³µì§€ì‚¬í•­ ë¡œë“œ ì‹œì‘');

                        // ì‚¬ìš©ì ì§€ì—­ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                        const userRegion = sessionStorage.getItem('region');
                        console.log('ì‚¬ìš©ì ì§€ì—­:', userRegion);

                        // ê³µì§€ì‚¬í•­ API í˜¸ì¶œ
                        const response = await apiRequest('/api/notices');
                        console.log('ê³µì§€ì‚¬í•­ ì‘ë‹µ:', response);

                        if (response.success && response.data) {
                            // ì‚¬ìš©ì ì§€ì—­ì— ë§ëŠ” ê³µì§€ì‚¬í•­ í•„í„°ë§ (ì „ì²´ ê³µì§€ + í•´ë‹¹ ì§€ì—­ ê³µì§€)
                            const filteredNotices = response.data.filter(notice =>
                                notice.region === 'all' || notice.region === userRegion
                            );

                            console.log('í•„í„°ë§ëœ ê³µì§€ì‚¬í•­:', filteredNotices.length);

                            // ì „ì—­ ë°ì´í„° ì €ì¥
                            window.noticesData = filteredNotices;

                            // ê³µì§€ì‚¬í•­ ì»¨í…Œì´ë„ˆ ì°¾ê¸°
                            const container = document.getElementById('noticesListSection');
                            if (!container) {
                                console.error('ê³µì§€ì‚¬í•­ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: noticesListSection');
                                return;
                            }

                            // ê³µì§€ì‚¬í•­ ë Œë”ë§
                            renderUserNoticesList(filteredNotices, container);

                            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                            setTimeout(addDirectNoticeListeners, 200);
                        } else {
                            throw new Error('ê³µì§€ì‚¬í•­ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                        }
                    } catch (error) {
                        console.error('ì‚¬ìš©ì ê³µì§€ì‚¬í•­ ë¡œë“œ ì˜¤ë¥˜:', error);
                        const container = document.getElementById('noticesListSection');
                        if (container) {
                            container.innerHTML = '<p class="text-center text-gray-500">ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>';
                        }
                    }
                };

                // 12. initializeUserDashboard í•¨ìˆ˜ íŒ¨ì¹˜ - ê³µì§€ì‚¬í•­ ë¡œë“œ ì¶”ê°€ (í•¨ìˆ˜ ì™¸ë¶€ë¡œ ì´ë™)
                const originalInitUserDashboard = window.initializeUserDashboard;
                if (originalInitUserDashboard && !window.userDashboardPatched) {
                    window.userDashboardPatched = true;
                    window.initializeUserDashboard = async function () {
                        // ì›ë˜ í•¨ìˆ˜ í˜¸ì¶œ
                        await originalInitUserDashboard.apply(this, arguments);

                        // ê³µì§€ì‚¬í•­ ë¡œë“œ ì¶”ê°€
                        if (typeof window.loadUserNotices === 'function') {
                            console.log('ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” í›„ ê³µì§€ì‚¬í•­ ë¡œë“œ í˜¸ì¶œ');
                            await window.loadUserNotices();
                        }
                    };
                }

                console.log('ë…ë¦½ì ì¸ ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ì‹œìŠ¤í…œ ì„¤ì • ì™„ë£Œ');
                return true;
            }

            // í˜ì´ì§€ ë¡œë“œ í›„ ì‹¤í–‰
            window.addEventListener('DOMContentLoaded', setupIndependentNoticeSystem);

            // ê³µì§€ì‚¬í•­ ì‹œìŠ¤í…œ ì •ë¦¬ í•¨ìˆ˜
            function cleanupNoticeSystem() {
                // 1. ê¸°ì¡´ ê³µì§€ì‚¬í•­ ê´€ë ¨ í•¨ìˆ˜ë“¤ ì¬ì •ì˜
                window.showNoticeDetail = function (notice) {
                    console.log('ê¸°ì¡´ showNoticeDetail í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆì§€ë§Œ ë¬´ì‹œë¨');
                    // ëŒ€ì‹  ìƒˆ ì‹œìŠ¤í…œìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
                    const modal = document.getElementById('independentNoticeModal');
                    if (modal) {
                        document.getElementById('independentModalTitle').textContent = notice.title;
                        document.getElementById('independentModalContent').textContent = notice.content;
                        document.getElementById('independentModalAuthor').textContent = `ì‘ì„±ì: ${notice.author || 'ê´€ë¦¬ì'}`;
                        document.getElementById('independentModalDate').textContent = new Date(notice.created_at).toLocaleDateString();

                        // ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ ì²˜ë¦¬
                        const attachmentSection = document.getElementById('independentModalAttachment');
                        if (notice.attachment_url) {
                            document.getElementById('independentModalFileName').textContent = notice.attachment_name || 'ì²¨ë¶€íŒŒì¼';
                            document.getElementById('independentModalFileLink').href = notice.attachment_url;
                            attachmentSection.style.display = 'block';
                        } else {
                            attachmentSection.style.display = 'none';
                        }

                        modal.style.display = 'flex';
                        document.body.style.overflow = 'hidden';
                    }
                };

                window.closeNoticeDetail = function () {
                    const modal = document.getElementById('independentNoticeModal');
                    if (modal) {
                        modal.style.display = 'none';
                        document.body.style.overflow = '';
                    }
                };

                // 2. ê¸°ì¡´ noticeDetailModal ë¹„í™œì„±í™”
                const oldModal = document.getElementById('noticeDetailModal');
                if (oldModal) {
                    oldModal.style.display = 'none';
                    oldModal.classList.add('hidden');
                    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°
                    oldModal.replaceWith(oldModal.cloneNode(true));
                }

                console.log('ê³µì§€ì‚¬í•­ ì‹œìŠ¤í…œ ì •ë¦¬ ì™„ë£Œ');
            }

            // ê¸°ì¡´ DOMContentLoaded ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë°±ì—…
            const originalDOMContentLoaded = window.addEventListener('DOMContentLoaded', function () {
                // ë…ë¦½ ê³µì§€ì‚¬í•­ ì‹œìŠ¤í…œ ì„¤ì •
                setupIndependentNoticeSystem();

                // ê¸°ì¡´ ì‹œìŠ¤í…œ ì •ë¦¬
                setTimeout(cleanupNoticeSystem, 1500);
            });

            // ë¡œê·¸ì¸ í™”ë©´ í•¨ìˆ˜ íŒ¨ì¹˜
            const originalShowLoginScreen = window.showLoginScreen;
            window.showLoginScreen = function () {
                // ëª¨ë“  ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ë‹«ê¸°
                const independentModal = document.getElementById('independentNoticeModal');
                if (independentModal) {
                    independentModal.style.display = 'none';
                    document.body.style.overflow = '';
                }

                const oldModal = document.getElementById('noticeDetailModal');
                if (oldModal) {
                    oldModal.style.display = 'none';
                    oldModal.classList.add('hidden');
                }

                // ì›ë˜ í•¨ìˆ˜ í˜¸ì¶œ
                return originalShowLoginScreen.apply(this, arguments);
            };

            // ê¸°ë³¸ ì„¤ì •
            const API_BASE_URL = 'https://sports-box-api.parkkwangmin9209.workers.dev';
            const DEBUG = true;

            // ì‹œêµ° ë¶„ë¥˜ ë°ì´í„°
            const REGION_MAPPING = {
                south: [
                    'ê³¼ì²œì‹œ', 'ê´‘ëª…ì‹œ', 'ê´‘ì£¼ì‹œ', 'êµ°í¬ì‹œ', 'ê¹€í¬ì‹œ', 'ë¶€ì²œì‹œ', 'ì„±ë‚¨ì‹œ',
                    'ìˆ˜ì›ì‹œ', 'ì‹œí¥ì‹œ', 'ì•ˆì‚°ì‹œ', 'ì•ˆì„±ì‹œ', 'ì•ˆì–‘ì‹œ', 'ì–‘í‰êµ°', 'ì—¬ì£¼ì‹œ', 'ì˜¤ì‚°ì‹œ',
                    'ìš©ì¸ì‹œ', 'ì˜ì™•ì‹œ', 'ì´ì²œì‹œ', 'í‰íƒì‹œ', 'í•˜ë‚¨ì‹œ', 'í™”ì„±ì‹œ'
                ],
                north: [
                    'ê³ ì–‘ì‹œ', 'êµ¬ë¦¬ì‹œ', 'ë‚¨ì–‘ì£¼ì‹œ', 'ë™ë‘ì²œì‹œ', 'ì–‘ì£¼ì‹œ', 'ì˜ì •ë¶€ì‹œ',
                    'íŒŒì£¼ì‹œ', 'í¬ì²œì‹œ', 'ê°€í‰êµ°', 'ì—°ì²œêµ°'
                ]
            };

            // 11. ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ê³µì§€ì‚¬í•­ ë Œë”ë§ í•¨ìˆ˜
            function renderUserNoticesList(notices, container) {
                try {
                    if (!container) {
                        console.error('ê³µì§€ì‚¬í•­ ì»¨í…Œì´ë„ˆ ìš”ì†Œê°€ ì—†ìŠµë‹ˆë‹¤');
                        return;
                    }

                    const sortedNotices = sortNoticesByImportanceAndDate(notices);
                    if (!sortedNotices || sortedNotices.length === 0) {
                        container.innerHTML = '<p class="text-center text-gray-500 py-4">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                        return;
                    }

                    window.noticesData = sortedNotices;

                    container.innerHTML = `
            <div class="overflow-y-auto max-h-[500px] pr-2">
                ${sortedNotices.map((notice, index) => {
                        const isImportant = notice.is_important === 1 || notice.is_important === '1' || notice.is_important === true;
                        const date = new Date(notice.created_at);
                        const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;

                        return `
                        <div class="notice-item ${isImportant ? 'important' : ''} bg-white rounded-lg shadow-md p-6 mb-4 hover:shadow-lg transition-shadow cursor-pointer"
                             data-notice-id="${index}" data-notice-real-id="${notice.id}">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="text-lg font-semibold">
                                    ${isImportant ? '<span class="inline-block mr-2 px-2 py-1 bg-red-500 text-white text-xs font-semibold rounded-full">ì¤‘ìš”</span>' : ''}
                                    ${notice.title}
                                </h3>
                                <span class="text-sm text-gray-500">${formattedDate}</span>
                            </div>
                            <p class="text-gray-600 text-sm line-clamp-2">${notice.content}</p>
                        </div>
                    `;
                    }).join('')}
            </div>
        `;

                    setTimeout(addDirectNoticeListeners, 200);
                } catch (error) {
                    console.error('ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ê³µì§€ì‚¬í•­ ë Œë”ë§ ì˜¤ë¥˜:', error);
                    container.innerHTML = '<p class="text-center text-gray-500">ê³µì§€ì‚¬í•­ì„ í‘œì‹œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
                }
            }

            // ê³µí†µ ì •ë ¬ í•¨ìˆ˜ (utils.js ë˜ëŠ” ì „ì—­ ìŠ¤ì½”í”„ì— ì •ì˜)
            function sortNoticesByImportanceAndDate(notices) {
                if (!notices || !Array.isArray(notices)) return [];

                return [...notices].sort((a, b) => {
                    const aImportant = Number(a.is_important || 0); // ê¸°ë³¸ê°’ 0
                    const bImportant = Number(b.is_important || 0);

                    if (aImportant !== bImportant) return bImportant - aImportant; // ì¤‘ìš” ê³µì§€ ìš°ì„ 
                    return new Date(b.created_at) - new Date(a.created_at); // ë‚ ì§œ ë‚´ë¦¼ì°¨ìˆœ
                });
            }

            // ëª¨ë‹¬ ìƒíƒœ ì§„ë‹¨ í•¨ìˆ˜
            function diagnoseModalIssue() {
                const modal = document.getElementById('noticeDetailModal');
                if (!modal) {
                    console.error('ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }

                const computedStyle = window.getComputedStyle(modal);
                console.log('ëª¨ë‹¬ ì§„ë‹¨:', {
                    element: modal,
                    display: computedStyle.display,
                    visibility: computedStyle.visibility,
                    opacity: computedStyle.opacity,
                    zIndex: computedStyle.zIndex,
                    position: computedStyle.position,
                    parentElement: modal.parentElement,
                    classList: [...modal.classList]
                });
            }

            // ì „ì—­ ê°ì²´ì— ë””ë²„ê¹… í•¨ìˆ˜ ë…¸ì¶œ
            window.diagnoseModalIssue = diagnoseModalIssue;

            // ëª¨ë‹¬ ì§ì ‘ ì œì–´ í•¨ìˆ˜
            function openModal(modalId) {
                const modal = document.getElementById(modalId);
                if (!modal) {
                    console.error(`Modal with ID ${modalId} not found`);
                    return;
                }
                console.log(`Opening modal: ${modalId}`);
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden'; // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€

                setTimeout(() => {
                    modal.classList.add('show');
                }, 10);
            } // openModal í•¨ìˆ˜ ë‹«ê¸°

            function closeModal(modalId) {
                const modal = document.getElementById(modalId);
                if (!modal) return;
                console.log(`Closing modal: ${modalId}`);
                modal.classList.remove('show');
                setTimeout(() => {
                    modal.style.display = 'none';
                    document.body.style.overflow = '';
                }, 300);
            } // closeModal í•¨ìˆ˜ ë‹«ê¸°

            // í™ˆí™”ë©´ ê³µì§€ì‚¬í•­ ë¡œë“œ
            async function loadHomeNotices() {
                try {
                    console.log('í™ˆí™”ë©´ ê³µì§€ì‚¬í•­ ë¡œë“œ ì‹œì‘');

                    // ê³µê°œ API ê²½ë¡œ ì‚¬ìš©
                    const response = await fetch(`${API_BASE_URL}/api/public/notices`);

                    if (!response.ok) {
                        console.warn('ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:', response.status);
                        document.getElementById('homeNoticesList').innerHTML =
                            '<p class="text-center text-gray-500">í˜„ì¬ ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
                        return;
                    }

                    const data = await response.json();
                    const noticesList = document.getElementById('homeNoticesList');

                    if (data.success && data.data && data.data.length > 0) {
                        console.log('ì›ë³¸ ê³µì§€ì‚¬í•­ ë°ì´í„°:', data.data);
                        // ê³µí†µ ì •ë ¬ í•¨ìˆ˜ ì‚¬ìš©
                        const sortedNotices = sortNoticesByImportanceAndDate(data.data);
                        console.log('ì •ë ¬ëœ ê³µì§€ì‚¬í•­ ë°ì´í„°:', sortedNotices);

                        // ê³µì§€ì‚¬í•­ ë°ì´í„°ë¥¼ ì „ì—­ ê°ì²´ì— ì €ì¥
                        window.noticesData = sortedNotices;

                        // HTML ìƒì„± - ìƒˆë¡œìš´ ë””ìì¸ ì ìš©
                        noticesList.innerHTML = `
                <div class="notice-tabs mb-4 border-b">
                    <div class="flex">
                        <h3 class="text-2xl font-bold mr-4 pb-2 border-b-2 border-blue-500 text-blue-500">ì†Œì‹</h3>
                    </div>
                </div>
                <div class="notice-list space-y-6 overflow-y-auto max-h-[500px] pr-2">
                    ${sortedNotices.map((notice, index) => {
                            // ë‚ ì§œ í˜•ì‹ ë³€í™˜
                            const date = new Date(notice.created_at);
                            const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;

                            // ë‚´ìš© ìš”ì•½ (100ì ì œí•œ)
                            const contentSummary = notice.content.length > 100
                                ? notice.content.substring(0, 100) + '...'
                                : notice.content;

                            return `
                            <div class="notice-item border-b pb-6 cursor-pointer" data-notice-id="${index}" data-notice-real-id="${notice.id}">
                                <div class="flex items-start justify-between">
                                    <div class="notice-content flex-1 pr-4">
                                        <h4 class="text-xl font-bold mb-2 text-gray-800 flex items-center justify-between">
                                            <span class="flex items-center">
                                                ${notice.is_important ?
                                    '<span class="inline-block mr-2 px-2 py-1 bg-red-100 text-red-800 text-xs font-semibold rounded-full">ì¤‘ìš”</span>' :
                                    ''}
                                                ${notice.title}
                                            </span>
                                            <span class="text-sm text-gray-500 font-normal">${formattedDate}</span>
                                        </h4>
                                        <p class="text-gray-600 text-sm line-clamp-1">${contentSummary.replace(/\n/g, ' ')}</p>
                                    </div>
                                </div>
                            </div>
                        `;
                        }).join('')}
                </div>
            `;

                        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ëŠ” ë…ë¦½ ì‹œìŠ¤í…œì— ìœ„ì„
                        setTimeout(addDirectNoticeListeners, 100);

                    } else {
                        noticesList.innerHTML = '<p class="text-center text-gray-500">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                    }

                    checkAdminStatus();
                    console.log('í™ˆí™”ë©´ ê³µì§€ì‚¬í•­ ë¡œë“œ ì™„ë£Œ');
                } catch (error) {
                    console.error('Home notices loading error:', error);
                    document.getElementById('homeNoticesList').innerHTML =
                        '<p class="text-center text-gray-500">ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
                }
            }

            // ê³µì§€ì‚¬í•­ ëª©ë¡ ë Œë”ë§ í•¨ìˆ˜ ìˆ˜ì • (ëŒ€ì‹œë³´ë“œìš©)
            function renderNoticesList(notices, containerId) {
                try {
                    const container = document.getElementById(containerId);
                    if (!container) {
                        console.error(`ì»¨í…Œì´ë„ˆ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ: ${containerId}`);
                        return;
                    }

                    const sortedNotices = sortNoticesByImportanceAndDate(notices);

                    if (!sortedNotices || sortedNotices.length === 0) {
                        container.innerHTML = '<p class="text-center text-gray-500 py-4">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                        return;
                    }

                    console.log(`${containerId}ì— ${sortedNotices.length}ê°œ ê³µì§€ì‚¬í•­ ë Œë”ë§ ì‹œì‘`);

                    window.noticesData = sortedNotices;

                    container.innerHTML = `
            <div class="overflow-y-auto max-h-[500px] pr-2">
                ${sortedNotices.map((notice, index) => {
                        const rawIsImportant = notice.is_important;
                        const isImportant = rawIsImportant === 1 || rawIsImportant === '1' || rawIsImportant === true;

                        console.log(`ê³µì§€ì‚¬í•­ ${notice.title}: rawIsImportant = ${rawIsImportant}, typeof = ${typeof rawIsImportant}, isImportant = ${isImportant}`);

                        const date = new Date(notice.created_at);
                        const formattedDate = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;

                        return `
                        <div class="notice-item bg-white rounded-lg shadow-md p-6 mb-4 hover:shadow-lg transition-shadow cursor-pointer ${isImportant ? 'border-l-4 border-red-500' : ''}"
                             data-notice-id="${index}" data-notice-real-id="${notice.id}">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="text-lg font-semibold flex items-center">
                                    ${isImportant ?
                                '<span class="inline-block mr-2 px-2 py-1 bg-red-100 text-red-800 text-xs font-semibold rounded-full">ì¤‘ìš”</span>' :
                                ''}
                                    ${notice.title}
                                </h3>
                                <span class="text-sm text-gray-500">${formattedDate}</span>
                            </div>
                            <p class="text-gray-600 text-sm mb-3 line-clamp-2">${notice.content}</p>
                            <div class="flex justify-end">
                                <span class="px-2 py-1 rounded-full text-xs ${notice.region === 'all' ? 'bg-purple-100 text-purple-800' :
                                notice.region === 'south' ? 'bg-blue-100 text-blue-800' :
                                    'bg-green-100 text-green-800'
                            }">
                                    ${notice.region === 'all' ? 'ì „ì²´ê³µì§€' :
                                notice.region === 'south' ? 'ë‚¨ë¶€ê³µì§€' : 'ë¶ë¶€ê³µì§€'}
                                </span>
                            </div>
                        </div>
                    `;
                    }).join('')}
            </div>
        `;

                    console.log(`${containerId}ì— ê³µì§€ì‚¬í•­ ë Œë”ë§ ì™„ë£Œ`);

                    setTimeout(() => {
                        const noticeItems = document.querySelectorAll('.notice-item');
                        console.log(`ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ ì „ ê³µì§€ì‚¬í•­ í•­ëª© ìˆ˜: ${noticeItems.length}`);

                        noticeItems.forEach(item => {
                            item.addEventListener('click', function (e) {
                                const noticeId = parseInt(this.getAttribute('data-notice-id'));
                                const realNoticeId = parseInt(this.getAttribute('data-notice-real-id'));

                                console.log(`ê³µì§€ì‚¬í•­ í´ë¦­: ID=${noticeId}, ì‹¤ì œID=${realNoticeId}`);

                                if (window.noticesData && noticeId >= 0 && noticeId < window.noticesData.length) {
                                    const notice = window.noticesData[noticeId];
                                    showNoticeDetail(notice);
                                }
                            });
                        });

                        console.log(`${noticeItems.length}ê°œ ê³µì§€ì‚¬í•­ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ ì™„ë£Œ`);
                    }, 100);

                } catch (error) {
                    console.error('ê³µì§€ì‚¬í•­ ë Œë”ë§ ì˜¤ë¥˜:', error);
                    const container = document.getElementById(containerId);
                    if (container) {
                        container.innerHTML = '<p class="text-center text-gray-500">ê³µì§€ì‚¬í•­ì„ í‘œì‹œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>';
                    }
                }
            }

            // ê³µì§€ì‚¬í•­ ìƒì„¸ ë³´ê¸° í•¨ìˆ˜
            function showNoticeDetail(notice) {
                console.log('ëª¨ë‹¬ í‘œì‹œ í•¨ìˆ˜ í˜¸ì¶œ:', notice);

                // ëª¨ë‹¬ ë‚´ìš© ì—…ë°ì´íŠ¸
                document.getElementById('noticeDetailTitle').textContent = notice.title;

                // ë§í¬ ë³€í™˜ ì ìš© - textContent ëŒ€ì‹  innerHTML ì‚¬ìš©
                const contentElement = document.getElementById('noticeDetailContent');
                if (contentElement) {
                    contentElement.innerHTML = convertLinksToHyperlinks(notice.content.replace(/\n/g, '<br>'));
                }

                const authorElement = document.getElementById('noticeDetailAuthor');
                if (authorElement) {
                    authorElement.textContent = `ì‘ì„±ì: ${notice.author || 'ê´€ë¦¬ì'}`;
                }

                const dateElement = document.getElementById('noticeDetailDate');
                if (dateElement) {
                    dateElement.textContent = new Date(notice.created_at).toLocaleDateString();
                }

                // ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ë° ë²„íŠ¼ í‘œì‹œ
                const noticeDetailActions = document.getElementById('noticeDetailActions');
                if (noticeDetailActions) {
                    const isAdmin = sessionStorage.getItem('role') === 'admin';
                    // ê´€ë¦¬ìì¸ ê²½ìš° ë²„íŠ¼ í‘œì‹œ
                    if (isAdmin) {
                        noticeDetailActions.classList.remove('hidden');
                        // í˜„ì¬ ê³µì§€ì‚¬í•­ ID ì €ì¥ (ìˆ˜ì •/ì‚­ì œ ì‹œ ì‚¬ìš©)
                        currentNoticeId = notice.id;
                    } else {
                        noticeDetailActions.classList.add('hidden');
                    }
                }

                // ëª¨ë‹¬ í‘œì‹œ
                const modal = document.getElementById('noticeDetailModal');
                if (!modal) {
                    console.error('ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                    return;
                }

                // ëª¨ë‹¬ í‘œì‹œ
                modal.classList.remove('hidden');
                modal.classList.add('show');
                modal.style.display = 'flex';
                modal.style.opacity = '1';
                modal.style.visibility = 'visible';
                modal.style.zIndex = '99999'; // ë§¤ìš° ë†’ì€ z-index ì„¤ì •

                // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
                document.body.style.overflow = 'hidden';

                console.log('ëª¨ë‹¬ í‘œì‹œ ì™„ë£Œ');
            }

            function showNoticeDetailFromElement(element) {
                try {
                    console.log('Showing notice from element:', element);

                    // data-notice ì†ì„±ì—ì„œ ê³µì§€ì‚¬í•­ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    const noticeData = element.getAttribute('data-notice');
                    if (!noticeData) {
                        console.error('No notice data found in element');
                        return;
                    }

                    const notice = JSON.parse(noticeData);
                    showNoticeDetail(notice);
                } catch (error) {
                    console.error('Error showing notice detail from element:', error);
                    showAlert('ê³µì§€ì‚¬í•­ì„ í‘œì‹œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            // ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜ (ê¸°ì¡´ í•¨ìˆ˜ ëŒ€ì²´)
            function closeNoticeDetail() {
                const modal = document.getElementById('noticeDetailModal');
                if (!modal) return;

                // ëª¨ë‹¬ ìˆ¨ê¸°ê¸°
                modal.classList.add('hidden');
                modal.classList.remove('show');
                modal.style.display = 'none';

                // ë°°ê²½ ìŠ¤í¬ë¡¤ ë³µì›
                document.body.style.overflow = '';

                // í˜„ì¬ ê³µì§€ì‚¬í•­ ID ì´ˆê¸°í™”
                currentNoticeId = null;

                console.log('ëª¨ë‹¬ ë‹«í˜');
            }

            // ê³µì§€ì‚¬í•­ ìˆ˜ì • ëª¨ë‹¬ HTML ì¶”ê°€ (body ë ë¶€ë¶„ì— ì¶”ê°€)
            const noticeEditModalHTML = `
<div id="noticeEditModal" class="modal">
    <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-2xl m-auto">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold">ê³µì§€ì‚¬í•­ ìˆ˜ì •</h2>
            <button onclick="closeNoticeEditModal()" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <form id="noticeEditForm" class="space-y-4">
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">ì œëª©</label>
                <input type="text" id="editNoticeTitle" required
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
            </div>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">ë‚´ìš©</label>
                <textarea id="editNoticeContent" required rows="6"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"></textarea>
            </div>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">ê³µê°œ ë²”ìœ„</label>
                <select id="editNoticeRegion" required
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400">
                    <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                    <option value="all">ì „ì²´ ê³µê°œ</option>
                    <option value="south">ë‚¨ë¶€ ì§€ì—­ë§Œ</option>
                    <option value="north">ë¶ë¶€ ì§€ì—­ë§Œ</option>
                </select>
            </div>
            <div class="flex items-center">
                <input type="checkbox" id="editNoticeImportant" class="w-4 h-4 text-blue-600 rounded">
                <label for="editNoticeImportant" class="ml-2 text-gray-700 text-sm font-bold">ì¤‘ìš” ê³µì§€</label>
            </div>
            <button type="submit" 
                class="w-full bg-primary text-white py-2 rounded-lg hover:bg-primary/90 transition duration-200">
                ìˆ˜ì •í•˜ê¸°
            </button>
        </form>
    </div>
</div>`;

            // bodyì— ëª¨ë‹¬ HTML ì¶”ê°€
            document.body.insertAdjacentHTML('beforeend', noticeEditModalHTML);

            // ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜
            function editNotice() {
                console.log('ìˆ˜ì • ë²„íŠ¼ í´ë¦­ë¨, currentNoticeId:', window.currentNoticeId);

                if (!window.currentNoticeId) {
                    showAlert('ê³µì§€ì‚¬í•­ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
                    return;
                }

                // í˜„ì¬ ê³µì§€ì‚¬í•­ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const notice = window.noticesData.find(n => n.id === window.currentNoticeId);
                if (!notice) {
                    // IDë¡œ ì°¾ì§€ ëª»í•œ ê²½ìš° ëª¨ë“  ê³µì§€ì‚¬í•­ í™•ì¸
                    console.log('IDë¡œ ì°¾ì§€ ëª»í•¨, ì „ì²´ ë°ì´í„°:', window.noticesData);
                    showAlert('ê³µì§€ì‚¬í•­ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                    return;
                }

                // ìˆ˜ì • ëª¨ë‹¬ì— ê¸°ì¡´ ì •ë³´ í‘œì‹œ
                document.getElementById('editNoticeTitle').value = notice.title;
                document.getElementById('editNoticeContent').value = notice.content;
                document.getElementById('editNoticeRegion').value = notice.region || 'all';
                document.getElementById('editNoticeImportant').checked = notice.is_important === 1;

                // ê³µì§€ì‚¬í•­ ìƒì„¸ ëª¨ë‹¬ ë‹«ê¸°
                document.getElementById('independentNoticeModal').style.display = 'none';

                // ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸°
                openModal('noticeEditModal');
            }

            // ìˆ˜ì • ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
            function closeNoticeEditModal() {
                closeModal('noticeEditModal');
                document.getElementById('noticeEditForm').reset();
            }

            function initializeNoticeListeners() {
                const noticesList = document.getElementById('homeNoticesList');
                if (!noticesList) return;

                noticesList.addEventListener('click', function (e) {
                    const noticeItem = e.target.closest('.notice-item');
                    if (noticeItem) {
                        // ì¤‘ìš”: ì´ë²¤íŠ¸ ì „íŒŒ ì¤‘ì§€
                        e.preventDefault();
                        e.stopPropagation();

                        const noticeId = parseInt(noticeItem.getAttribute('data-notice-id'));
                        if (window.noticesData && noticeId >= 0 && noticeId < window.noticesData.length) {
                            showNoticeDetail(window.noticesData[noticeId]);
                        }
                    }
                });

                console.log('ê³µì§€ì‚¬í•­ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ì™„ë£Œ');
            }

            // ê³µì§€ì‚¬í•­ ì‚­ì œ
            async function deleteNotice() {
                if (!currentNoticeId) {
                    showAlert('ê³µì§€ì‚¬í•­ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                    return;
                }

                // ì‚­ì œ í™•ì¸
                if (!confirm('ì •ë§ ì´ ê³µì§€ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    return;
                }

                try {
                    showLoading();

                    // API ìš”ì²­
                    const response = await fetch(`${API_BASE_URL}/api/admin/notices/${currentNoticeId}`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `Bearer ${sessionStorage.getItem('token')}`
                        }
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || 'ê³µì§€ì‚¬í•­ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    }

                    const data = await response.json();

                    if (data.success) {
                        showAlert('ê³µì§€ì‚¬í•­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                        closeNoticeDetail();
                        // ê³µì§€ì‚¬í•­ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                        await loadHomeNotices();
                        // ëŒ€ì‹œë³´ë“œì— ìˆëŠ” ê²½ìš° í•´ë‹¹ ëª©ë¡ë„ ìƒˆë¡œê³ ì¹¨
                        if (document.getElementById('noticesListSection')) {
                            await loadNotices();
                        }
                    } else {
                        throw new Error(data.message || 'ê³µì§€ì‚¬í•­ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('Notice deletion error:', error);
                    showAlert(error.message || 'ê³µì§€ì‚¬í•­ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            // ê³µì§€ì‚¬í•­ ì‘ì„± ëª¨ë‹¬ ì»¨íŠ¸ë¡¤
            function showNoticeWriteModal() {
                openModal('noticeWriteModal');
            }

            function closeNoticeWriteModal() {
                closeModal('noticeWriteModal');
                document.getElementById('noticeWriteForm').reset();
            }

            // ê³µì§€ì‚¬í•­ í¼ ì œì¶œ í•¨ìˆ˜ ì¶”ê°€ (modifyNoticeFormWithGithubConverter í•¨ìˆ˜ ëŒ€ì²´)
            document.getElementById('noticeWriteForm').addEventListener('submit', async function (e) {
                e.preventDefault();

                try {
                    const attachment = document.getElementById('noticeFile').files[0];

                    // ì²¨ë¶€íŒŒì¼ì´ ìˆëŠ” ê²½ìš° ì•Œë¦¼ í‘œì‹œ
                    if (attachment) {
                        const fileSize = (attachment.size / 1024 / 1024).toFixed(2);
                        showAlert(`${fileSize}MB íŒŒì¼ ì—…ë¡œë“œ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.`, 'info', 0); // ìë™ìœ¼ë¡œ ë‹«íˆì§€ ì•ŠìŒ
                    }

                    showLoading();

                    const noticeData = {
                        title: document.getElementById('noticeTitle').value,
                        content: document.getElementById('noticeContent').value,
                        region: document.getElementById('noticeRegion').value,
                        is_important: document.getElementById('noticeImportant').checked,
                        attachment: attachment
                    };

                    await createNotice(noticeData);
                    closeNoticeWriteModal();

                    // ì•Œë¦¼ ìˆ¨ê¸°ê¸°
                    hideAlert();

                } catch (error) {
                    console.error('Notice form submission error:', error);
                    showAlert(error.message || 'ê³µì§€ì‚¬í•­ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            });

            // ë¡œê·¸ì¸ ìƒíƒœ ì²´í¬ ë° ê´€ë¦¬ì ê¸°ëŠ¥ í‘œì‹œ
            function checkAdminStatus() {
                const isAdmin = sessionStorage.getItem('role') === 'admin';

                // í™ˆ í™”ë©´ì˜ ê³µì§€ì‚¬í•­ ì„¹ì…˜ì— ìˆëŠ” ë²„íŠ¼
                const noticeActions = document.getElementById('noticeActions');

                console.log('Admin status check:', {
                    role: sessionStorage.getItem('role'),
                    isAdmin: isAdmin,
                    noticeActionsFound: noticeActions ? true : false
                });

                if (noticeActions) {
                    if (isAdmin) {
                        // ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ í™•ì‹¤í•˜ê²Œ í‘œì‹œ
                        noticeActions.classList.remove('hidden');
                        noticeActions.style.display = 'block';
                        noticeActions.style.visibility = 'visible';
                        noticeActions.style.opacity = '1';
                        console.log('Admin detected: Showing write button with multiple style overrides');
                    } else {
                        noticeActions.classList.add('hidden');
                        noticeActions.style.display = 'none';
                        console.log('Not admin: Hiding write button');
                    }
                } else {
                    console.warn('Notice actions element not found - trying to find by selector');
                    // ì„ íƒìë¡œ ì‹œë„
                    const actionsBySelector = document.querySelector('#notices .flex.justify-between div:last-child');
                    if (actionsBySelector && isAdmin) {
                        actionsBySelector.classList.remove('hidden');
                        actionsBySelector.style.display = 'block';
                        console.log('Found by selector and showing');
                    }
                }
            }

            // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
            document.addEventListener('DOMContentLoaded', function () {
                // ê³µì§€ì‚¬í•­ ë¡œë“œ
                loadHomeNotices();
                checkAdminStatus();
                initializeInquirySystem();
                setupSessionValidation();

                document.getElementById('inquiryFile')?.addEventListener('change', function () {
                    const fileNameSpan = document.getElementById('inquirySelectedFileName');
                    if (this.files.length > 0) {
                        const fileName = this.files[0].name;
                        const fileSize = (this.files[0].size / 1024 / 1024).toFixed(2); // MB ë‹¨ìœ„
                        fileNameSpan.textContent = `${fileName} (${fileSize}MB)`;
                        fileNameSpan.classList.remove('text-gray-600');
                        fileNameSpan.classList.add('text-blue-600');
                    } else {
                        fileNameSpan.textContent = 'ì„ íƒëœ íŒŒì¼ ì—†ìŒ';
                        fileNameSpan.classList.remove('text-blue-600');
                        fileNameSpan.classList.add('text-gray-600');
                    }
                });

                // ë‹¤ì¤‘ ë¡œê·¸ì¸ ë°©ì§€ë¥¼ ìœ„í•œ ì„¸ì…˜ ê²€ì¦ ì½”ë“œ
                function setupSessionValidation() {
                    // 1ë¶„ë§ˆë‹¤ ì„¸ì…˜ ìœ íš¨ì„± ê²€ì‚¬
                    setInterval(async () => {
                        try {
                            // í† í°ì´ ìˆì„ ê²½ìš°ì—ë§Œ ê²€ì‚¬
                            const token = sessionStorage.getItem('token');
                            if (!token) return;

                            // ì´ë¯¸ ë¡œê·¸ì¸ í˜ì´ì§€ì— ìˆìœ¼ë©´ ê²€ì‚¬ ì¤‘ë‹¨
                            if (document.getElementById('loginScreen') &&
                                !document.getElementById('loginScreen').classList.contains('hidden')) {
                                return;
                            }

                            const response = await apiRequest('/api/validate-token');

                            // ê²€ì¦ ì‹¤íŒ¨ ì‹œ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
                            if (!response.success) {
                                if (response.message && response.message.includes('ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¡œê·¸ì¸')) {
                                    showAlert('ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¡œê·¸ì¸ì´ ê°ì§€ë˜ì–´ ë¡œê·¸ì•„ì›ƒë©ë‹ˆë‹¤.', 'error');
                                }
                                logout();
                            }
                        } catch (error) {
                            console.error('Session validation error:', error);

                            // ì—ëŸ¬ ë©”ì‹œì§€ê°€ ì„¸ì…˜ ë§Œë£Œ ê´€ë ¨ì´ë©´ ë¡œê·¸ì•„ì›ƒ
                            if (error.message && (
                                error.message.includes('ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¡œê·¸ì¸') ||
                                error.message.includes('ì„¸ì…˜ì´ ë§Œë£Œ') ||
                                error.message.includes('ì¸ì¦')
                            )) {
                                showAlert('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'error');
                                logout();
                            }
                        }
                    }, 60000); // 60ì´ˆ(1ë¶„)ë§ˆë‹¤ ì²´í¬
                }

                // í˜ì´ì§€ ê°€ì‹œì„± ë³€ê²½ ì‹œ ì„¸ì…˜ ê²€ì‚¬
                document.addEventListener('visibilitychange', function () {
                    if (document.visibilityState === 'visible') {
                        // í˜ì´ì§€ê°€ í™œì„±í™”ë  ë•Œ ì¦‰ì‹œ ê²€ì¦
                        (async () => {
                            try {
                                const token = sessionStorage.getItem('token');
                                if (!token) return;

                                // ì´ë¯¸ ë¡œê·¸ì¸ í˜ì´ì§€ì— ìˆìœ¼ë©´ ê²€ì‚¬ ì¤‘ë‹¨
                                if (document.getElementById('loginScreen') &&
                                    !document.getElementById('loginScreen').classList.contains('hidden')) {
                                    return;
                                }

                                const response = await apiRequest('/api/validate-token');
                                if (!response.success) {
                                    if (response.message && response.message.includes('ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¡œê·¸ì¸')) {
                                        showAlert('ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¡œê·¸ì¸ì´ ê°ì§€ë˜ì–´ ë¡œê·¸ì•„ì›ƒë©ë‹ˆë‹¤.', 'error');
                                    }
                                    logout();
                                }
                            } catch (error) {
                                if (error.message && (
                                    error.message.includes('ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¡œê·¸ì¸') ||
                                    error.message.includes('ì„¸ì…˜ì´ ë§Œë£Œ') ||
                                    error.message.includes('ì¸ì¦')
                                )) {
                                    showAlert('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'error');
                                    logout();
                                }
                            }
                        })();
                    }
                });

                document.getElementById('inquiryAnswerForm')?.addEventListener('submit', async function (e) {
                    e.preventDefault();

                    if (!currentInquiryId) {
                        showAlert('ë¬¸ì˜ì‚¬í•­ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                        return;
                    }

                    const answerContent = document.getElementById('adminAnswerContent').value.trim();
                    if (!answerContent) {
                        showAlert('ë‹µë³€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                        return;
                    }

                    try {
                        showLoading();

                        const response = await apiRequest(`/api/admin/inquiries/${currentInquiryId}/answer`, {
                            method: 'POST',
                            body: JSON.stringify({ answer: answerContent })
                        });

                        if (response.success) {
                            showAlert('ë‹µë³€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                            closeInquiryDetailModal();

                            // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì¸ ê²½ìš° ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                            if (!document.getElementById('adminDashboard').classList.contains('hidden')) {
                                loadAdminInquiries();
                            } else {
                                // ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ì¸ ê²½ìš°
                                loadInquiries();
                            }
                        } else {
                            throw new Error(response.message || 'ë‹µë³€ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                        }
                    } catch (error) {
                        console.error('Inquiry answer error:', error);
                        showAlert(error.message || 'ë‹µë³€ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    } finally {
                        hideLoading();
                    }
                });

                // ë””ë²„ê¹… í•¨ìˆ˜ ì „ì—­ìœ¼ë¡œ ë…¸ì¶œ
                window.diagnoseModalIssue = diagnoseModalIssue;

                // í™ˆìœ¼ë¡œ ëŒì•„ê°ˆ ë•Œë„ ê³µì§€ì‚¬í•­ ìƒˆë¡œê³ ì¹¨
                document.querySelectorAll('button[onclick="showHomeScreen()"]').forEach(button => {
                    const originalClick = button.onclick;
                    button.onclick = async function () {
                        originalClick.call(this);
                        await loadHomeNotices();
                        checkAdminStatus();
                    };
                });

                // ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ì´ˆê¸°í™” ë° ê°œì„ 
                initializeNoticeModal();

                // ì—¬ê¸°ì— ì‚­ì œ ëª¨ë‹¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                document.getElementById('cancelDeleteUser')?.addEventListener('click', function () {
                    closeModal('deleteUserModal');
                });

                document.getElementById('confirmDeleteUser')?.addEventListener('click', async function () {
                    closeModal('deleteUserModal');
                    await forceDeleteUser(deleteUserId, deleteUserGroupName);
                });

                // ë””ë²„ê¹… í•¨ìˆ˜ ì¶”ê°€ - ì „ì—­ ìŠ¤ì½”í”„ì— ì •ì˜
                window.debugNotices = function () {
                    console.log('===== ê³µì§€ì‚¬í•­ ë””ë²„ê¹… =====');
                    console.log('ë…ë¦½ ëª¨ë‹¬ ì¡´ì¬:', !!document.getElementById('independentNoticeModal'));
                    console.log('ê³µì§€ì‚¬í•­ ë°ì´í„°:', window.noticesData);
                    console.log('ê³µì§€ì‚¬í•­ ì»¨í…Œì´ë„ˆ:', document.getElementById('noticesListSection'));
                    console.log('loadUserNotices í•¨ìˆ˜:', typeof window.loadUserNotices);
                    console.log('handleNoticeClick í•¨ìˆ˜:', typeof window.handleNoticeClick);
                    console.log('ë¡œê·¸ì¸ ìƒíƒœ:', !!sessionStorage.getItem('token'));
                    console.log('===========================');

                    // ì¤‘ìš”: ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œë§Œ API í˜¸ì¶œ
                    if (sessionStorage.getItem('token') &&
                        document.getElementById('noticesListSection') &&
                        typeof window.loadUserNotices === 'function') {
                        console.log('ê³µì§€ì‚¬í•­ ê°•ì œ ë¡œë“œ ì‹œë„');
                        window.loadUserNotices();
                    }
                };

                // 3ì´ˆ í›„ ë””ë²„ê¹… ì‹¤í–‰ (í˜ì´ì§€ ë¡œë“œ í›„)
                setTimeout(window.debugNotices, 3000);

                // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                setTimeout(() => {
                    const fileInput = document.getElementById('noticeFile');
                    if (fileInput) {
                        fileInput.addEventListener('change', function () {
                            const fileNameSpan = document.getElementById('selectedFileName');
                            if (this.files.length > 0) {
                                const fileName = this.files[0].name;
                                const fileSize = (this.files[0].size / 1024 / 1024).toFixed(2); // MB ë‹¨ìœ„
                                fileNameSpan.textContent = `${fileName} (${fileSize}MB)`;
                                fileNameSpan.classList.remove('text-gray-600');
                                fileNameSpan.classList.add('text-blue-600');
                            } else {
                                fileNameSpan.textContent = 'ì„ íƒëœ íŒŒì¼ ì—†ìŒ';
                                fileNameSpan.classList.remove('text-blue-600');
                                fileNameSpan.classList.add('text-gray-600');
                            }
                        });
                    }
                }, 2000);
            });

            // ì²¨ë¶€íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë§í¬ ìˆ˜ì •ì„ ìœ„í•œ ì£¼ê¸°ì  í™•ì¸
            setInterval(function () {
                const fileLinks = document.querySelectorAll('#independentModalFileLink, #noticeDetailModalFileLink');
                fileLinks.forEach(link => {
                    if (link && link.href && link.href.includes('r2.dev')) {
                        const originalUrl = link.href;
                        const downloadUrl = getDownloadUrl(originalUrl);
                        link.href = downloadUrl;
                        link.setAttribute('download', link.textContent.trim());
                    }
                });
            }, 1000);

            // ìˆ˜ì • í¼ ì œì¶œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('noticeEditForm').addEventListener('submit', async function (e) {
                e.preventDefault();

                try {
                    // ID í™•ì¸
                    if (!window.currentNoticeId) {
                        throw new Error('ê³µì§€ì‚¬í•­ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }

                    console.log('ìˆ˜ì • ì œì¶œ - ê³µì§€ì‚¬í•­ ID:', window.currentNoticeId);

                    showLoading();

                    // ìˆ˜ì •í•  ë°ì´í„° ì¤€ë¹„
                    const formData = {
                        title: document.getElementById('editNoticeTitle').value,
                        content: document.getElementById('editNoticeContent').value,
                        region: document.getElementById('editNoticeRegion').value,
                        is_important: document.getElementById('editNoticeImportant').checked ? 1 : 0
                    };

                    console.log('ìˆ˜ì • ë°ì´í„°:', formData); // ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€

                    // API ìš”ì²­
                    const response = await fetch(`${API_BASE_URL}/api/admin/notices/${window.currentNoticeId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${sessionStorage.getItem('token')}`
                        },
                        body: JSON.stringify(formData)
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || 'ê³µì§€ì‚¬í•­ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    }

                    const data = await response.json();

                    if (data.success) {
                        showAlert('ê³µì§€ì‚¬í•­ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                        closeNoticeEditModal();

                        // ê³µì§€ì‚¬í•­ ë°ì´í„° ì§ì ‘ ìƒˆë¡œ ê°€ì ¸ì˜¤ê¸°
                        try {
                            console.log('ê³µì§€ì‚¬í•­ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘');

                            // APIì—ì„œ ìµœì‹  ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                            const noticesResponse = await apiRequest('/api/notices');
                            if (noticesResponse.success && noticesResponse.data) {
                                console.log(`${noticesResponse.data.length}ê°œ ê³µì§€ì‚¬í•­ ë°ì´í„° ë°›ìŒ`);

                                // ìƒˆë¡œ ê°€ì ¸ì˜¨ ë°ì´í„° ì •ë ¬ ë° ì €ì¥
                                window.noticesData = sortNoticesByImportanceAndDate(noticesResponse.data);
                                console.log('ê³µì§€ì‚¬í•­ ë°ì´í„° ìƒˆë¡œ ê°€ì ¸ì™€ì„œ ì •ë ¬ ì™„ë£Œ');

                                // í™ˆí™”ë©´ ê³µì§€ì‚¬í•­ ëª©ë¡ ë‹¤ì‹œ ë Œë”ë§
                                if (document.getElementById('homeNoticesList')) {
                                    console.log('í™ˆí™”ë©´ ê³µì§€ì‚¬í•­ ëª©ë¡ ë Œë”ë§ ì‹œì‘');
                                    renderNoticesList(window.noticesData, 'homeNoticesList');
                                }

                                // ëŒ€ì‹œë³´ë“œ ê³µì§€ì‚¬í•­ ëª©ë¡ ë‹¤ì‹œ ë Œë”ë§
                                if (document.getElementById('noticesListSection')) {
                                    console.log('ëŒ€ì‹œë³´ë“œ ê³µì§€ì‚¬í•­ ëª©ë¡ ë Œë”ë§ ì‹œì‘');
                                    // í•¨ìˆ˜ê°€ ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ í›„ í˜¸ì¶œ
                                    if (typeof renderUserNoticesList === 'function') {
                                        renderUserNoticesList(window.noticesData, document.getElementById('noticesListSection'));
                                    } else {
                                        console.warn('renderUserNoticesList í•¨ìˆ˜ê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
                                        // ëŒ€ì²´ ë°©ë²•ìœ¼ë¡œ ì¼ë°˜ renderNoticesList í•¨ìˆ˜ ì‚¬ìš©
                                        renderNoticesList(window.noticesData, 'noticesListSection');
                                    }
                                }
                            }
                        } catch (fetchError) {
                            console.error('ê³µì§€ì‚¬í•­ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì˜¤ë¥˜:', fetchError);
                            // ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œ í´ë°±
                            console.log('ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œ ê³µì§€ì‚¬í•­ ìƒˆë¡œê³ ì¹¨ ì‹œë„');
                            await loadHomeNotices();
                            if (document.getElementById('noticesListSection')) {
                                await loadNotices();
                            }
                        }

                        // ì¤‘ìš”: ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë‹¤ì‹œ ì¶”ê°€ (ì§€ì—° ì‹œê°„ ì¦ê°€)
                        setTimeout(addDirectNoticeListeners, 500);
                    } else {
                        throw new Error(data.message || 'ê³µì§€ì‚¬í•­ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('Notice update error:', error);
                    showAlert(error.message || 'ê³µì§€ì‚¬í•­ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            });

            // ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ì´ˆê¸°í™” í•¨ìˆ˜ - í˜ì´ì§€ ë¡œë“œ ì‹œ ì¦‰ì‹œ ì‹¤í–‰
            function initializeNoticeModal() {
                console.log('ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ì´ˆê¸°í™” ì‹œì‘');

                // ë…ë¦½ ê³µì§€ì‚¬í•­ ëª¨ë‹¬ì´ ì—†ìœ¼ë©´ ìƒì„±
                if (!document.getElementById('independentNoticeModal')) {
                    console.log('ë…ë¦½ ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ìƒì„±');
                    const modalHTML = `
      <div id="independentNoticeModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
          background-color:rgba(0,0,0,0.75); z-index:99999; align-items:center; justify-content:center;">
          <div style="background:white; max-width:800px; width:90%; border-radius:10px; padding:20px; position:relative; max-height:80vh; overflow-y:auto;">
              <button id="independentModalClose" style="position:absolute; top:10px; right:10px; background:none; border:none; 
              font-size:24px; cursor:pointer; width:30px; height:30px; line-height:30px; text-align:center;">Ã—</button>
              <h2 id="independentModalTitle" style="margin-bottom:15px; font-size:22px; font-weight:bold;"></h2>
              <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:14px; color:#666;">
                  <span id="independentModalAuthor"></span>
                  <span id="independentModalDate"></span>
              </div>
              <div style="border-top:1px solid #eee; padding-top:15px;">
                  <p id="independentModalContent" style="white-space:pre-line; line-height:1.5;"></p>
              </div>
          </div>
      </div>
    `;
                    document.body.insertAdjacentHTML('beforeend', modalHTML);

                    // ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
                    document.getElementById('independentModalClose').onclick = function () {
                        document.getElementById('independentNoticeModal').style.display = 'none';
                        document.body.style.overflow = '';
                    };
                }

                // ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ ì¶”ê°€
                enhanceNoticeDetailModal();
            }

            // ê³µì§€ì‚¬í•­ ìƒì„¸ ëª¨ë‹¬ ê°œì„  í•¨ìˆ˜
            function enhanceNoticeDetailModal() {
                console.log('ê³µì§€ì‚¬í•­ ìƒì„¸ ëª¨ë‹¬ ê°œì„  ì‹œì‘');

                // ë…ë¦½ ëª¨ë‹¬ì— ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ ì¶”ê°€
                const modal = document.getElementById('independentNoticeModal');
                if (!modal) {
                    console.error('independentNoticeModalì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }

                const modalContent = modal.querySelector('div:first-child');
                if (!modalContent) {
                    console.error('ëª¨ë‹¬ ì»¨í…ì¸  ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }

                // 1. ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ì´ ì´ë¯¸ ìˆëŠ”ì§€ í™•ì¸ í›„ ì¶”ê°€
                if (!document.getElementById('independentModalAttachment')) {
                    const attachmentSection = document.createElement('div');
                    attachmentSection.id = 'independentModalAttachment';
                    attachmentSection.style.marginTop = '20px';
                    attachmentSection.style.paddingTop = '15px';
                    attachmentSection.style.borderTop = '1px solid #eee';
                    attachmentSection.style.display = 'none';

                    attachmentSection.innerHTML = `
      <h3 style="font-weight:bold; margin-bottom:10px; font-size:16px;">ì²¨ë¶€íŒŒì¼</h3>
      <div id="independentModalFile" style="display:flex; align-items:center;">
        <a id="independentModalFileLink" href="#" target="_blank" download
           style="display:inline-flex; align-items:center; padding:8px 12px; background:#f3f4f6; border-radius:4px; text-decoration:none; color:#374151; font-size:14px;">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" style="margin-right:8px;" viewBox="0 0 16 16">
            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
          </svg>
          <span id="independentModalFileName">íŒŒì¼ ë‹¤ìš´ë¡œë“œ</span>
        </a>
      </div>
    `;

                    modalContent.appendChild(attachmentSection);
                    console.log('ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ì´ ëª¨ë‹¬ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
                }

                // 2. ê´€ë¦¬ì ì•¡ì…˜ ë²„íŠ¼ ì¶”ê°€ (ì—†ëŠ” ê²½ìš°ì—ë§Œ)
                if (!document.getElementById('independentModalActions')) {
                    const adminActions = document.createElement('div');
                    adminActions.id = 'independentModalActions';
                    adminActions.style.display = 'flex';
                    adminActions.style.justifyContent = 'flex-end';
                    adminActions.style.marginTop = '20px';
                    adminActions.style.paddingTop = '15px';
                    adminActions.style.borderTop = '1px solid #eee';
                    adminActions.innerHTML = `
      <button id="editNoticeBtn" style="background:#3B82F6; color:white; padding:8px 16px; border-radius:4px; margin-right:8px; cursor:pointer; border:none;">ìˆ˜ì •</button>
      <button id="deleteNoticeBtn" style="background:#EF4444; color:white; padding:8px 16px; border-radius:4px; cursor:pointer; border:none;">ì‚­ì œ</button>
    `;
                    adminActions.style.display = 'none'; // ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€

                    modalContent.appendChild(adminActions);
                    console.log('ê´€ë¦¬ì ì•¡ì…˜ ë²„íŠ¼ì´ ëª¨ë‹¬ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');

                    // ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                    document.getElementById('editNoticeBtn').addEventListener('click', function () {
                        modal.style.display = 'none';
                        editNotice(); // ê¸°ì¡´ ìˆ˜ì • í•¨ìˆ˜ í˜¸ì¶œ
                    });

                    document.getElementById('deleteNoticeBtn').addEventListener('click', function () {
                        deleteNotice(); // ê¸°ì¡´ ì‚­ì œ í•¨ìˆ˜ í˜¸ì¶œ
                    });
                }
            }

            // ê³µì§€ì‚¬í•­ ëª©ë¡ ë¡œë“œ í›„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¬ì„¤ì •
            const originalLoadHomeNotices = window.loadHomeNotices;
            if (originalLoadHomeNotices) {
                window.loadHomeNotices = async function () {
                    await originalLoadHomeNotices.apply(this, arguments);

                    // ê³µì§€ì‚¬í•­ í•­ëª©ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë‹¤ì‹œ ì¶”ê°€
                    setTimeout(() => {
                        const noticeItems = document.querySelectorAll('.notice-item');
                        console.log('ê³µì§€ì‚¬í•­ í•­ëª© ìˆ˜:', noticeItems.length);

                        noticeItems.forEach(item => {
                            // ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±°
                            const clone = item.cloneNode(true);
                            item.parentNode.replaceChild(clone, item);

                            // ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€
                            clone.addEventListener('click', window.handleNoticeClick);
                        });

                        console.log('ê³µì§€ì‚¬í•­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¬ì„¤ì • ì™„ë£Œ');
                    }, 500);
                };
            }

            // í˜„ì¬ í‘œì‹œëœ ê³µì§€ì‚¬í•­ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¦‰ì‹œ ì¶”ê°€
            setTimeout(() => {
                const noticeItems = document.querySelectorAll('.notice-item');
                console.log('í˜„ì¬ ê³µì§€ì‚¬í•­ í•­ëª© ìˆ˜:', noticeItems.length);

                noticeItems.forEach(item => {
                    // ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±°
                    const clone = item.cloneNode(true);
                    item.parentNode.replaceChild(clone, item);

                    // ìƒˆ ì´ë²¤íŠ¸ ì¶”ê°€
                    clone.addEventListener('click', window.handleNoticeClick);
                });

                console.log('í˜„ì¬ ê³µì§€ì‚¬í•­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ');
            }, 500);

            // ì‹œêµ° ì„ íƒ ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™” ìˆ˜ì •
            function initializeCitySelect() {
                const citySelect = document.getElementById('city');
                citySelect.innerHTML = '<option value="">ì‹œ/êµ°ì„ ì„ íƒí•˜ì„¸ìš”</option>';

                // ëª¨ë“  ì‹œêµ°ì„ ì•ŒíŒŒë²³ ìˆœìœ¼ë¡œ ì •ë ¬
                [...REGION_MAPPING.south, ...REGION_MAPPING.north]  // REGION_MAPPING ì‚¬ìš©
                    .sort()
                    .forEach(city => {
                        citySelect.innerHTML += `<option value="${city}">${city}</option>`;
                    });
            }

            // ì‹œêµ° ì„ íƒì— ë”°ë¥¸ ì§€ì—­ ìë™ ë¶„ë¥˜ í•¨ìˆ˜ (ì—ëŸ¬ ì²˜ë¦¬ë§Œ ì¶”ê°€)
            function determineRegion(city) {
                if (REGION_MAPPING.south.includes(city)) return 'south';
                if (REGION_MAPPING.north.includes(city)) return 'north';
                throw new Error('ì˜¬ë°”ë¥¸ ì‹œ/êµ°ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');  // null ë°˜í™˜ ëŒ€ì‹  ì—ëŸ¬ ë°œìƒ
            }

            // ì „ì—­ ìƒíƒœ ê´€ë¦¬
            let currentUser = null;
            let bookingStatus = {};
            let isLoading = false;
            let currentSelectedDate = null;
            let currentNoticeId = null;
            let isSubmittingInquiry = false; // í”Œë˜ê·¸ ì¶”ê°€
            let allUsersData = [];
            let currentUserPage = 1;
            const usersPerPage = 10;

            // ë¡œë”© ì¸ë””ì¼€ì´í„° ì œì–´
            function showLoading() {
                if (!isLoading) {
                    isLoading = true;
                    document.getElementById('loading').classList.add('show');
                }
            }

            function hideLoading() {
                isLoading = false;
                document.getElementById('loading').classList.remove('show');
            }

            // ë””ë²„ê¹… í•¨ìˆ˜
            function debugNotices() {
                console.log('=== ê³µì§€ì‚¬í•­ ë””ë²„ê¹… ===');
                console.log('noticesData:', window.noticesData);

                // í™ˆí™”ë©´ ê³µì§€ì‚¬í•­
                const homeNotices = document.getElementById('homeNoticesList');
                if (homeNotices) {
                    console.log('homeNoticesList ìš”ì†Œ:', homeNotices);
                    console.log('homeNoticesList ê³µì§€ì‚¬í•­ í•­ëª© ìˆ˜:', homeNotices.querySelectorAll('.notice-item').length);
                } else {
                    console.log('homeNoticesList ìš”ì†Œê°€ ì—†ìŒ');
                }

                // ëŒ€ì‹œë³´ë“œ ê³µì§€ì‚¬í•­
                const dashboardNotices = document.getElementById('noticesListSection');
                if (dashboardNotices) {
                    console.log('noticesListSection ìš”ì†Œ:', dashboardNotices);
                    console.log('noticesListSection ê³µì§€ì‚¬í•­ í•­ëª© ìˆ˜:', dashboardNotices.querySelectorAll('.notice-item').length);
                } else {
                    console.log('noticesListSection ìš”ì†Œê°€ ì—†ìŒ');
                }

                console.log('======================');
            }

            // ì „ì—­ ìŠ¤ì½”í”„ì— í•¨ìˆ˜ ë…¸ì¶œ
            window.debugNotices = debugNotices;

            // ì•Œë¦¼ ë©”ì‹œì§€ í‘œì‹œ
            function showAlert(message, type = 'info', duration = 3000) {
                const alert = document.getElementById('alert');
                const alertMessage = document.getElementById('alertMessage');
                const alertIcon = document.getElementById('alertIcon').firstElementChild;

                alertMessage.textContent = message;
                alert.classList.remove('hidden');

                switch (type) {
                    case 'success':
                        alertIcon.className = 'fas fa-check-circle text-green-500';
                        break;
                    case 'error':
                        alertIcon.className = 'fas fa-exclamation-circle text-red-500';
                        break;
                    default:
                        alertIcon.className = 'fas fa-info-circle text-blue-500';
                }

                if (duration > 0) {
                    setTimeout(hideAlert, duration);
                }
            }

            function hideAlert() {
                document.getElementById('alert').classList.add('hidden');
            }

            // ì²¨ë¶€íŒŒì¼ URLì„ ë‹¤ìš´ë¡œë“œ URLë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
            function getDownloadUrl(attachmentUrl) {
                if (!attachmentUrl) return '';
                const fileName = attachmentUrl.split('/').pop();
                return `https://sports-box-api.parkkwangmin9209.workers.dev/api/attachments/${fileName}`;
            }

            // ì²¨ë¶€íŒŒì¼ ë§í¬ë¥¼ ê°•ì œë¡œ ë‹¤ìš´ë¡œë“œí•˜ê²Œ ë§Œë“œëŠ” í•¨ìˆ˜
            function forceFileDownload(url, fileName) {
                // ë§í¬ë¥¼ ìƒˆë¡œ ìƒì„±í•˜ì—¬ download ì†ì„± ì„¤ì •
                const link = document.createElement('a');
                link.href = url;
                link.download = fileName || 'download';
                link.target = '_blank';

                // ë§í¬ë¥¼ DOMì— ì¶”ê°€í•˜ê³  í´ë¦­ ì´ë²¤íŠ¸ ë°œìƒ
                document.body.appendChild(link);
                link.click();

                // ë§í¬ ì œê±°
                setTimeout(() => {
                    document.body.removeChild(link);
                }, 100);

                return false; // ê¸°ë³¸ ë™ì‘ ë°©ì§€
            }

            // DOMContentLoaded ë‚´ì— ë‹¤ìŒ ì½”ë“œ ì¶”ê°€
            document.addEventListener('DOMContentLoaded', function () {
                // ê¸°ì¡´ ì½”ë“œ...

                // ëª¨ë“  ì²¨ë¶€íŒŒì¼ ë§í¬ì— í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€ (ì£¼ê¸°ì  ì²´í¬)
                setInterval(function () {
                    const fileLinks = document.querySelectorAll('#independentModalFileLink, #noticeDetailModalFileLink');
                    fileLinks.forEach(link => {
                        // ì´ë¯¸ ì²˜ë¦¬ëœ ë§í¬ ê±´ë„ˆë›°ê¸°
                        if (link.getAttribute('data-download-handler')) return;

                        // ì²˜ë¦¬ í‘œì‹œ ì¶”ê°€
                        link.setAttribute('data-download-handler', 'true');

                        // ê¸°ë³¸ href ìˆ˜ì •
                        if (link.href && link.href.includes('r2.dev')) {
                            const originalUrl = link.href;
                            const downloadUrl = getDownloadUrl(originalUrl);
                            link.href = downloadUrl;
                        }

                        // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                        link.addEventListener('click', function (e) {
                            e.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€
                            e.stopPropagation(); // ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì§€

                            const fileName = this.textContent.trim() || 'download';
                            forceFileDownload(this.href, fileName);

                            return false;
                        });
                    });
                }, 1000);
            });

            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬ í•¨ìˆ˜
            function cleanupEventListeners() {
                // ê³µì§€ì‚¬í•­ ëª©ë¡ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°
                const noticesList = document.getElementById('homeNoticesList');
                if (noticesList) {
                    const newElement = noticesList.cloneNode(true);
                    noticesList.parentNode.replaceChild(newElement, noticesList);
                    console.log('ê³µì§€ì‚¬í•­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬ë¨');
                }
            }

            // ë‚¨ì€ ì˜ˆì•½ íšŸìˆ˜ í‘œì‹œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
            function updateRemainingBookingsDisplay(remainingBookings) {
                const bookingCountElement = document.getElementById('remainingBookings');
                if (bookingCountElement) {
                    bookingCountElement.textContent = `ì´ë²ˆ ë‹¬ ë‚¨ì€ ì˜ˆì•½ ê°€ëŠ¥ íšŸìˆ˜: ${remainingBookings}íšŒ`;
                    bookingCountElement.className = remainingBookings > 0 ?
                        'px-4 py-2 bg-green-50 text-green-700 rounded-full text-sm font-medium' :
                        'px-4 py-2 bg-red-50 text-red-700 rounded-full text-sm font-medium';
                }
            }

            // API ìš”ì²­ í—¬í¼ í•¨ìˆ˜
            async function apiRequest(endpoint, options = {}) {
                showLoading();
                try {
                    const token = sessionStorage.getItem('token');
                    if (!token && !endpoint.includes('/login') && !endpoint.includes('/signup')
                        && !endpoint.includes('/public')) {
                        throw new Error('ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    }

                    const defaultHeaders = {
                        ...(token ? { 'Authorization': `Bearer ${token}` } : {})
                    };
                    if (options.body && !(options.body instanceof FormData)) {
                        defaultHeaders['Content-Type'] = 'application/json';
                    }

                    console.log(`[apiRequest] ìš”ì²­: ${endpoint}`, {
                        method: options.method,
                        headers: { ...defaultHeaders, ...options.headers },
                        body: options.body instanceof FormData ? '[FormData]' : options.body
                    });

                    const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                        ...options,
                        headers: {
                            ...defaultHeaders,
                            ...options.headers
                        }
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
                    }

                    const data = await response.json();
                    if (!endpoint.includes('/login')) {
                        console.log(`[apiRequest] ì‘ë‹µ:`, data);
                    }
                    return data;
                } catch (error) {
                    console.error(`[apiRequest] ì˜¤ë¥˜: ${endpoint}`, error);
                    if (error.message.includes('ì¸ì¦') && !endpoint.includes('/login') && !endpoint.includes('/signup')
                        && !endpoint.includes('/public')) {
                        logout();
                    }
                    throw error;
                } finally {
                    hideLoading();
                }
            }

            // í™”ë©´ ì „í™˜ í•¨ìˆ˜ë“¤
            function showHomeScreen() {
                // í˜„ì¬ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
                const token = sessionStorage.getItem('token');
                const role = sessionStorage.getItem('role');

                // ëª¨ë“  í™”ë©´ ìˆ¨ê¸°ê¸°
                const homeScreen = document.getElementById('mainContainer')?.querySelector('#homeScreen');
                if (!homeScreen) return;

                homeScreen.classList.remove('hidden');
                document.getElementById('loginAndReservationSystem')?.classList.add('hidden');
                document.getElementById('loginScreen')?.classList.add('hidden');
                document.getElementById('userDashboard')?.classList.add('hidden');
                document.getElementById('adminDashboard')?.classList.add('hidden');

                // ê³µì§€ì‚¬í•­ ìƒˆë¡œê³ ì¹¨
                loadHomeNotices();

                // ë¡œê·¸ì¸ ìƒíƒœì¼ ê²½ìš° ë„¤ë¹„ê²Œì´ì…˜ ë°” ìˆ˜ì •
                if (token && role) {
                    const homeNav = homeScreen.querySelector('nav');
                    if (!homeNav) return;

                    const navButtons = homeNav.querySelector('.items-center.space-x-8');
                    if (!navButtons) return;

                    const username = sessionStorage.getItem('username');
                    const region = sessionStorage.getItem('region');

                    // ê¸°ì¡´ ë¡œê·¸ì¸/íšŒì›ê°€ì… ë²„íŠ¼ ì°¾ê¸°
                    const loginButton = navButtons.querySelector('button');
                    if (loginButton) {
                        loginButton.style.display = 'none';
                    }

                    // ì´ë¯¸ ì¶”ê°€ëœ ë¡œê·¸ì¸ ìƒíƒœ ë²„íŠ¼ë“¤ì´ ìˆë‹¤ë©´ ì œê±°
                    const existingLoginButtons = navButtons.querySelector('.login-state-buttons');
                    if (existingLoginButtons) {
                        existingLoginButtons.remove();
                    }

                    // ìƒˆë¡œìš´ ë²„íŠ¼ë“¤ ì¶”ê°€
                    const newButtons = document.createElement('div');
                    newButtons.className = 'flex items-center space-x-4 login-state-buttons';

                    // ì§€ì—­ ë±ƒì§€ ìŠ¤íƒ€ì¼ ì„¤ì •
                    let regionBadgeStyle = '';
                    if (region === 'south') {
                        regionBadgeStyle = 'bg-blue-100 text-blue-800';
                    } else if (region === 'north') {
                        regionBadgeStyle = 'bg-green-100 text-green-800';
                    } else if (region === 'all') {
                        regionBadgeStyle = 'bg-purple-100 text-purple-800';
                    }

                    newButtons.innerHTML = `
            <span class="text-gray-700 font-medium px-3 py-1 bg-gray-100 rounded-full">
                ${username || 'ì‚¬ìš©ì'}
            </span>
            <span class="px-3 py-1 rounded-full text-sm font-medium ${regionBadgeStyle}">
                ${region === 'south' ? 'ë‚¨ë¶€' : region === 'north' ? 'ë¶ë¶€' : 'ì „ì²´'}
            </span>
            <button onclick="returnToDashboard()" 
                class="bg-primary text-white px-4 py-2 rounded-button hover:bg-primary/90 transition-all duration-200 flex items-center space-x-2">
                <i class="fas fa-tachometer-alt"></i>
                <span>ëŒ€ì‹œë³´ë“œ</span>
            </button>
            <button onclick="logout()" 
                class="bg-gray-500 text-white px-4 py-2 rounded-button hover:bg-gray-600 transition-all duration-200 flex items-center space-x-2">
                <i class="fas fa-sign-out-alt"></i>
                <span>ë¡œê·¸ì•„ì›ƒ</span>
            </button>
        `;

                    navButtons.appendChild(newButtons);
                }

                // ì¤‘ìš”: ë„¤ë¹„ê²Œì´ì…˜ ë°” ìˆ˜ì • í›„ ê´€ë¦¬ì ìƒíƒœ í™•ì¸
                checkAdminStatus();
            }

            // ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ëŠ” í•¨ìˆ˜
            function returnToDashboard() {
                const role = sessionStorage.getItem('role');
                if (role) {
                    showDashboard(role);
                } else {
                    showAlert('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'error');
                    logout();
                }
            }

            function showLoginScreen() {
                // ê³µì§€ì‚¬í•­ ëª¨ë‹¬ì´ ì—´ë ¤ìˆë‹¤ë©´ ë‹«ê¸°
                const noticeModal = document.getElementById('noticeDetailModal');
                if (noticeModal && (noticeModal.classList.contains('show') || noticeModal.style.display === 'flex')) {
                    closeNoticeDetail();
                }

                // í˜„ì¬ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
                const token = sessionStorage.getItem('token');
                const role = sessionStorage.getItem('role');

                // ì´ë¯¸ ë¡œê·¸ì¸ëœ ìƒíƒœë¼ë©´ ì§ì ‘ ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
                if (token && role) {
                    const region = sessionStorage.getItem('region');
                    const username = sessionStorage.getItem('username');

                    // ê¸°ë³¸ í™”ë©´ ì „í™˜
                    document.getElementById('mainContainer').querySelector('#homeScreen').classList.add('hidden');
                    document.getElementById('loginAndReservationSystem').classList.remove('hidden');
                    document.getElementById('loginScreen').classList.add('hidden');

                    if (role === 'admin') {
                        // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ í‘œì‹œ
                        document.getElementById('adminDashboard').classList.remove('hidden');
                        document.getElementById('userDashboard').classList.add('hidden');
                        initializeAdminDashboard(region, username);
                    } else {
                        // ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ í‘œì‹œ
                        document.getElementById('userDashboard').classList.remove('hidden');
                        document.getElementById('adminDashboard').classList.add('hidden');
                        initializeUserDashboard(region, username);
                    }
                    return;
                }

                // ë¡œê·¸ì¸ë˜ì§€ ì•Šì€ ìƒíƒœë¼ë©´ ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
                document.getElementById('mainContainer').querySelector('#homeScreen').classList.add('hidden');
                document.getElementById('loginAndReservationSystem').classList.remove('hidden');
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('userDashboard').classList.add('hidden');
                document.getElementById('adminDashboard').classList.add('hidden');
            }

            // ëŒ€ì‹œë³´ë“œ í‘œì‹œ í•¨ìˆ˜
            async function showDashboard(role) {
                try {
                    showLoading();

                    // í† í° ìœ íš¨ì„± í™•ì¸
                    const token = sessionStorage.getItem('token');
                    if (!token) {
                        throw new Error('ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    }

                    // ê¸°ë³¸ í™”ë©´ ì „í™˜
                    document.getElementById('mainContainer').querySelector('#homeScreen').classList.add('hidden');
                    document.getElementById('loginScreen').classList.add('hidden');
                    document.getElementById('loginAndReservationSystem').classList.remove('hidden');

                    const region = sessionStorage.getItem('region');
                    const username = sessionStorage.getItem('username');
                    const dashboardTitle = region === 'south' ? 'ë‚¨ë¶€ ìŠ¤í¬ì¸ ë°•ìŠ¤' :
                        region === 'north' ? 'ë¶ë¶€ ìŠ¤í¬ì¸ ë°•ìŠ¤' :
                            'ìŠ¤í¬ì¸ ë°•ìŠ¤ ê´€ë¦¬ì';

                    // ì´ì „ ëŒ€ì‹œë³´ë“œ ìƒíƒœ ì´ˆê¸°í™”
                    document.getElementById('adminDashboard').classList.add('hidden');
                    document.getElementById('userDashboard').classList.add('hidden');

                    if (role === 'admin') {
                        // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ í‘œì‹œ
                        document.getElementById('adminDashboard').classList.remove('hidden');

                        // ê´€ë¦¬ì íƒ€ì…ì— ë”°ë¥¸ UI ì¡°ì •
                        if (region === 'all') {
                            document.querySelector('#adminDashboard .dashboard-title').textContent = 'ìŠ¤í¬ì¸ ë°•ìŠ¤ ê´€ë¦¬ì';
                            document.getElementById('regionFilter').classList.remove('hidden');
                            document.getElementById('regionFilterContainer').classList.remove('hidden');
                        } else {
                            document.querySelector('#adminDashboard .dashboard-title').textContent = dashboardTitle;
                            document.getElementById('regionFilter').classList.add('hidden');
                            document.getElementById('regionFilterContainer').classList.add('hidden');
                        }

                        // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
                        await initializeAdminDashboard(region, username);

                    } else {
                        // ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ í‘œì‹œ
                        document.getElementById('userDashboard').classList.remove('hidden');
                        document.getElementById('adminDashboard').classList.add('hidden');

                        // ëŒ€ì‹œë³´ë“œ ì œëª© ì„¤ì •
                        document.querySelector('#userDashboard .dashboard-title').textContent = dashboardTitle;

                        try {
                            // ì˜ˆì•½ ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
                            const settings = await apiRequest('/api/booking-settings');
                            updateUserDashboardState(settings.data?.is_active);

                            // ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™”
                            await initializeUserDashboard(region, username);
                        } catch (error) {
                            console.error('User dashboard initialization error:', error);
                            if (error.message.includes('ì¸ì¦')) {
                                logout();
                                showAlert('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'error');
                            } else {
                                showAlert('ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                            }
                        }
                    }

                } catch (error) {
                    console.error('Dashboard initialization error:', error);
                    if (error.message.includes('ì¸ì¦')) {
                        logout();
                        showAlert('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'error');
                    } else {
                        showAlert('ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                } finally {
                    hideLoading();
                }
            }

            async function initializeUserDashboard(region, username) {
                document.getElementById('userDashboard').classList.remove('hidden');
                document.getElementById('adminDashboard').classList.add('hidden');

                document.querySelector('#userDashboard .dashboard-title').textContent = region === 'south' ? 'ë‚¨ë¶€ ìŠ¤í¬ì¸ ë°•ìŠ¤' : 'ë¶ë¶€ ìŠ¤í¬ì¸ ë°•ìŠ¤';
                document.getElementById('userGroupName').textContent = username;

                const regionBadge = document.getElementById('regionBadge');
                regionBadge.textContent = region === 'south' ? 'ë‚¨ë¶€' : 'ë¶ë¶€';
                regionBadge.className = `px-3 py-1 rounded-full text-sm font-medium ${region === 'south' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'}`;

                try {
                    const settings = await apiRequest('/api/booking-settings');
                    updateUserDashboardState(settings.data?.is_active);

                    initializeCalendar();
                    initializeTimeSelects();
                    await debouncedUpdateCalendarStatus();
                    await loadBookings();

                    // ê³µì§€ì‚¬í•­ ë¡œë“œ (í•¨ìˆ˜ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ í›„ í˜¸ì¶œ)
                    if (typeof window.loadUserNotices === 'function') {
                        console.log('ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì¤‘ ê³µì§€ì‚¬í•­ ë¡œë“œ í˜¸ì¶œ');
                        await window.loadUserNotices();
                    } else {
                        console.error('loadUserNotices í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    }

                    // ë‚¨ì€ ì˜ˆì•½ íšŸìˆ˜ í‘œì‹œ ì—…ë°ì´íŠ¸
                    updateRemainingBookingsDisplay();
                } catch (error) {
                    console.error('User dashboard initialization error:', error);
                    showAlert('ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    throw error;
                }
            }

            // ì‚¬ìš©ì í”„ë¡œí•„ ê´€ë¦¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
            function showUserProfileModal() {
                // í˜„ì¬ ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
                document.getElementById('userGroupName').value = sessionStorage.getItem('username');
                document.getElementById('userManager').value = sessionStorage.getItem('manager');
                document.getElementById('userContact').value = sessionStorage.getItem('contact');

                // ë¹„ë°€ë²ˆí˜¸ í•„ë“œ ì´ˆê¸°í™”
                document.getElementById('userCurrentPassword').value = '';
                document.getElementById('userNewPassword').value = '';
                document.getElementById('userConfirmPassword').value = '';

                openModal('userProfileModal');
            }

            function closeUserProfileModal() {
                closeModal('userProfileModal');
                document.getElementById('userProfileForm').reset();
            }

            // ì‚¬ìš©ì í”„ë¡œí•„ í¼ ì œì¶œ
            document.getElementById('userProfileForm').addEventListener('submit', async function (e) {
                e.preventDefault();

                try {
                    const formData = {
                        manager: document.getElementById('userManager').value.trim(),
                        contact: document.getElementById('userContact').value.trim()
                    };

                    // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì´ í¬í•¨ëœ ê²½ìš°
                    const currentPassword = document.getElementById('userCurrentPassword').value;
                    const newPassword = document.getElementById('userNewPassword').value;
                    const confirmPassword = document.getElementById('userConfirmPassword').value;

                    if (currentPassword || newPassword || confirmPassword) {
                        if (!currentPassword) {
                            showAlert('í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                            return;
                        }
                        if (newPassword !== confirmPassword) {
                            showAlert('ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                            return;
                        }
                        if (newPassword && !/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(newPassword)) {
                            showAlert('ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸ê³¼ ìˆ«ìë¥¼ í¬í•¨í•˜ì—¬ 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error');
                            return;
                        }
                        formData.currentPassword = currentPassword;
                        formData.newPassword = newPassword;
                    }

                    showLoading();

                    const response = await apiRequest('/api/user/profile', {
                        method: 'PUT',
                        body: JSON.stringify(formData)
                    });

                    if (response.success) {
                        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì •ë³´ ì—…ë°ì´íŠ¸
                        sessionStorage.setItem('manager', formData.manager);
                        sessionStorage.setItem('contact', formData.contact);

                        showAlert('ê³„ì • ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                        closeUserProfileModal();

                        // ë„¤ë¹„ê²Œì´ì…˜ ë°” ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸
                        document.getElementById('userGroupName').textContent = sessionStorage.getItem('username');
                    }
                } catch (error) {
                    console.error('Profile update error:', error);
                    showAlert(error.message || 'ê³„ì • ì •ë³´ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            });

            // ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
            document.getElementById('closeUserProfile').addEventListener('click', closeUserProfileModal);

            async function initializeAdminDashboard(region, username) {
                try {
                    // í† í° ìœ íš¨ì„± ë¨¼ì € í™•ì¸
                    const token = sessionStorage.getItem('token');
                    if (!token) {
                        throw new Error('ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    }

                    // ëŒ€ì‹œë³´ë“œ í‘œì‹œ ì„¤ì •
                    document.getElementById('adminDashboard').classList.remove('hidden');
                    document.getElementById('userDashboard').classList.add('hidden');
                    document.getElementById('adminName').textContent = username;

                    const regionFilterContainer = document.getElementById('regionFilterContainer');
                    const regionFilter = document.getElementById('regionFilter');
                    const adminRegionBadge = document.getElementById('adminRegionBadge');
                    const dashboardTitle = document.querySelector('#adminDashboard .dashboard-title');

                    if (region === 'all') {
                        // ì „ì²´ ê´€ë¦¬ì ì„¤ì •
                        dashboardTitle.textContent = 'ìŠ¤í¬ì¸ ë°•ìŠ¤ ê´€ë¦¬ì';
                        regionFilterContainer.classList.remove('hidden');
                        adminRegionBadge.textContent = 'ì „ì²´ ê´€ë¦¬ì';
                        adminRegionBadge.className = 'px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800';

                        // ì§€ì—­ í•„í„° ì´ˆê¸°ê°’ ì„¤ì • ë° ìƒíƒœ ë¡œë“œ
                        const selectedRegion = regionFilter.value;
                        const settings = await loadAdminBookingSettings();
                        updateBookingStatusUI(settings?.is_active || false);

                        // ì§€ì—­ í•„í„° ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                        regionFilter.removeEventListener('change', refreshAdminDashboard);
                        regionFilter.addEventListener('change', async function (e) {
                            try {
                                const selectedRegion = e.target.value;

                                // ì˜ˆì•½ ì„¤ì • ìƒíƒœ ë¡œë“œ
                                const response = await apiRequest('/api/admin/booking-settings');
                                if (response.success) {
                                    const settings = response.data;
                                    const regionSettings = settings[selectedRegion];
                                    updateBookingStatusUI(regionSettings?.is_active || false);
                                }

                                // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                                await Promise.all([
                                    loadRegionStatistics(),
                                    debouncedUpdateCalendarStatus(),
                                    loadPendingBookings()
                                ]);
                            } catch (error) {
                                console.error('Region filter change error:', error);
                                if (error.message.includes('ì¸ì¦')) {
                                    logout();
                                    showAlert('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'error');
                                } else {
                                    showAlert('ì§€ì—­ ì„¤ì • ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                                }
                            }
                        });

                    } else {
                        // ì§€ì—­ ê´€ë¦¬ì ì„¤ì •
                        const regionText = region === 'south' ? 'ë‚¨ë¶€' : 'ë¶ë¶€';
                        dashboardTitle.textContent = `${regionText} ìŠ¤í¬ì¸ ë°•ìŠ¤`;
                        regionFilterContainer.classList.add('hidden');
                        adminRegionBadge.textContent = `${regionText} ê´€ë¦¬ì`;
                        adminRegionBadge.className = `px-3 py-1 rounded-full text-sm font-medium ${region === 'south' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'
                            }`;

                        // ì§€ì—­ ê´€ë¦¬ììš© ì„¤ì • ë¡œë“œ
                        const settings = await loadAdminBookingSettings();
                        updateBookingStatusUI(settings?.is_active || false);
                    }

                    // ê³µí†µ ì´ˆê¸°í™” ì‘ì—…
                    await Promise.all([
                        loadRegionStatistics(),
                        initializeAdminCalendar(),
                        debouncedUpdateCalendarStatus(),
                        loadPendingUsers(),
                        loadPendingBookings()
                    ]);

                } catch (error) {
                    console.error('Admin dashboard initialization error:', error);
                    if (error.message.includes('ì¸ì¦')) {
                        logout();
                        showAlert('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'error');
                    } else {
                        showAlert('ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                }
            }

            // í†µê³„ ì„¹ì…˜ HTMLì„ ë™ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ ì¶”ê°€
            function updateStatisticsUI(region) {
                const statsContainer = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-2.gap-8.mb-8');
                if (!statsContainer) return;

                // ì „ì²´ ê´€ë¦¬ìì¸ ê²½ìš° ë‘ ì§€ì—­ ëª¨ë‘ í‘œì‹œ
                if (region === 'all') {
                    statsContainer.innerHTML = `
            <!-- ë‚¨ë¶€ í†µê³„ -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">ë‚¨ë¶€ ì§€ì—­ í˜„í™©</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-blue-50 rounded-lg p-4">
                        <p class="text-sm text-gray-600">ê¸ˆì¼ ì˜ˆì•½</p>
                        <p id="southTodayBookings" class="text-2xl font-bold text-blue-600">0ê±´</p>
                    </div>
                    <div class="bg-green-50 rounded-lg p-4">
                        <p class="text-sm text-gray-600">ì´ë²ˆ ë‹¬ ì´ ì˜ˆì•½</p>
                        <p id="southMonthBookings" class="text-2xl font-bold text-green-600">0ê±´</p>
                    </div>
                </div>
            </div>
            <!-- ë¶ë¶€ í†µê³„ -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">ë¶ë¶€ ì§€ì—­ í˜„í™©</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-blue-50 rounded-lg p-4">
                        <p class="text-sm text-gray-600">ê¸ˆì¼ ì˜ˆì•½</p>
                        <p id="northTodayBookings" class="text-2xl font-bold text-blue-600">0ê±´</p>
                    </div>
                    <div class="bg-green-50 rounded-lg p-4">
                        <p class="text-sm text-gray-600">ì´ë²ˆ ë‹¬ ì´ ì˜ˆì•½</p>
                        <p id="northMonthBookings" class="text-2xl font-bold text-green-600">0ê±´</p>
                    </div>
                </div>
            </div>
        `;
                } else {
                    // ì§€ì—­ ê´€ë¦¬ìì¸ ê²½ìš° í•´ë‹¹ ì§€ì—­ë§Œ í‘œì‹œ
                    const regionText = region === 'south' ? 'ë‚¨ë¶€' : 'ë¶ë¶€';
                    const idPrefix = region === 'south' ? 'south' : 'north';

                    statsContainer.innerHTML = `
            <div class="bg-white rounded-xl shadow-lg p-6 col-span-2">
                <h3 class="text-xl font-bold text-gray-800 mb-4">${regionText} ì§€ì—­ í˜„í™©</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-blue-50 rounded-lg p-4">
                        <p class="text-sm text-gray-600">ê¸ˆì¼ ì˜ˆì•½</p>
                        <p id="${idPrefix}TodayBookings" class="text-2xl font-bold text-blue-600">0ê±´</p>
                    </div>
                    <div class="bg-green-50 rounded-lg p-4">
                        <p class="text-sm text-gray-600">ì´ë²ˆ ë‹¬ ì´ ì˜ˆì•½</p>
                        <p id="${idPrefix}MonthBookings" class="text-2xl font-bold text-green-600">0ê±´</p>
                    </div>
                </div>
            </div>
        `;
                }
            }

            // í†µê³„ ë¡œë“œ í•¨ìˆ˜
            async function loadRegionStatistics() {
                try {
                    // ê´€ë¦¬ì ì§€ì—­ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                    const adminRegion = sessionStorage.getItem('region');
                    updateStatisticsUI(adminRegion);

                    // í˜„ì¬ ë‚ ì§œì™€ ì›” ê³„ì‚°
                    const today = new Date().toISOString().split('T')[0];
                    const firstDayOfMonth = new Date(new Date().getFullYear(), new Date().getMonth(), 1)
                        .toISOString().split('T')[0];
                    const lastDayOfMonth = new Date(new Date().getFullYear(), new Date().getMonth() + 1, 0)
                        .toISOString().split('T')[0];

                    // í†µí•© ê´€ë¦¬ìì¸ ê²½ìš° ì§€ì—­ í•„í„° ê°’ ê°€ì ¸ì˜¤ê¸°
                    let targetRegion = adminRegion;
                    if (adminRegion === 'all') {
                        const regionFilter = document.getElementById('regionFilter');
                        if (regionFilter) {
                            targetRegion = regionFilter.value;
                        }
                    }

                    console.log('í†µê³„ ë°ì´í„° ìš”ì²­:', { targetRegion, today, firstDayOfMonth, lastDayOfMonth });

                    // ì§€ì—­ì´ 'all'ì´ ì•„ë‹Œì§€ í™•ì¸ (ë°±ì—”ë“œì—ì„œëŠ” 'south' ë˜ëŠ” 'north'ë§Œ í—ˆìš©)
                    if (targetRegion === 'all') {
                        console.log('ì§€ì—­ì´ "all"ì¸ ê²½ìš° ê¸°ë³¸ê°’ìœ¼ë¡œ "south" ì‚¬ìš©');
                        targetRegion = 'south'; // ê¸°ë³¸ê°’ ì„¤ì •
                    }

                    const response = await apiRequest('/api/admin/statistics', {
                        method: 'POST',
                        body: JSON.stringify({
                            region: targetRegion,
                            today: today,
                            startDate: firstDayOfMonth,
                            endDate: lastDayOfMonth
                        })
                    });

                    console.log('í†µê³„ ì‘ë‹µ:', response);

                    if (response.success) {
                        // ë‚¨ë¶€ ë˜ëŠ” ë¶ë¶€ì— í†µê³„ ë°ì´í„° í‘œì‹œ
                        if (targetRegion === 'south') {
                            document.getElementById('southTodayBookings').textContent =
                                `${response.todayBookings}ê±´`;
                            document.getElementById('southMonthBookings').textContent =
                                `${response.monthBookings}ê±´`;
                        } else if (targetRegion === 'north') {
                            document.getElementById('northTodayBookings').textContent =
                                `${response.todayBookings}ê±´`;
                            document.getElementById('northMonthBookings').textContent =
                                `${response.monthBookings}ê±´`;
                        }
                    }
                } catch (error) {
                    console.error('í†µê³„ ë¡œë”© ì˜¤ë¥˜:', error);
                    showAlert('í†µê³„ ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ìƒˆë¡œê³ ì¹¨
            async function refreshAdminDashboard() {
                try {
                    showLoading();
                    await Promise.all([
                        loadPendingUsers(),
                        loadPendingBookings(),
                        debouncedUpdateCalendarStatus(),
                        loadRegionStatistics()
                    ]);
                } catch (error) {
                    console.error('Dashboard refresh error:', error);
                    showAlert('ëŒ€ì‹œë³´ë“œ ìƒˆë¡œê³ ì¹¨ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            function logout() {
                console.log('ë¡œê·¸ì•„ì›ƒ ì‹œì‘');

                // ë¬¸ì˜ì‚¬í•­ ê´€ë¦¬ ì„¹ì…˜ ìˆ¨ê¸°ê¸° (ì´ ì¤„ ì¶”ê°€)
                const inquiryManagementSection = document.getElementById('inquiryManagementSection');
                if (inquiryManagementSection) inquiryManagementSection.style.display = 'none';

                // sessionStorage í´ë¦¬ì–´
                sessionStorage.clear();

                // ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
                document.getElementById('mainContainer').querySelector('#homeScreen').classList.add('hidden');
                document.getElementById('loginAndReservationSystem').classList.remove('hidden');
                document.getElementById('loginScreen').classList.remove('hidden');

                // ëŒ€ì‹œë³´ë“œ ìˆ¨ê¸°ê¸°
                document.getElementById('userDashboard').classList.add('hidden');
                document.getElementById('adminDashboard').classList.add('hidden');

                // í¼ ì´ˆê¸°í™”
                document.getElementById('loginForm').reset();

                // ê´€ë¦¬ì ìƒíƒœ í™•ì¸ (ê³µì§€ì‚¬í•­ ê¸€ì“°ê¸° ë²„íŠ¼ ìˆ¨ê¹€)
                checkAdminStatus();

                showAlert('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.', 'info', 3000);

                console.log('ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ');
            }

            // ì¼ë°˜ ì‚¬ìš©ììš© UI ì—…ë°ì´íŠ¸
            function updateUserDashboardState(isActive) {
                const calendar = document.getElementById('calendar');
                const bookingForm = document.getElementById('bookingForm');
                const bookingFormSection = bookingForm.closest('.bg-white.rounded-2xl.shadow-xl.p-8');

                if (!isActive) {
                    // ë‹¬ë ¥ ë¹„í™œì„±í™”
                    const calendarDays = calendar.querySelectorAll('.calendar-day:not(.past)');
                    calendarDays.forEach(day => {
                        day.style.pointerEvents = 'none';
                        day.style.opacity = '0.7';
                        day.classList.remove('cursor-pointer');
                        day.classList.add('cursor-not-allowed');
                    });

                    // ì˜ˆì•½ í¼ ë¹„í™œì„±í™”
                    bookingForm.style.opacity = '0.5';
                    bookingForm.style.pointerEvents = 'none';

                    // ì˜ˆì•½ ì¤‘ì§€ ë©”ì‹œì§€ í‘œì‹œ
                    let message = bookingFormSection.querySelector('.booking-disabled-message');
                    if (!message) {
                        message = document.createElement('div');
                        message.className = 'booking-disabled-message bg-red-100 text-red-700 p-4 rounded-lg mb-4';
                        message.textContent = 'í˜„ì¬ ì˜ˆì•½ì´ ì¤‘ì§€ëœ ìƒíƒœì…ë‹ˆë‹¤.';
                        bookingFormSection.insertBefore(message, bookingForm);
                    }
                } else {
                    // ë‹¬ë ¥ í™œì„±í™”
                    const calendarDays = calendar.querySelectorAll('.calendar-day:not(.past)');
                    calendarDays.forEach(day => {
                        day.style.pointerEvents = 'auto';
                        day.style.opacity = '1';
                        day.classList.remove('cursor-not-allowed');
                        if (!day.classList.contains('blocked') && !day.classList.contains('full')) {
                            day.classList.add('cursor-pointer');
                        }
                    });

                    // ì˜ˆì•½ í¼ í™œì„±í™”
                    bookingForm.style.opacity = '1';
                    bookingForm.style.pointerEvents = 'auto';

                    // ì˜ˆì•½ ì¤‘ì§€ ë©”ì‹œì§€ ì œê±°
                    const message = bookingFormSection.querySelector('.booking-disabled-message');
                    if (message) {
                        message.remove();
                    }
                }
            }

            async function validateStoredToken() {
                const token = sessionStorage.getItem('token');
                if (!token) return false;

                try {
                    const response = await apiRequest('/api/validate-token');
                    return response.success;
                } catch (error) {
                    console.error('Token validation error:', error);
                    logout();
                    return false;
                }
            }

            async function signup(formData) {
                try {
                    // API ìš”ì²­ ì „ ë¡œê·¸ ì¶”ê°€ (ìƒˆë¡œ ì¶”ê°€)
                    console.log('íšŒì›ê°€ì… ìš”ì²­ ë°ì´í„°:', {
                        ...formData,
                        password: '****'  // ë¹„ë°€ë²ˆí˜¸ëŠ” ë¡œê·¸ì— í‘œì‹œí•˜ì§€ ì•ŠìŒ
                    });

                    // ê¸°ì¡´ ê²€ì¦ ë¡œì§ ìœ ì§€
                    if (!formData.groupName || !formData.password || !formData.manager ||
                        !formData.contact || !formData.city) {
                        throw new Error('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    }

                    // ê¸°ì¡´ determineRegion í•¨ìˆ˜ ì‚¬ìš©
                    const region = determineRegion(formData.city);
                    if (!region) {
                        throw new Error('ì˜¬ë°”ë¥¸ ì‹œ/êµ°ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    }

                    // API ìš”ì²­ ë°ì´í„° êµ¬ì„± (ê¸°ì¡´ ìœ ì§€)
                    const signupData = {
                        group_name: formData.groupName,
                        password: formData.password,
                        manager: formData.manager,
                        contact: formData.contact,
                        city: formData.city,
                        region: region
                    };

                    const response = await apiRequest('/api/signup', {
                        method: 'POST',
                        body: JSON.stringify(signupData)
                    });

                    // ì‘ë‹µ ë¡œê·¸ ì¶”ê°€ (ìƒˆë¡œ ì¶”ê°€)
                    console.log('íšŒì›ê°€ì… ì‘ë‹µ:', response);

                    if (response.success) {
                        showAlert('íšŒì›ê°€ì… ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ì„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.', 'success');
                        document.getElementById('signupModal').classList.remove('show');
                        document.getElementById('signupForm').reset();
                        return response;
                    } else {
                        throw new Error(response.message || 'íšŒì›ê°€ì… ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    // ì—ëŸ¬ ë¡œê¹… ê°œì„  (ë©”ì‹œì§€ ìˆ˜ì •)
                    console.error('íšŒì›ê°€ì… ì˜¤ë¥˜:', error);
                    showAlert(error.message || 'íšŒì›ê°€ì… ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');

                    // ì—ëŸ¬ ë°œìƒ ì‹œ ëª¨ë‹¬ í‘œì‹œ ìœ ì§€ (ìƒˆë¡œ ì¶”ê°€)
                    const modal = document.getElementById('signupModal');
                    if (modal) modal.classList.add('show');

                    throw error;
                }
            }

            // ì˜ˆì•½ ìƒì„± í•¨ìˆ˜
            // ë¶€ë“œëŸ¬ìš´ ë‹¬ë ¥ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜ (ìƒˆë¡œ ì¶”ê°€)
            async function refreshCalendarSmoothly() {
                // 1. í˜„ì¬ ë‹¬ë ¥ì— ë¡œë”© ì˜¤ë²„ë ˆì´ í‘œì‹œ
                const calendar = document.getElementById('calendar');
                const overlay = document.createElement('div');
                overlay.className = 'absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center z-10';
                overlay.innerHTML = `
        <div class="animate-pulse text-blue-500">
            <i class="fas fa-sync-alt fa-spin text-xl"></i>
            <p class="mt-2 text-sm font-medium">ìµœì‹  ì˜ˆì•½ ì •ë³´ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</p>
        </div>
    `;

                // ë‹¬ë ¥ì˜ ìƒëŒ€ì  ìœ„ì¹˜ ì„¤ì • (ì˜¤ë²„ë ˆì´ ë°°ì¹˜ë¥¼ ìœ„í•´)
                if (getComputedStyle(calendar).position === 'static') {
                    calendar.style.position = 'relative';
                }

                calendar.appendChild(overlay);

                try {
                    // 2. ê¸°ì¡´ í•¨ìˆ˜ í˜¸ì¶œ (ë°ì´í„° êµ¬ì¡° ìœ ì§€)
                    await updateCalendarStatus(); // ë””ë°”ìš´ìŠ¤ ì—†ì´ ì§ì ‘ í˜¸ì¶œ

                    // 3. ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ì™€ í•¨ê»˜ ì˜¤ë²„ë ˆì´ ì œê±°
                    overlay.style.transition = 'opacity 0.3s ease';
                    overlay.style.opacity = '0';

                    setTimeout(() => {
                        if (calendar.contains(overlay)) {
                            calendar.removeChild(overlay);
                        }
                    }, 300);

                } catch (error) {
                    console.error('ë‹¬ë ¥ ìƒˆë¡œê³ ì¹¨ ì˜¤ë¥˜:', error);
                    // ì˜¤ë¥˜ ë°œìƒí•´ë„ ì˜¤ë²„ë ˆì´ ì œê±°
                    if (calendar.contains(overlay)) {
                        calendar.removeChild(overlay);
                    }
                }
            }

            // ìˆ˜ì •ëœ ì˜ˆì•½ ìƒì„± í•¨ìˆ˜
            async function createBooking(bookingData) {
                try {
                    // ë‚ ì§œ ìƒíƒœ í™•ì¸ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
                    const dateStatus = bookingStatus[bookingData.date];
                    if (dateStatus?.isFullyBlocked) {
                        showAlert('í•´ë‹¹ ë‚ ì§œëŠ” ì „ì²´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                        return;
                    }
                    if (dateStatus?.isPartiallyBlocked && dateStatus.bookingCount >= 1) {
                        showAlert('í•´ë‹¹ ë‚ ì§œëŠ” ë¶€ë¶„ ë§ˆê°ë˜ì–´ ë” ì´ìƒ ì˜ˆì•½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error', 3000);
                        return;
                    }

                    const response = await apiRequest('/api/bookings', {
                        method: 'POST',
                        body: JSON.stringify(bookingData)
                    });

                    if (response.success) {
                        showAlert('ì˜ˆì•½ì´ ì‹ ì²­ë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ì„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.', 'success', 3000);
                        document.getElementById('bookingForm').reset();

                        // ì˜ˆì•½ ëª©ë¡ ë¡œë“œ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
                        await loadBookings();

                        // ë¶€ë“œëŸ¬ìš´ ì‹œê°ì  íš¨ê³¼ì™€ í•¨ê»˜ ë‹¬ë ¥ ì—…ë°ì´íŠ¸ (ë³€ê²½ëœ ë¶€ë¶„)
                        refreshCalendarSmoothly();
                    }
                } catch (error) {
                    console.error('Booking creation error:', error);

                    // ë§ˆê° ê´€ë ¨ ì—ëŸ¬ì¸ ê²½ìš° ë‹¬ë ¥ë„ ê°±ì‹  (ì¶”ê°€ëœ ë¶€ë¶„)
                    if (error.message && error.message.includes('ë§ˆê°')) {
                        showAlert(error.message, 'error', 3000);
                        // ë¶€ë“œëŸ¬ìš´ ì‹œê°ì  íš¨ê³¼ì™€ í•¨ê»˜ ë‹¬ë ¥ ì—…ë°ì´íŠ¸
                        refreshCalendarSmoothly();
                    } else {
                        // ê¸°ì¡´ ì½”ë“œ ìœ ì§€
                        showAlert(error.message || 'ì˜ˆì•½ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                    }
                }
            }

            // ì˜ˆì•½ ëª©ë¡ ë¡œë“œ í•¨ìˆ˜
            async function loadBookings() {
                try {
                    const data = await apiRequest('/api/bookings');
                    const tbody = document.getElementById('bookingsList');

                    if (data.success && data.data) {
                        tbody.innerHTML = data.data
                            .filter(booking => booking.status !== 'cancelled')
                            .map(booking => {
                                const bookingDate = new Date(booking.date);
                                const today = new Date();
                                today.setHours(0, 0, 0, 0);

                                const canCancel = bookingDate >= today &&
                                    booking.status !== 'cancelled' &&
                                    booking.status !== 'rejected';

                                return `
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">${formatDate(booking.date)}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${booking.start_time} - ${booking.end_time}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${booking.place}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${booking.people}ëª…</td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                    ${getStatusClass(booking.status)}">
                                    ${getStatusText(booking.status)}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                ${canCancel ? `
                                    <button onclick="cancelBooking(${booking.id})" 
                                        class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm">
                                        ì·¨ì†Œ
                                    </button>
                                ` : ''}
                            </td>
                        </tr>
                    `;
                            }).join('') || '<tr><td colspan="6" class="px-6 py-4 text-center">ì˜ˆì•½ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    }
                } catch (error) {
                    console.error('Error loading bookings:', error);
                    showAlert('ì˜ˆì•½ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                }
            }

            // ê³µì§€ì‚¬í•­ ì‘ì„±
            async function createNotice(noticeData) {
                try {
                    showLoading();
                    // ì§„í–‰ í‘œì‹œê¸° ì¶”ê°€
                    const loadingEl = document.getElementById('loading');
                    const spinner = loadingEl.querySelector('.spinner');
                    if (spinner) {
                        // ì§„í–‰ í…ìŠ¤íŠ¸ ì¶”ê°€
                        const progressText = document.createElement('div');
                        progressText.className = 'text-white mt-3 font-medium';
                        progressText.textContent = 'íŒŒì¼ ì—…ë¡œë“œ ì¤‘...';
                        loadingEl.appendChild(progressText);
                    }

                    const formData = new FormData();
                    formData.append('title', noticeData.title);
                    formData.append('content', noticeData.content);
                    formData.append('region', noticeData.region);
                    formData.append('is_important', noticeData.is_important ? '1' : '0');

                    // ì²¨ë¶€íŒŒì¼ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ ì¶”ê°€
                    if (noticeData.attachment) {
                        const fileSize = (noticeData.attachment.size / 1024 / 1024).toFixed(2); // MB
                        console.log(`ì²¨ë¶€íŒŒì¼ ì—…ë¡œë“œ ì‹œì‘: ${noticeData.attachment.name} (${fileSize}MB)`);
                        formData.append('attachment', noticeData.attachment);
                    }

                    const response = await apiRequest('/api/admin/notices', {
                        method: 'POST',
                        body: formData,
                    });

                    console.log('ê³µì§€ì‚¬í•­ ìƒì„± ì‘ë‹µ:', response.data);

                    if (response.success) {
                        showAlert('ê³µì§€ì‚¬í•­ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                        document.getElementById('noticeWriteForm').reset();
                        await loadHomeNotices();
                        if (document.getElementById('noticesListSection')) {
                            await loadUserNotices();
                        }
                        return response;
                    } else {
                        throw new Error(response.message || 'ê³µì§€ì‚¬í•­ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('ê³µì§€ì‚¬í•­ ìƒì„± ì˜¤ë¥˜:', error);
                    showAlert(error.message || 'ê³µì§€ì‚¬í•­ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    throw error;
                } finally {
                    // ì§„í–‰ í‘œì‹œê¸° ì œê±°
                    const loadingEl = document.getElementById('loading');
                    const progressText = loadingEl.querySelector('.text-white.mt-3');
                    if (progressText) {
                        loadingEl.removeChild(progressText);
                    }
                    hideLoading();
                }
            }

            // ê³µì§€ì‚¬í•­ ëª©ë¡ ë¡œë“œ
            async function loadNotices() {
                try {
                    const response = await apiRequest('/api/notices');
                    if (response.success && response.data) {
                        renderNoticesList(response.data, 'noticesList');
                    }
                } catch (error) {
                    console.error('Notices loading error:', error);
                    showAlert('ê³µì§€ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            async function loadAdminBookings() {
                try {
                    const region = localStorage.getItem('region');
                    let endpoint = '/api/admin/bookings/';

                    if (region === 'all') {
                        endpoint += 'all';
                    } else {
                        endpoint += region;
                    }

                    const response = await apiRequest(endpoint);
                    if (response.success) {
                        const tbody = document.getElementById('adminBookingsList');

                        if (tbody) {
                            tbody.innerHTML = response.data
                                .map(booking => `
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">
                                ${booking.group_name}
                                <span class="ml-2 px-2 py-1 text-xs rounded-full 
                                    ${booking.region === 'south' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'}">
                                    ${booking.region === 'south' ? 'ë‚¨ë¶€' : 'ë¶ë¶€'}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">${booking.city}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${formatDate(booking.date)}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${booking.start_time} - ${booking.end_time}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${booking.place}</td>
                            <td class="px-6 py-4 whitespace-nowrap">${booking.people}ëª…</td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                    ${getStatusClass(booking.status)}">
                                    ${getStatusText(booking.status)}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                ${booking.status === 'pending' ? `
                                    <button onclick="approveBooking(${booking.id})" 
                                        class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 text-sm mr-2">
                                        ìŠ¹ì¸
                                    </button>
                                    <button onclick="rejectBooking(${booking.id})"
                                        class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm">
                                        ê±°ë¶€
                                    </button>
                                ` : booking.status === 'approved' ? `
                                    <button onclick="forceCancel(${booking.id})"
                                        class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm">
                                        ê°•ì œì·¨ì†Œ
                                    </button>
                                ` : ''}
                            </td>
                        </tr>
                    `).join('') || '<tr><td colspan="8" class="px-6 py-4 text-center">ì˜ˆì•½ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                        }
                    }
                } catch (error) {
                    console.error('Error loading admin bookings:', error);
                    showAlert(error.message || 'ì˜ˆì•½ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                }
            }

            // ë‚ ì§œ í¬ë§· í•¨ìˆ˜
            function formatDate(dateStr) {
                const date = new Date(dateStr);
                return `${date.getFullYear()}ë…„ ${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`;
            }

            // ì˜ˆì•½ ì·¨ì†Œ í•¨ìˆ˜
            async function cancelBooking(bookingId) {
                try {
                    if (!confirm('ì˜ˆì•½ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        return;
                    }

                    showLoading();

                    // ì˜ˆì•½ ìƒíƒœ í™•ì¸
                    const bookingResponse = await apiRequest(`/api/bookings/${bookingId}`);
                    if (!bookingResponse.success) {
                        throw new Error(bookingResponse.message);
                    }

                    const booking = bookingResponse.data;
                    let cancelResponse;

                    if (booking.status === 'pending') {
                        // ìŠ¹ì¸ëŒ€ê¸° ìƒíƒœì¼ ê²½ìš° ì¦‰ì‹œ ì·¨ì†Œ
                        cancelResponse = await apiRequest(`/api/bookings/${bookingId}/cancel-pending`, {
                            method: 'PUT'
                        });
                    } else if (booking.status === 'approved') {
                        // ìŠ¹ì¸ì™„ë£Œ ìƒíƒœì¼ ê²½ìš° ì·¨ì†Œ ìš”ì²­
                        cancelResponse = await apiRequest(`/api/bookings/${bookingId}/cancel`, {
                            method: 'PUT'
                        });
                    } else {
                        throw new Error('ì·¨ì†Œí•  ìˆ˜ ì—†ëŠ” ì˜ˆì•½ ìƒíƒœì…ë‹ˆë‹¤.');
                    }

                    if (cancelResponse.success) {
                        showAlert(
                            booking.status === 'pending' ?
                                'ì˜ˆì•½ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.' :
                                'ì˜ˆì•½ ì·¨ì†Œê°€ ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ì„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.',
                            'success'
                        );
                        await loadBookings();

                        // ë””ë°”ìš´ìŠ¤ ëŒ€ì‹  ë¶€ë“œëŸ¬ìš´ ë‹¬ë ¥ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ ì‚¬ìš©
                        if (booking.status === 'pending') {
                            // ì¦‰ì‹œ ì·¨ì†Œëœ ê²½ìš°ì—ë§Œ ë‹¬ë ¥ ì—…ë°ì´íŠ¸ (ìŠ¹ì¸ ëŒ€ê¸° ì·¨ì†ŒëŠ” ì¦‰ì‹œ ë‹¬ë ¥ì— ë°˜ì˜ë¨)
                            refreshCalendarSmoothly();
                        } else {
                            // ì·¨ì†Œ ìš”ì²­ ìƒíƒœëŠ” ë‹¬ë ¥ì— ë³€í™”ê°€ ì—†ìœ¼ë¯€ë¡œ ì¼ë°˜ ì—…ë°ì´íŠ¸ ì‚¬ìš©
                            debouncedUpdateCalendarStatus();
                        }
                    }
                } catch (error) {
                    console.error('Booking cancellation error:', error);
                    showAlert(error.message || 'ì˜ˆì•½ ì·¨ì†Œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            // ìƒíƒœ ê´€ë ¨ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
            function getStatusClass(status) {
                const statusClasses = {
                    approved: 'bg-green-100 text-green-800',
                    pending: 'bg-yellow-100 text-yellow-800',
                    rejected: 'bg-red-100 text-red-800',
                    cancelled: 'bg-gray-100 text-gray-800',
                    cancel_pending: 'bg-orange-100 text-orange-800'
                };
                return statusClasses[status] || 'bg-gray-100 text-gray-800';
            }

            function getStatusText(status) {
                const statusTexts = {
                    approved: 'ìŠ¹ì¸ì™„ë£Œ',
                    pending: 'ìŠ¹ì¸ëŒ€ê¸°',
                    rejected: 'ê±°ë¶€ë¨',
                    cancelled: 'ì·¨ì†Œì™„ë£Œ',
                    cancel_pending: 'ì·¨ì†ŒëŒ€ê¸°'
                };
                return statusTexts[status] || 'ì•Œ ìˆ˜ ì—†ìŒ';
            }

            // ìŠ¹ì¸ ëŒ€ê¸° íšŒì› ëª©ë¡ ë¡œë“œ
            async function loadPendingUsers() {
                try {
                    const data = await apiRequest('/api/admin/pending-users');
                    const tbody = document.getElementById('pendingUsersList');

                    if (data.success && data.data) {
                        tbody.innerHTML = data.data.map(user => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap">${user.group_name}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${user.manager}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${user.contact}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex space-x-2">
                            <button onclick="approveUser(${user.id})" 
                                class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 text-sm">
                                ìŠ¹ì¸
                            </button>
                            <button onclick="rejectUser(${user.id})"
                                class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 text-sm">
                                ê±°ë¶€
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('') || '<tr><td colspan="4" class="px-6 py-4 text-center">ëŒ€ê¸° ì¤‘ì¸ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    }
                } catch (error) {
                    console.error('Error loading pending users:', error);
                    showAlert('ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            // ì „ì²´ íšŒì› ëª©ë¡ ë¡œë“œ
            async function loadAllUsers() {
                try {
                    const data = await apiRequest('/api/admin/users');

                    if (data.success) {
                        // ì „ì—­ ë³€ìˆ˜ì— ë°ì´í„° ì €ì¥
                        allUsersData = data.data || [];

                        // ì‚¬ìš©ì ëª©ë¡ ë Œë”ë§ í•¨ìˆ˜ í˜¸ì¶œ
                        renderUsersList(allUsersData);
                    } else {
                        showAlert('íšŒì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                        // ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¹ˆ í…Œì´ë¸” í‘œì‹œ
                        document.getElementById('allUsersList').innerHTML = `
                <tr>
                    <td colspan="7" class="px-6 py-10 text-center text-gray-500">
                        íšŒì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
                    </td>
                </tr>
            `;
                    }
                } catch (error) {
                    console.error('Users fetch error:', error);
                    // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
                    document.getElementById('allUsersList').innerHTML = `
            <tr>
                <td colspan="7" class="px-6 py-10 text-center text-gray-500">
                    íšŒì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
                </td>
            </tr>
        `;

                    // ì˜¤ë¥˜ ê²½ê³ ì°½ í‘œì‹œ
                    showAlert('íšŒì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            // ì¶”ê°€: ì‚¬ìš©ì ëª©ë¡ ë Œë”ë§ í•¨ìˆ˜
            function renderUsersList(users) {
                const tbody = document.getElementById('allUsersList');
                if (!tbody) return;

                if (!users || users.length === 0) {
                    tbody.innerHTML = `
            <tr>
                <td colspan="8" class="px-6 py-10 text-center text-gray-500">
                    ë“±ë¡ëœ íšŒì›ì´ ì—†ìŠµë‹ˆë‹¤.
                </td>
            </tr>
        `;
                    return;
                }

                // ìƒë‹¨ì— ì „ì²´ íšŒì› ìˆ˜ í‘œì‹œ ì¶”ê°€
                const userManagementSection = document.querySelector('#adminDashboard .mt-8.bg-white.rounded-2xl.shadow-xl.p-8:last-child');
                const sectionTitle = userManagementSection?.querySelector('h2');
                if (sectionTitle) {
                    sectionTitle.innerHTML = `
        <i class="fas fa-users text-indigo-600 mr-2"></i>
        ì „ì²´ íšŒì› ê´€ë¦¬ <span class="text-sm font-normal text-gray-500 ml-2">(ì´ ${users.length}ê°œ ë‹¨ì²´)</span>
    `;
                }

                try {
                    tbody.innerHTML = users.map((user, index) => `
            <tr>
                <td class="px-6 py-4 whitespace-nowrap text-center">${index + 1}</td>
                <td class="px-6 py-4 whitespace-nowrap">${user.group_name}</td>
                <td class="px-6 py-4 whitespace-nowrap">${user.manager}</td>
                <td class="px-6 py-4 whitespace-nowrap">${user.contact}</td>
                <td class="px-6 py-4 whitespace-nowrap">${user.city || '-'}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs rounded-full 
                        ${user.region === 'south' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800'}">
                        ${user.region === 'south' ? 'ë‚¨ë¶€' : 'ë¶ë¶€'}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 py-1 text-xs rounded-full 
                        ${user.status === 'pending' ? 'bg-yellow-100 text-yellow-800' :
                            user.status === 'approved' ? 'bg-green-100 text-green-800' :
                                'bg-red-100 text-red-800'}">
                        ${user.status === 'pending' ? 'ëŒ€ê¸°ì¤‘' :
                            user.status === 'approved' ? 'ìŠ¹ì¸ë¨' :
                                'ê±°ë¶€ë¨'
                        }
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    ${user.status === 'approved' ? `
                        <button onclick="resetUserPassword(${user.id}, '${user.group_name}')"
                            class="bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 text-sm">
                            ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™”
                        </button>
                    ` : ''}
                    <button onclick="showDeleteUserModal(${user.id}, '${user.group_name}')"
                        class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 text-sm">
                        ì‚­ì œ
                    </button>
                </td>
            </tr>
        `).join('');
                } catch (error) {
                    console.error('ì‚¬ìš©ì ëª©ë¡ ë Œë”ë§ ì˜¤ë¥˜:', error);
                    tbody.innerHTML = '<tr><td colspan="7" class="text-center py-4 text-red-500">ì‚¬ìš©ì ëª©ë¡ì„ í‘œì‹œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</td></tr>';
                }
            }

            // ì¶”ê°€: ì‚¬ìš©ì ê²€ìƒ‰ ê¸°ëŠ¥ì„ ìœ„í•œ ì´ˆê¸°í™” í•¨ìˆ˜
            function initializeUserSearch() {
                const searchInput = document.getElementById('userSearchInput');
                const clearButton = document.getElementById('clearUserSearch');

                if (!searchInput || !clearButton) {
                    console.log('ì‚¬ìš©ì ê²€ìƒ‰ UI ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }

                // ê²€ìƒ‰ ì…ë ¥ ì´ë²¤íŠ¸
                searchInput.addEventListener('input', function () {
                    const searchTerm = this.value.toLowerCase().trim();
                    filterUsersList(searchTerm);
                });

                // ê²€ìƒ‰ ì§€ìš°ê¸° ë²„íŠ¼
                clearButton.addEventListener('click', function () {
                    searchInput.value = '';
                    filterUsersList('');
                });

                console.log('ì‚¬ìš©ì ê²€ìƒ‰ ê¸°ëŠ¥ ì´ˆê¸°í™” ì™„ë£Œ');
            }

            // ì¶”ê°€: ì‚¬ìš©ì ëª©ë¡ í•„í„°ë§ í•¨ìˆ˜
            function filterUsersList(searchTerm) {
                if (!allUsersData || allUsersData.length === 0) return;

                if (!searchTerm) {
                    // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ì „ì²´ ëª©ë¡ í‘œì‹œ
                    renderUsersList(allUsersData);
                    return;
                }

                // ê²€ìƒ‰ì–´ë¡œ í•„í„°ë§
                const filteredUsers = allUsersData.filter(user =>
                    (user.group_name && user.group_name.toLowerCase().includes(searchTerm)) ||
                    (user.manager && user.manager.toLowerCase().includes(searchTerm)) ||
                    (user.contact && user.contact.includes(searchTerm)) ||
                    (user.city && user.city.toLowerCase().includes(searchTerm))
                );

                // í•„í„°ë§ëœ ëª©ë¡ ë Œë”ë§
                renderUsersList(filteredUsers);
            }

            // ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” í•¨ìˆ˜ ì¶”ê°€
            async function resetUserPassword(userId, groupName) {
                try {
                    if (!confirm(`${groupName} ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ˆê¸°í™” í›„ ë¹„ë°€ë²ˆí˜¸ëŠ” 'sportsbox00' ì…ë‹ˆë‹¤.`)) {
                        return;
                    }

                    showLoading();

                    const response = await apiRequest(`/api/admin/users/${userId}/reset-password`, {
                        method: 'PUT'
                    });

                    if (response.success) {
                        showAlert(`${groupName} ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                    }
                } catch (error) {
                    console.error('Password reset error:', error);
                    showAlert(error.message || 'ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            async function approveUser(userId) {
                try {
                    showLoading();  // ë¡œë”© í‘œì‹œ ì¶”ê°€
                    const response = await apiRequest(`/api/admin/users/${userId}/approve`, {
                        method: 'PUT'
                    });

                    if (response.success) {
                        showAlert('ì‚¬ìš©ìê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success', 3000);
                        await loadPendingUsers();  // await ì¶”ê°€í•˜ì—¬ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ë³´ì¥
                    }
                } catch (error) {
                    console.error('User approval error:', error);
                    showAlert(error.message || 'ì‚¬ìš©ì ìŠ¹ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                } finally {
                    hideLoading();  // ë¡œë”© í‘œì‹œ ì œê±° ë³´ì¥
                }
            }

            async function rejectUser(userId) {
                try {
                    // í™•ì¸ ëŒ€í™”ìƒì ì¶”ê°€
                    if (!confirm('ì •ë§ ì´ ì‚¬ìš©ìì˜ ê°€ì…ì„ ê±°ë¶€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        return;
                    }

                    showLoading();  // ë¡œë”© í‘œì‹œ ì¶”ê°€
                    const response = await apiRequest(`/api/admin/users/${userId}/reject`, {
                        method: 'PUT'
                    });

                    if (response.success) {
                        showAlert('ì‚¬ìš©ìê°€ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success', 3000);
                        await loadPendingUsers();  // await ì¶”ê°€í•˜ì—¬ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ë³´ì¥
                    }
                } catch (error) {
                    console.error('User rejection error:', error);
                    showAlert(error.message || 'ì‚¬ìš©ì ê±°ë¶€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                } finally {
                    hideLoading();  // ë¡œë”© í‘œì‹œ ì œê±° ë³´ì¥
                }
            }

            // ì‚¬ìš©ì ì‚­ì œ í™•ì¸ í•¨ìˆ˜
            function confirmDeleteUser(userId, groupName) {
                if (confirm(`ì •ë§ '${groupName}' ê³„ì •ì„ ì™„ì „íˆ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë©° í•´ë‹¹ ì‚¬ìš©ìì˜ ëª¨ë“  ì˜ˆì•½ ë° ë¬¸ì˜ ë‚´ì—­ì´ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.`)) {
                    forceDeleteUser(userId, groupName);
                }
            }

            // ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” í•¨ìˆ˜ ì¶”ê°€
            async function resetUserPassword(userId, groupName) {
                try {
                    if (!confirm(`${groupName} ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ˆê¸°í™” í›„ ë¹„ë°€ë²ˆí˜¸ëŠ” 'sportsbox00' ì…ë‹ˆë‹¤.`)) {
                        return;
                    }

                    showLoading();

                    const response = await apiRequest(`/api/admin/users/${userId}/reset-password`, {
                        method: 'PUT'
                    });

                    if (response.success) {
                        showAlert(`${groupName} ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                    }
                } catch (error) {
                    console.error('Password reset error:', error);
                    showAlert(error.message || 'ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            let deleteUserId = null;
            let deleteUserGroupName = null;

            function showDeleteUserModal(userId, groupName) {
                deleteUserId = userId;
                deleteUserGroupName = groupName;

                document.getElementById('deleteUserName').textContent = groupName;
                openModal('deleteUserModal');
            }

            // ì‚¬ìš©ì ê°•ì œ ì‚­ì œ í•¨ìˆ˜
            async function forceDeleteUser(userId, groupName) {
                try {
                    showLoading();

                    const response = await apiRequest(`/api/admin/users/${userId}/force-delete`, {
                        method: 'DELETE'
                    });

                    if (response.success) {
                        showAlert(`'${groupName}' ê³„ì •ì´ ì™„ì „íˆ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
                        // ì‚¬ìš©ì ëª©ë¡ ë‹¤ì‹œ ë¡œë“œ
                        await loadAllUsers();
                    } else {
                        throw new Error(response.message || 'ì‚¬ìš©ì ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('User deletion error:', error);
                    showAlert(error.message || 'ì‚¬ìš©ì ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            // ê´€ë¦¬ì: ì˜ˆì•½ ê´€ë¦¬ í•¨ìˆ˜ë“¤
            async function loadPendingBookings() {
                try {
                    // ì „ì²´ ê´€ë¦¬ìì¸ ê²½ìš° ì§€ì—­ í•„í„° ì ìš©
                    const region = sessionStorage.getItem('region');
                    let apiUrl = '/api/admin/pending-bookings';

                    if (region === 'all') {
                        const regionFilter = document.getElementById('regionFilter')?.value;
                        if (regionFilter && regionFilter !== 'all') {
                            apiUrl += `?region=${regionFilter}`;
                        }
                    }

                    const data = await apiRequest(apiUrl);
                    const tbody = document.getElementById('pendingBookingsList');

                    if (data.success && data.data) {
                        tbody.innerHTML = data.data.map(booking => {
                            const statusText = booking.status === 'cancel_pending' ? 'ì·¨ì†Œ ìš”ì²­' : 'ìŠ¹ì¸ ëŒ€ê¸°';
                            const statusClass = booking.status === 'cancel_pending' ?
                                'bg-orange-100 text-orange-800' :
                                'bg-yellow-100 text-yellow-800';

                            const createdAt = new Date(booking.created_at);
                            // UTC ì‹œê°„ì— 9ì‹œê°„(32400000 ë°€ë¦¬ì´ˆ) ì¶”ê°€í•˜ì—¬ í•œêµ­ ì‹œê°„ìœ¼ë¡œ ë³€í™˜
                            const kstCreatedAt = new Date(createdAt.getTime() + 9 * 60 * 60 * 1000);
                            const formattedCreatedAt = `${String(kstCreatedAt.getMonth() + 1).padStart(2, '0')}-${String(kstCreatedAt.getDate()).padStart(2, '0')} ${String(kstCreatedAt.getHours()).padStart(2, '0')}:${String(kstCreatedAt.getMinutes()).padStart(2, '0')}`;

                            const actionButtons = booking.status === 'cancel_pending'
                                ? `
                        <button onclick="approveBookingCancel(${booking.id})"
                            class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 mr-2">
                            ì·¨ì†ŒìŠ¹ì¸
                        </button>
                        <button onclick="rejectBookingCancel(${booking.id})"
                            class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                            ì·¨ì†Œê±°ë¶€
                        </button>
                    `
                                : `
                        <button onclick="approveBooking(${booking.id})"
                            class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 mr-2">
                            ìŠ¹ì¸
                        </button>
                        <button onclick="rejectBooking(${booking.id})"
                            class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                            ê±°ë¶€
                        </button>
                    `;

                            return `
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap">${booking.group_name}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${booking.city}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${formatDate(booking.date)}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${booking.start_time} - ${booking.end_time}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full mb-2 ${statusClass}">
                                ${statusText}
                            </span>
                            <div class="flex flex-col space-y-2">
                                ${actionButtons}
                            </div>
                        </td>
                    </tr>
                `;
                        }).join('') || '<tr><td colspan="5" class="px-6 py-4 text-center">ëŒ€ê¸° ì¤‘ì¸ ì˜ˆì•½ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    } else {
                        tbody.innerHTML = '<tr><td colspan="5" class="px-6 py-4 text-center">ëŒ€ê¸° ì¤‘ì¸ ì˜ˆì•½ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    }
                } catch (error) {
                    console.error('Error loading pending bookings:', error);
                    showAlert('ì˜ˆì•½ ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                }
            }

            async function approveBooking(bookingId) {
                try {
                    showLoading();
                    const response = await apiRequest(`/api/admin/bookings/${bookingId}/approve`, {
                        method: 'PUT'
                    });
                    if (response.success) {
                        showAlert('ì˜ˆì•½ì´ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success', 3000);
                        await Promise.all([
                            loadPendingBookings(),
                            updateCalendarStatus() // ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                        ]);
                    }
                } catch (error) {
                    console.error('Booking approval error:', error);
                    showAlert('ì˜ˆì•½ ìŠ¹ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                } finally {
                    hideLoading();
                }
            }

            async function rejectBooking(bookingId) {
                try {
                    showLoading();
                    const response = await apiRequest(`/api/admin/bookings/${bookingId}/reject`, {
                        method: 'PUT'
                    });
                    if (response.success) {
                        showAlert('ì˜ˆì•½ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success', 3000);
                        await Promise.all([
                            loadPendingBookings(),
                            updateCalendarStatus() // ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                        ]);
                    }
                } catch (error) {
                    console.error('Booking rejection error:', error);
                    showAlert('ì˜ˆì•½ ê±°ë¶€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                } finally {
                    hideLoading();
                }
            }

            // ì˜ˆì•½ ì·¨ì†Œ ê´€ë¦¬ í•¨ìˆ˜ë“¤
            async function approveBookingCancel(bookingId) {
                try {
                    showLoading();
                    const response = await apiRequest(`/api/admin/bookings/${bookingId}/approve-cancel`, {
                        method: 'PUT'
                    });
                    if (response.success) {
                        showAlert('ì˜ˆì•½ ì·¨ì†Œê°€ ìŠ¹ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success', 3000);
                        await Promise.all([
                            loadPendingBookings(),
                            updateCalendarStatus() // ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                        ]);
                    }
                } catch (error) {
                    console.error('Cancel approval error:', error);
                    showAlert('ì˜ˆì•½ ì·¨ì†Œ ìŠ¹ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                } finally {
                    hideLoading();
                }
            }

            // ì˜ˆì•½ ì·¨ì†Œ ê±°ë¶€ í•¨ìˆ˜
            async function rejectBookingCancel(bookingId) {
                try {
                    if (!confirm('ì´ ì˜ˆì•½ì˜ ì·¨ì†Œ ìš”ì²­ì„ ê±°ë¶€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        return;
                    }

                    showLoading();

                    const response = await apiRequest(`/api/admin/bookings/${bookingId}/reject-cancel`, {
                        method: 'PUT'
                    });

                    if (response.success) {
                        showAlert('ì˜ˆì•½ ì·¨ì†Œê°€ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                        await Promise.all([
                            loadPendingBookings(),
                            updateCalendarStatus() // ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                        ]);
                    }
                } catch (error) {
                    console.error('Cancel rejection error:', error);
                    showAlert(error.message || 'ì˜ˆì•½ ì·¨ì†Œ ê±°ë¶€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            async function forceCancel(bookingId, dateString) {
                try {
                    if (!dateString) {
                        showAlert('ë‚ ì§œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
                        return;
                    }

                    if (!confirm('ì´ ì˜ˆì•½ì„ ê°•ì œë¡œ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                        return;
                    }

                    showLoading();

                    // 1. API ìš”ì²­
                    const response = await apiRequest(`/api/admin/bookings/${bookingId}/force-cancel`, {
                        method: 'PUT'
                    });

                    if (response.success) {
                        showAlert('ì˜ˆì•½ì´ ê°•ì œ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');

                        // 2. ëª¨ë‹¬ ë°”ë¡œ ë‹«ê¸° (ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ)
                        closeDateBookingsModal();

                        // 3. ë‹¬ë ¥ ì—…ë°ì´íŠ¸ ì¤‘ì„ì„ ì‹œê°ì ìœ¼ë¡œ í‘œì‹œ
                        const adminCalendar = document.getElementById('adminCalendar');
                        if (adminCalendar) {
                            adminCalendar.classList.add('updating'); // CSS í´ë˜ìŠ¤ë¡œ ì—…ë°ì´íŠ¸ ì¤‘ì„ì„ í‘œì‹œ

                            // í´ë˜ìŠ¤ ì¶”ê°€ë¥¼ ìœ„í•œ CSS ì½”ë“œ (ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì— ì¶”ê°€ í•„ìš”):
                            // .updating { opacity: 0.6; position: relative; }
                            // .updating::after { content: "ì—…ë°ì´íŠ¸ ì¤‘..."; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
                        }

                        // 4. ìº˜ë¦°ë” ìƒíƒœ ì—…ë°ì´íŠ¸
                        await updateCalendarStatus();

                        // 5. ì—…ë°ì´íŠ¸ í‘œì‹œ ì œê±°
                        if (adminCalendar) {
                            adminCalendar.classList.remove('updating');
                        }

                    }
                } catch (error) {
                    console.error('ê°•ì œ ì·¨ì†Œ ì˜¤ë¥˜:', error);
                    showAlert(error.message || 'ì˜ˆì•½ ê°•ì œ ì·¨ì†Œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            // ë‚ ì§œ ë§ˆê° ê´€ë¦¬ í•¨ìˆ˜ë“¤
            // 1. ë‚ ì§œ ë§ˆê° í•¨ìˆ˜ ìˆ˜ì • - ì§ì ‘ API í˜¸ì¶œ í›„ ìº˜ë¦°ë” ê°±ì‹ 
            async function blockDate(date, blockType) {
                try {
                    // ê´€ë¦¬ì ì •ë³´ í™•ì¸
                    const adminRegion = sessionStorage.getItem('region');

                    // ì§€ì—­ ì„ íƒ í™•ì¸ (ëª…ì‹œì ìœ¼ë¡œ DOMì—ì„œ ê°€ì ¸ì˜¤ê¸°)
                    const regionFilter = document.getElementById('regionFilter');
                    let targetRegion = adminRegion;

                    // ì „ì²´ ê´€ë¦¬ìì¸ ê²½ìš° ì„ íƒëœ ì§€ì—­ ì‚¬ìš©
                    if (adminRegion === 'all' && regionFilter) {
                        targetRegion = regionFilter.value;
                    }

                    console.log(`[blockDate] ë‚ ì§œ: ${date}, ìœ í˜•: ${blockType}, ì§€ì—­: ${targetRegion}`);

                    // API ìš”ì²­
                    const response = await apiRequest('/api/admin/dates/block', {
                        method: 'POST',
                        body: JSON.stringify({
                            date: date,
                            region: targetRegion,
                            blockType: blockType
                        })
                    });

                    if (response.success) {
                        showAlert(
                            blockType === 'full' ? 'ë‚ ì§œê°€ ì „ì²´ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ë‚ ì§œê°€ ë¶€ë¶„ ë§ˆê°ë˜ì—ˆìŠµë‹ˆë‹¤.',
                            'success'
                        );

                        // ìº˜ë¦°ë” ìƒíƒœ ì¦‰ì‹œ ìƒˆë¡œê³ ì¹¨ (ì¤‘ìš”!)
                        await refreshCalendarStatus(targetRegion);

                        // ëª¨ë‹¬ ë‹«ê¸°
                        closeDateBookingsModal();
                    }
                } catch (error) {
                    console.error('Date blocking error:', error);
                    showAlert(error.message || 'ë‚ ì§œ ë§ˆê° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            // 2. ìƒˆë¡œìš´ í•¨ìˆ˜: íŠ¹ì • ì§€ì—­ì˜ ìº˜ë¦°ë” ìƒíƒœë¥¼ ì¦‰ì‹œ ìƒˆë¡œê³ ì¹¨
            async function refreshCalendarStatus(region) {
                try {
                    console.log(`[refreshCalendarStatus] ì§€ì—­: ${region} ìƒíƒœ ìƒˆë¡œê³ ì¹¨ ì¤‘`);

                    // ì§€ì—­ ì •ë³´ë¥¼ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ëª…ì‹œì  ì „ë‹¬
                    const url = `/api/bookings/status?region=${region}`;

                    const data = await apiRequest(url);
                    console.log('[refreshCalendarStatus] ë°›ì€ ë°ì´í„°:', data);

                    // ì „ì—­ ìƒíƒœ ì—…ë°ì´íŠ¸
                    bookingStatus = data.data;

                    // ê´€ë¦¬ì ìº˜ë¦°ë” ë‹¤ì‹œ ë Œë”ë§
                    renderAdminCalendar(adminCurrentDate);

                    console.log('[refreshCalendarStatus] ìº˜ë¦°ë” ìƒíƒœ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
                    return true;
                } catch (error) {
                    console.error('[refreshCalendarStatus] ì˜¤ë¥˜:', error);
                    return false;
                }
            }

            async function unblockDate(date) {
                try {
                    // sessionStorageì—ì„œ ê´€ë¦¬ì ì§€ì—­ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                    const adminRegion = sessionStorage.getItem('region');

                    // ì§€ì—­ í•„í„° ìš”ì†Œì—ì„œ ì„ íƒëœ ê°’ ê°€ì ¸ì˜¤ê¸°
                    const regionFilterElement = document.getElementById('regionFilter');
                    const selectedRegion = regionFilterElement ? regionFilterElement.value : null;

                    // ìµœì¢… ëŒ€ìƒ ì§€ì—­ ê²°ì •
                    const targetRegion = adminRegion === 'all' ? selectedRegion : adminRegion;

                    console.log('Target region for unblock:', targetRegion);

                    // ì§€ì—­ ê°’ ê²€ì¦
                    if (!targetRegion || !['south', 'north'].includes(targetRegion)) {
                        throw new Error('ìœ íš¨í•œ ì§€ì—­ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    }

                    const response = await apiRequest('/api/admin/dates/unblock', {
                        method: 'POST',
                        body: JSON.stringify({
                            date,
                            region: targetRegion
                        })
                    });

                    if (response.success) {
                        showAlert('ë‚ ì§œ ë§ˆê°ì´ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');

                        // ë‹¬ë ¥ ìƒíƒœ ì—…ë°ì´íŠ¸
                        await updateCalendarStatus();

                        // ë‚ ì§œë³„ ì˜ˆì•½ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                        if (currentSelectedDate) {
                            await loadDateBookings(currentSelectedDate);
                        }
                    }
                } catch (error) {
                    console.error('Date unblocking error:', error);
                    showAlert(error.message || 'ë‚ ì§œ ë§ˆê° í•´ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            // ì§ì ‘ í˜¸ì¶œí•˜ëŠ” updateCalendarStatus í•¨ìˆ˜ ì¶”ê°€ (ë””ë°”ìš´ìŠ¤ ì—†ì´)
            async function updateCalendarStatus() {
                try {
                    console.log('[updateCalendarStatus] Updating calendar status immediately...');

                    // 1. ê´€ë¦¬ì ì •ë³´ì™€ ì„ íƒëœ ì§€ì—­ í™•ì¸
                    const role = sessionStorage.getItem('role');
                    const adminRegion = sessionStorage.getItem('region');
                    let targetRegion = adminRegion;

                    // 2. ì „ì²´ ê´€ë¦¬ìì¸ ê²½ìš° ì„ íƒëœ ì§€ì—­ í•„í„° ì‚¬ìš©
                    if (role === 'admin' && adminRegion === 'all') {
                        const regionFilter = document.getElementById('regionFilter');
                        if (regionFilter) {
                            targetRegion = regionFilter.value;
                        }
                    }

                    console.log('[updateCalendarStatus] Target region:', targetRegion);

                    // 3. ì¤‘ìš”: ì§€ì—­ ì •ë³´ë¥¼ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ëª…ì‹œì  ì „ë‹¬
                    const url = `/api/bookings/status?region=${targetRegion}`;
                    console.log('[updateCalendarStatus] Requesting URL:', url);

                    const data = await apiRequest(url);
                    console.log('[updateCalendarStatus] Received data:', data);

                    // 4. ë°›ì•„ì˜¨ ë°ì´í„° ì €ì¥
                    bookingStatus = data.data;

                    // 5. ê´€ë¦¬ì/ì‚¬ìš©ìì— ë”°ë¼ ë‹¤ë¥¸ ìº˜ë¦°ë” ì—…ë°ì´íŠ¸
                    if (role === 'admin') {
                        renderAdminCalendar(adminCurrentDate);
                    } else {
                        renderCalendar(currentDate);
                    }

                    // 6. ë‚¨ì€ ì˜ˆì•½ íšŸìˆ˜ ì—…ë°ì´íŠ¸ (í•„ìš”í•œ ê²½ìš°)
                    if (data.remainingBookings !== undefined) {
                        updateRemainingBookingsDisplay(data.remainingBookings);
                    }

                    console.log('[updateCalendarStatus] Calendar status updated successfully');
                } catch (error) {
                    console.error('[updateCalendarStatus] Error:', error);
                }
            }

            // ë‚ ì§œë³„ ì˜ˆì•½ ì¡°íšŒ í•¨ìˆ˜
            async function loadDateBookings(dateString) {
                try {
                    if (!dateString) {
                        console.error('No date selected');
                        showAlert('ë‚ ì§œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.', 'error', 3000);
                        return;
                    }

                    console.log('Loading bookings for date:', dateString);

                    // ì „ì²´ ê´€ë¦¬ìì¸ ê²½ìš° ì§€ì—­ í•„í„° ì ìš©
                    const region = sessionStorage.getItem('region');
                    let apiUrl = `/api/admin/bookings/date/${dateString}`;

                    if (region === 'all') {
                        const regionFilter = document.getElementById('regionFilter')?.value;
                        if (regionFilter && regionFilter !== 'all') {
                            apiUrl += `?region=${regionFilter}`;
                        }
                    }

                    const data = await apiRequest(apiUrl);
                    console.log('Received booking data:', data);

                    const tbody = document.getElementById('dateBookingsList');
                    const modalDate = document.getElementById('modalDate');
                    const partialBlockDateBtn = document.getElementById('partialBlockDateBtn');
                    const fullBlockDateBtn = document.getElementById('fullBlockDateBtn');
                    const unblockDateBtn = document.getElementById('unblockDateBtn');

                    modalDate.textContent = formatDate(dateString);
                    currentSelectedDate = dateString;

                    const dateStatus = bookingStatus[dateString];
                    if (dateStatus?.isFullyBlocked || dateStatus?.isPartiallyBlocked) {
                        partialBlockDateBtn.classList.add('hidden');
                        fullBlockDateBtn.classList.add('hidden');
                        unblockDateBtn.classList.remove('hidden');
                    } else {
                        partialBlockDateBtn.classList.remove('hidden');
                        fullBlockDateBtn.classList.remove('hidden');
                        unblockDateBtn.classList.add('hidden');
                    }

                    if (data.success && data.data) {
                        const activeBookings = data.data.filter(booking =>
                            booking.status !== 'cancelled' &&
                            booking.status !== 'rejected' &&
                            booking.status !== 'cancel_pending'
                        );

                        tbody.innerHTML = activeBookings.length > 0
                            ? activeBookings.map(booking => `
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap">${booking.group_name}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${booking.start_time} - ${booking.end_time}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${booking.place}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${booking.people}ëª…</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                ${getStatusClass(booking.status)}">
                                ${getStatusText(booking.status)}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            ${booking.status === 'approved' ? `
                                <button onclick="forceCancel(${booking.id}, '${dateString}')" 
                                    class="bg-red-500 text-white px-3 py-1 rounded text-xs hover:bg-red-600 transition-colors">
                                    ê°•ì œì·¨ì†Œ
                                </button>
                            ` : ''}
                        </td>
                    </tr>
                `).join('')
                            : '<tr><td colspan="6" class="px-6 py-4 text-center">í˜„ì¬ ìœ íš¨í•œ ì˜ˆì•½ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                    }
                } catch (error) {
                    console.error('Error loading date bookings:', error);
                    showAlert('ì˜ˆì•½ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                }
            }

            // ê´€ë¦¬ììš© ì˜ˆì•½ ì„¤ì • ë¡œë“œ
            async function loadAdminBookingSettings() {
                try {
                    const response = await apiRequest('/api/admin/booking-settings');
                    if (response.success) {
                        const settings = response.data;
                        const region = sessionStorage.getItem('region');
                        const regionSettings = region === 'all' ? settings : settings[region];

                        updateBookingStatusUI(regionSettings?.is_active || false);
                        return regionSettings;
                    }
                } catch (error) {
                    console.error('Error loading booking settings:', error);
                    updateBookingStatusUI(false);
                    throw error;
                }
            }

            // ì¼ë°˜ ì‚¬ìš©ììš© ì˜ˆì•½ ì„¤ì • ë¡œë“œ
            async function loadUserBookingSettings() {
                try {
                    const response = await apiRequest('/api/booking-settings');
                    if (response.success) {
                        updateUserDashboardState(response.data?.is_active || false);
                        return response.data;
                    }
                } catch (error) {
                    console.error('Error loading booking settings:', error);
                    updateUserDashboardState(false);
                    showAlert('ì˜ˆì•½ ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            async function toggleBookingStatus() {
                try {
                    const region = sessionStorage.getItem('region');
                    // ì „ì²´ ê´€ë¦¬ìì˜ ê²½ìš° ì„ íƒëœ ì§€ì—­ ê°’ ì‚¬ìš©
                    const targetRegion = region === 'all' ?
                        document.getElementById('regionFilter').value : region;

                    if (!targetRegion) {
                        showAlert('ì§€ì—­ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
                        return;
                    }

                    const toggleButton = document.getElementById('toggleBookingStatus');
                    const isCurrentlyActive = toggleButton.textContent.includes('ì¤‘ì§€');

                    const response = await apiRequest('/api/admin/booking-settings', {
                        method: 'POST',
                        body: JSON.stringify({
                            region: targetRegion,
                            is_active: !isCurrentlyActive
                        })
                    });

                    if (response.success) {
                        showAlert(
                            isCurrentlyActive ? 'ì˜ˆì•½ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ì˜ˆì•½ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.',
                            'success'
                        );
                        updateBookingStatusUI(!isCurrentlyActive);
                        await debouncedUpdateCalendarStatus();

                        // í†µê³„ ë° ì˜ˆì•½ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                        await Promise.all([
                            loadRegionStatistics(),
                            loadPendingBookings()
                        ]);
                    }
                } catch (error) {
                    console.error('Toggle booking status error:', error);
                    showAlert(error.message || 'ì„¤ì • ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            // ê´€ë¦¬ììš© UI ì—…ë°ì´íŠ¸
            function updateBookingStatusUI(isActive) {
                const toggleButton = document.getElementById('toggleBookingStatus');
                const statusText = document.getElementById('bookingStatusText');
                const region = sessionStorage.getItem('region');
                const selectedRegion = region === 'all' ?
                    document.getElementById('regionFilter').value : region;
                const regionText = selectedRegion === 'south' ? 'ë‚¨ë¶€' : 'ë¶ë¶€';

                if (isActive) {
                    toggleButton.textContent = `${regionText} ì˜ˆì•½ ì¤‘ì§€í•˜ê¸°`;
                    toggleButton.className = 'px-6 py-3 rounded-xl font-medium bg-red-500 text-white hover:bg-red-600 transition-all duration-200';
                    statusText.textContent = `í˜„ì¬ ${regionText} ì§€ì—­ ì˜ˆì•½ì„ ë°›ê³  ìˆìŠµë‹ˆë‹¤`;
                    statusText.className = 'text-sm text-green-600';
                } else {
                    toggleButton.textContent = `${regionText} ì˜ˆì•½ ì‹œì‘í•˜ê¸°`;
                    toggleButton.className = 'px-6 py-3 rounded-xl font-medium bg-green-500 text-white hover:bg-green-600 transition-all duration-200';
                    statusText.textContent = `í˜„ì¬ ${regionText} ì§€ì—­ ì˜ˆì•½ì„ ë°›ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤`;
                    statusText.className = 'text-sm text-red-600';
                }
            }

            // ì—°ë½ì²˜ í˜•ì‹ ì²˜ë¦¬ í•¨ìˆ˜ (í•˜ì´í”ˆ ìœ ë¬´ì— ê´€ê³„ì—†ì´ ì²˜ë¦¬)
            function formatContact(contact) {
                // ìˆ«ìë§Œ ì¶”ì¶œ
                const digits = contact.replace(/\D/g, '');

                // ìˆ«ì ê¸¸ì´ì— ë”°ë¼ í•˜ì´í”ˆ ì¶”ê°€
                if (digits.length === 10) {
                    // ì§€ì—­ë²ˆí˜¸(2ìë¦¬)ì¸ ê²½ìš°: 02-123-4567
                    if (digits.startsWith('02')) {
                        return `${digits.substring(0, 2)}-${digits.substring(2, 6)}-${digits.substring(6)}`;
                    }
                    // ê·¸ ì™¸ 10ìë¦¬: 010-123-4567
                    return `${digits.substring(0, 3)}-${digits.substring(3, 6)}-${digits.substring(6)}`;
                } else if (digits.length === 11) {
                    // 11ìë¦¬: 010-1234-5678
                    return `${digits.substring(0, 3)}-${digits.substring(3, 7)}-${digits.substring(7)}`;
                } else if (digits.length === 9) {
                    // 9ìë¦¬ (ì§€ì—­ë²ˆí˜¸ 2ìë¦¬): 02-123-4567
                    if (digits.startsWith('02')) {
                        return `${digits.substring(0, 2)}-${digits.substring(2, 5)}-${digits.substring(5)}`;
                    }
                }

                // ê¸°ì¡´ í˜•ì‹ì„ ê·¸ëŒ€ë¡œ ë°˜í™˜
                return contact;
            }

            // ë””ë°”ìš´ìŠ¤ í•¨ìˆ˜
            function debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            // PDF ë‹¬ë ¥ ìƒì„± í•¨ìˆ˜
            async function generateCalendarPDF(year, month) {
                try {
                    showLoading();

                    // ê´€ë¦¬ì ì§€ì—­ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                    const adminRegion = sessionStorage.getItem('region') || 'all';

                    // ì˜ˆì•½ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    const response = await apiRequest(`/api/admin/bookings/month/${year}/${month}`, {
                        method: 'POST',
                        body: JSON.stringify({ region: adminRegion })
                    });

                    if (!response.success) {
                        throw new Error('ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨');
                    }

                    const bookings = response.data || {};

                    // ì„ì‹œ ë‹¬ë ¥ ìš”ì†Œ ìƒì„±
                    const tempDiv = document.createElement('div');
                    tempDiv.style.fontFamily = 'Noto Sans KR, sans-serif';
                    tempDiv.style.position = 'absolute';
                    tempDiv.style.left = '-9999px';
                    tempDiv.style.width = '1122px'; // A4 landscape at 96 DPI (297mm Ã— 210mm)
                    tempDiv.style.background = 'white';

                    // ë‹¬ë ¥ HTML ìƒì„±
                    const calendarHtml = await generateCalendarHTML(year, month, bookings, adminRegion);
                    tempDiv.innerHTML = calendarHtml;

                    // ì„ì‹œ ìš”ì†Œë¥¼ bodyì— ì¶”ê°€
                    document.body.appendChild(tempDiv);

                    // HTML2Canvasë¡œ HTMLì„ ì´ë¯¸ì§€ë¡œ ë³€í™˜
                    const canvas = await html2canvas(tempDiv, {
                        scale: 2, // í•´ìƒë„ í–¥ìƒ
                        logging: false,
                        useCORS: true,
                        allowTaint: true
                    });

                    // ì„ì‹œ ìš”ì†Œ ì œê±°
                    document.body.removeChild(tempDiv);

                    // jsPDF ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (A4 ìš©ì§€, ê°€ë¡œ ë°©í–¥)
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF({
                        orientation: 'landscape',
                        unit: 'mm',
                        format: 'a4'
                    });

                    // Canvas ì´ë¯¸ì§€ë¥¼ PDFì— ì¶”ê°€
                    const imgData = canvas.toDataURL('image/jpeg', 0.95);
                    doc.addImage(imgData, 'JPEG', 0, 0, 297, 210);

                    // PDF íŒŒì¼ ì €ì¥
                    const fileName = `ìŠ¤í¬ì¸ ë°•ìŠ¤_ì¼ì •í‘œ_${year}ë…„${month}ì›”.pdf`;
                    doc.save(fileName);

                    showAlert('PDF ì¼ì •í‘œê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success', 3000);

                    return true;
                } catch (error) {
                    console.error('PDF ìƒì„± ì˜¤ë¥˜:', error);
                    showAlert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error', 3000);
                    return false;
                } finally {
                    hideLoading();
                }
            }

            // ë‹¬ë ¥ HTML ìƒì„± í•¨ìˆ˜
            async function generateCalendarHTML(year, month, bookings, adminRegion) {
                // ë‚ ì§œ ì •ë³´ ê³„ì‚°
                const startDate = new Date(year, month - 1, 1);
                const endDate = new Date(year, month, 0);
                const lastDay = endDate.getDate();
                const firstDayOfWeek = startDate.getDay(); // 0: ì¼ìš”ì¼, 6: í† ìš”ì¼

                // ì§€ì—­ ì •ë³´ í…ìŠ¤íŠ¸
                const regionText = adminRegion === 'all' ? 'ì „ì²´ ì§€ì—­' :
                    adminRegion === 'south' ? 'ë‚¨ë¶€ ì§€ì—­' : 'ë¶ë¶€ ì§€ì—­';

                // CSS ìŠ¤íƒ€ì¼
                const styleCSS = `
        <style>
            .calendar-container {
                font-family: 'Noto Sans KR', sans-serif;
                width: 100%;
                max-width: 1122px;
                box-sizing: border-box;
            }
            .calendar-header {
                background-color: #0066CC;
                color: white;
                padding: 10px 15px;
                text-align: center;
                position: relative;
                font-weight: bold;
                font-size: 20px;
                margin-bottom: 10px;
            }
            .region-info {
                position: absolute;
                right: 15px;
                top: 50%;
                transform: translateY(-50%);
                font-size: 12px;
            }
            .calendar-grid {
                width: 100%;
                border-collapse: collapse;
            }
            .calendar-grid th {
                background-color: #EBF5FF;
                padding: 8px;
                text-align: center;
                font-weight: bold;
                border: 1px solid #ddd;
            }
            .calendar-grid th.weekend {
                color: #E53E3E;
            }
            .calendar-grid td {
                border: 1px solid #ddd;
                vertical-align: top;
                height: 100px;
                width: 14.28%;
                padding: 5px;
            }
            .calendar-grid td.weekend {
                background-color: #FEF3C7;
            }
            .date-number {
                font-weight: bold;
                margin-bottom: 5px;
            }
            .booking-item {
                margin-bottom: 4px;
                font-size: 12px;
            }
            .booking-time {
                color: #2563EB;
                margin-right: 5px;
            }
            .booking-group {
                color: #1F2937;
            }
            .more-bookings {
                color: #FF6B00;
                font-size: 11px;
                margin-top: 2px;
            }
            .footer {
                display: flex;
                justify-content: space-between;
                margin-top: 10px;
                font-size: 10px;
                color: #6B7280;
            }
        </style>
    `;

                // ì‹œì‘ HTML
                let html = `
        ${styleCSS}
        <div class="calendar-container">
            <div class="calendar-header">
                ìŠ¤í¬ì¸ ë°•ìŠ¤ ${year}ë…„ ${month}ì›” ì¼ì •í‘œ
                <span class="region-info">ì§€ì—­: ${regionText}</span>
            </div>
            <table class="calendar-grid">
                <thead>
                    <tr>
                        <th class="weekend">ì¼</th>
                        <th>ì›”</th>
                        <th>í™”</th>
                        <th>ìˆ˜</th>
                        <th>ëª©</th>
                        <th>ê¸ˆ</th>
                        <th class="weekend">í† </th>
                    </tr>
                </thead>
                <tbody>
    `;

                // ë‹¬ë ¥ ë‚ ì§œ ê·¸ë¦¬ê¸°
                let currentDay = 1;
                const today = new Date();

                // ë‹¬ë ¥ í–‰ ì¶”ê°€
                for (let row = 0; row < 6; row++) {
                    // ì´ í–‰ì— í‘œì‹œí•  ë‚ ì§œê°€ ì—†ìœ¼ë©´ ì¤‘ë‹¨
                    if (currentDay > lastDay) break;

                    html += '<tr>';

                    // ì—´ ì¶”ê°€
                    for (let col = 0; col < 7; col++) {
                        // ì²« ë²ˆì§¸ ì£¼ì—ì„œ ì‹œì‘ì¼ ì´ì „ì˜ ì…€ì€ ë¹ˆ ì¹¸ìœ¼ë¡œ
                        if (row === 0 && col < firstDayOfWeek) {
                            html += '<td></td>';
                            continue;
                        }

                        // í•´ë‹¹ ì›”ì˜ ë§ˆì§€ë§‰ ë‚ ì§œë¥¼ ì´ˆê³¼í•˜ë©´ ë¹ˆ ì¹¸ìœ¼ë¡œ
                        if (currentDay > lastDay) {
                            html += '<td></td>';
                            continue;
                        }

                        // ë‚ ì§œ ë¬¸ìì—´ ìƒì„±
                        const dateString = `${year}-${String(month).padStart(2, '0')}-${String(currentDay).padStart(2, '0')}`;

                        // ì£¼ë§ ì—¬ë¶€ ì²´í¬
                        const isWeekend = col === 0 || col === 6;

                        // í•´ë‹¹ ë‚ ì§œì˜ ì˜ˆì•½ ì •ë³´
                        const dayBookings = bookings[dateString] || [];

                        // ì…€ HTML ìƒì„±
                        html += `<td class="${isWeekend ? 'weekend' : ''}">`;
                        html += `<div class="date-number">${currentDay}</div>`;

                        // ì˜ˆì•½ ì •ë³´ ì¶”ê°€ (ìµœëŒ€ 4ê°œê¹Œì§€ í‘œì‹œ)
                        const displayBookings = dayBookings.slice(0, 4);

                        displayBookings.forEach(booking => {
                            // ì‹œì‘ ë° ì¢…ë£Œ ì‹œê°„
                            const startTime = booking.start_time.substring(0, 5);
                            const endTime = booking.end_time.substring(0, 5);
                            const timeText = `${startTime}~${endTime}`;

                            // ë‹¨ì²´ëª… (ê¸¸ë©´ ìë¥´ê¸°)
                            const groupName = booking.group_name.length > 10 ?
                                booking.group_name.substring(0, 9) + "..." :
                                booking.group_name;

                            html += `
                    <div class="booking-item">
                        <span class="booking-time">${timeText}</span>
                        <span class="booking-group">${groupName}</span>
                    </div>
                `;
                        });

                        // ì¶”ê°€ ì˜ˆì•½ì´ ìˆì„ ê²½ìš° í‘œì‹œ
                        if (dayBookings.length > 4) {
                            html += `<div class="more-bookings">+${dayBookings.length - 4}ê°œ ë”...</div>`;
                        }

                        html += '</td>';

                        // ë‚ ì§œ ì¦ê°€
                        currentDay++;
                    }

                    html += '</tr>';
                }

                // í˜„ì¬ ë‚ ì§œë¡œ ì¶œë ¥ì¼ í¬ë§·
                const today_str = new Date().toLocaleDateString('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                });

                // HTML ë‹«ê¸°
                html += `
                </tbody>
            </table>
            <div class="footer">
                <div>ê²½ê¸°ë„ì²´ìœ¡íšŒ ìŠ¤í¬ì¸ ë°•ìŠ¤</div>
                <div>ì¶œë ¥ì¼: ${today_str}</div>
            </div>
        </div>
    `;

                return html;
            }

            // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ê´€ë ¨ í•¨ìˆ˜ë“¤
            async function generateExcelData(year, month) {
                try {
                    const response = await apiRequest(`/api/admin/bookings/month/${year}/${month}`);
                    if (!response.success) {
                        throw new Error('ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨');
                    }

                    const bookings = response.data;
                    const ws = XLSX.utils.aoa_to_sheet([
                        ['ë‚ ì§œ', 'ë‹¨ì²´ëª…', 'ì‹œê°„', 'ì¥ì†Œ', 'ì¸ì›', 'ìƒíƒœ'] // í—¤ë” í–‰
                    ]);

                    const data = Object.entries(bookings).flatMap(([date, dayBookings]) =>
                        dayBookings.map(booking => [
                            formatDate(date),
                            booking.group_name,
                            `${booking.start_time} - ${booking.end_time}`,
                            booking.place,
                            booking.people,
                            getStatusText(booking.status)
                        ])
                    );

                    XLSX.utils.sheet_add_aoa(ws, data, { origin: -1 });

                    // ì—´ ë„ˆë¹„ ìë™ ì¡°ì •
                    const wscols = [
                        { wch: 15 }, // ë‚ ì§œ
                        { wch: 20 }, // ë‹¨ì²´ëª…
                        { wch: 15 }, // ì‹œê°„
                        { wch: 20 }, // ì¥ì†Œ
                        { wch: 10 }, // ì¸ì›
                        { wch: 12 }  // ìƒíƒœ
                    ];
                    ws['!cols'] = wscols;

                    return ws;
                } catch (error) {
                    console.error('Excel data generation error:', error);
                    throw error;
                }
            }

            // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('downloadExcel')?.addEventListener('click', async function () {
                const year = adminCurrentDate.getFullYear();
                const month = adminCurrentDate.getMonth() + 1;

                try {
                    showLoading();
                    await generateCalendarPDF(year, month);
                } catch (error) {
                    console.error('PDF ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                    showAlert('PDF ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error', 3000);
                } finally {
                    hideLoading();
                }
            });

            // ëª¨ë‹¬ ì»¨íŠ¸ë¡¤ í•¨ìˆ˜ë“¤
            function openDateBookingsModal() {
                try {
                    const modal = document.getElementById('dateBookingsModal');
                    if (!modal) {
                        console.error('ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                        return;
                    }

                    // ìŠ¤íƒ€ì¼ ì§ì ‘ ì„¤ì •
                    modal.style.display = 'flex';
                    modal.style.opacity = '1';
                    modal.style.visibility = 'visible';

                    // show í´ë˜ìŠ¤ ì¶”ê°€ (CSS íŠ¸ëœì§€ì…˜ìš©)
                    setTimeout(() => {
                        modal.classList.add('show');
                    }, 10);

                    // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
                    document.body.style.overflow = 'hidden';

                    console.log('ëª¨ë‹¬ í‘œì‹œë¨');
                } catch (error) {
                    console.error('ëª¨ë‹¬ í‘œì‹œ ì˜¤ë¥˜:', error);
                }
            }

            function closeDateBookingsModal() {
                try {
                    console.log('ëª¨ë‹¬ ë‹«ê¸° ì‹œì‘');
                    const calendarContainer = document.getElementById('adminCalendar')?.parentElement;
                    if (calendarContainer) {
                        calendarContainer.classList.remove('modal-open');
                    }

                    // ëª¨ë‹¬ DOM ìš”ì†Œ ì°¸ì¡°
                    const modal = document.getElementById('dateBookingsModal');
                    if (!modal) {
                        console.error('ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                        return;
                    }

                    // ëª¨ë‹¬ ìƒíƒœ ì´ˆê¸°í™”
                    const dateBookingsList = document.getElementById('dateBookingsList');
                    if (dateBookingsList) {
                        dateBookingsList.innerHTML = '';
                    }

                    // í˜„ì¬ ì„ íƒëœ ë‚ ì§œ ì´ˆê¸°í™”
                    currentSelectedDate = null;

                    // ëª¨ë‹¬ ë‹«ê¸°
                    modal.classList.remove('show');
                    setTimeout(() => {
                        modal.style.display = 'none';
                        document.body.style.overflow = '';
                        console.log('ëª¨ë‹¬ ë‹«ê¸° ì™„ë£Œ');
                    }, 300);
                } catch (error) {
                    console.error('ëª¨ë‹¬ ë‹«ê¸° ì˜¤ë¥˜:', error);
                }
            }

            // ìº˜ë¦°ë” ê´€ë ¨ ë³€ìˆ˜ì™€ í•¨ìˆ˜ë“¤
            let currentDate = new Date();
            let adminCurrentDate = new Date();

            // ìº˜ë¦°ë” ìƒíƒœ ì—…ë°ì´íŠ¸
            const debouncedUpdateCalendarStatus = debounce(async () => {
                try {
                    console.log('Updating calendar status...');

                    // 1. ê´€ë¦¬ì ì •ë³´ì™€ ì„ íƒëœ ì§€ì—­ í™•ì¸
                    const role = sessionStorage.getItem('role');
                    const adminRegion = sessionStorage.getItem('region');
                    let targetRegion = adminRegion;

                    // 2. ì „ì²´ ê´€ë¦¬ìì¸ ê²½ìš° ì„ íƒëœ ì§€ì—­ í•„í„° ì‚¬ìš©
                    if (role === 'admin' && adminRegion === 'all') {
                        const regionFilter = document.getElementById('regionFilter');
                        if (regionFilter) {
                            targetRegion = regionFilter.value;
                        }
                    }

                    console.log('Calendar update for region:', targetRegion);

                    // 3. API ìš”ì²­
                    const data = await apiRequest('/api/bookings/status');
                    console.log('Received calendar status:', data);

                    // 4. ë°›ì•„ì˜¨ ë°ì´í„° ì €ì¥
                    bookingStatus = data.data;

                    // 5. ê´€ë¦¬ì/ì‚¬ìš©ìì— ë”°ë¼ ë‹¤ë¥¸ ìº˜ë¦°ë” ì—…ë°ì´íŠ¸
                    if (role === 'admin') {
                        renderAdminCalendar(adminCurrentDate);

                        // 6. ì§€ì—­ë³„ í†µê³„ ìƒˆë¡œê³ ì¹¨ (í•„ìš”í•œ ê²½ìš°)
                        if (typeof loadRegionStatistics === 'function') {
                            await loadRegionStatistics();
                        }
                    } else {
                        renderCalendar(currentDate);
                    }

                    // 7. ë‚¨ì€ ì˜ˆì•½ íšŸìˆ˜ ì—…ë°ì´íŠ¸
                    if (data.remainingBookings !== undefined) {
                        updateRemainingBookingsDisplay(data.remainingBookings);
                    }

                    console.log('Calendar status updated successfully');
                } catch (error) {
                    console.error('Calendar status update error:', error);
                }
            }, 500);

            // ë¡œê·¸ì¸ í•¨ìˆ˜ë„ ìˆ˜ì •
            async function login(username, password) {
                try {
                    showLoading();
                    const response = await apiRequest('/api/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            group_name: username,
                            password: password
                        })
                    });

                    if (response.success) {
                        // ì„¸ì…˜ ì •ë³´ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì²˜ë¦¬ (ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ë¡œê·¸ì¸ ê°ì§€)
                        if (response.session && response.session.duplicate_login) {
                            showAlert(`ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ì´ë¯¸ ë¡œê·¸ì¸í•œ ê³„ì •ì…ë‹ˆë‹¤. í•´ë‹¹ ê¸°ê¸°ëŠ” ìë™ìœ¼ë¡œ ë¡œê·¸ì•„ì›ƒë©ë‹ˆë‹¤.`, 'warning', 5000);
                        }

                        // ê¸°ì¡´ ì½”ë“œì™€ ë™ì¼
                        sessionStorage.setItem('token', response.token);
                        sessionStorage.setItem('role', response.user.role);
                        sessionStorage.setItem('username', response.user.group_name);
                        sessionStorage.setItem('region', response.user.region);
                        sessionStorage.setItem('city', response.user.city);
                        sessionStorage.setItem('manager', response.user.manager);
                        sessionStorage.setItem('contact', response.user.contact);

                        document.getElementById('adminDashboard').classList.add('hidden');
                        document.getElementById('userDashboard').classList.add('hidden');
                        document.getElementById('loginScreen').classList.add('hidden');

                        // ê´€ë¦¬ì ìƒíƒœ í™•ì¸ (ê³µì§€ì‚¬í•­ ê¸€ì“°ê¸° ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€)
                        checkAdminStatus();

                        await showDashboard(response.user.role);
                        showAlert('ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success', 2000);
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    showAlert(error.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            // íšŒì›ê°€ì… í¼ ì œì¶œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('signupForm').addEventListener('submit', async function (e) {
                e.preventDefault();

                // ëª¨ë“  í•„ìˆ˜ í•„ë“œ ê°’ ê°€ì ¸ì˜¤ê¸°
                const groupName = document.getElementById('groupName').value.trim();
                const password = document.getElementById('signupPassword').value;
                const manager = document.getElementById('manager').value.trim();
                const city = document.getElementById('city').value;
                let contact = document.getElementById('contact').value.trim();
                const region = determineRegion(city);

                // ë‹¨ì²´ëª… ìœ íš¨ì„± ê²€ì‚¬
                if (!groupName) {
                    showAlert('ë‹¨ì²´ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error', 3000);
                    document.getElementById('groupName').focus();
                    return;
                }

                if (groupName.length < 2) {
                    showAlert('ë‹¨ì²´ëª…ì€ 2ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error', 3000);
                    document.getElementById('groupName').focus();
                    return;
                }

                // ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬ ê°•í™”
                if (!password) {
                    showAlert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error', 3000);
                    document.getElementById('signupPassword').focus();
                    return;
                }

                if (password.length < 6) {
                    showAlert('ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error', 3000);
                    document.getElementById('signupPassword').focus();
                    return;
                }

                // íŠ¹ìˆ˜ë¬¸ì, ìˆ«ì í¬í•¨ ê²€ì‚¬ ì¶”ê°€
                if (!/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(password)) {
                    showAlert('ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸ê³¼ ìˆ«ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.', 'error', 3000);
                    document.getElementById('signupPassword').focus();
                    return;
                }

                // ë‹´ë‹¹ìëª… ìœ íš¨ì„± ê²€ì‚¬
                if (!manager) {
                    showAlert('ë‹´ë‹¹ìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error', 3000);
                    document.getElementById('manager').focus();
                    return;
                }

                if (manager.length < 2) {
                    showAlert('ë‹´ë‹¹ìëª…ì€ 2ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error', 3000);
                    document.getElementById('manager').focus();
                    return;
                }

                // ì‹œ/êµ° ì„ íƒ ê²€ì‚¬
                if (!city) {
                    showAlert('ì‹œ/êµ°ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error', 3000);
                    document.getElementById('city').focus();
                    return;
                }

                if (!region) {
                    showAlert('ì˜¬ë°”ë¥¸ ì‹œ/êµ°ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error', 3000);
                    document.getElementById('city').focus();
                    return;
                }

                // ì—°ë½ì²˜ ìœ íš¨ì„± ê²€ì‚¬
                if (!contact) {
                    showAlert('ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error', 3000);
                    document.getElementById('contact').focus();
                    return;
                }

                // ì—°ë½ì²˜ í˜•ì‹ ê²€ì‚¬ - í•˜ì´í”ˆ ìœ ë¬´ì— ê´€ê³„ì—†ì´ ìˆ«ìë§Œ ì¶”ì¶œí•˜ì—¬ ê¸¸ì´ í™•ì¸
                const digits = contact.replace(/\D/g, '');
                if (digits.length < 9 || digits.length > 11) {
                    showAlert('ì˜¬ë°”ë¥¸ ì—°ë½ì²˜ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'error', 3000);
                    document.getElementById('contact').focus();
                    return;
                }

                // ì—°ë½ì²˜ í˜•ì‹ í†µì¼ (í•˜ì´í”ˆ ì¶”ê°€)
                contact = formatContact(contact);

                // ê°œì¸ì •ë³´ ë™ì˜ í™•ì¸
                if (!document.getElementById('privacyConsent').checked) {
                    showAlert('ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•´ì£¼ì„¸ìš”.', 'error', 3000);
                    return;
                }

                // í¼ ì œì¶œ ì „ í™•ì¸
                try {
                    // ë¡œë”© í‘œì‹œ
                    showLoading();

                    const formData = {
                        groupName: groupName,
                        password: password,
                        manager: manager,
                        contact: contact,
                        city: city,
                        region: region
                    };

                    // íšŒì›ê°€ì… ì²˜ë¦¬
                    signup(formData)
                        .catch(error => {
                            console.error('Signup error:', error);
                            showAlert(error.message || 'íšŒì›ê°€ì… ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                        })
                        .finally(() => {
                            hideLoading();
                        });

                } catch (error) {
                    hideLoading();
                    console.error('Form submission error:', error);
                    showAlert('íšŒì›ê°€ì… ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                }
            });

            // ì§€ì—­ ì •ë³´ í‘œì‹œ ì—…ë°ì´íŠ¸
            function updateRegionDisplay() {
                const region = sessionStorage.getItem('region');
                const regionBadge = document.getElementById('regionBadge');

                if (regionBadge) {
                    regionBadge.textContent = region === 'south' ? 'ë‚¨ë¶€' :
                        region === 'north' ? 'ë¶ë¶€' :
                            region === 'all' ? 'ì „ì²´' : '';

                    regionBadge.className = `px-3 py-1 rounded-full text-sm font-medium ${region === 'south' ? 'bg-blue-100 text-blue-800' :
                        region === 'north' ? 'bg-green-100 text-green-800' :
                            region === 'all' ? 'bg-purple-100 text-purple-800' :
                                'bg-gray-100 text-gray-800'
                        }`;
                }
            }

            // ì›”ë³„ ë‚¨ì€ ì˜ˆì•½ íšŸìˆ˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
            async function updateMonthlyRemainingBookings() {
                try {
                    const year = currentDate.getFullYear();
                    const month = currentDate.getMonth() + 1;
                    const startDate = `${year}-${month.toString().padStart(2, '0')}-01`;
                    const lastDay = new Date(year, month, 0).getDate();
                    const endDate = `${year}-${month.toString().padStart(2, '0')}-${lastDay}`;

                    const response = await apiRequest(`/api/bookings/remaining?start=${startDate}&end=${endDate}`);

                    if (response.success && response.remainingBookings !== undefined) {
                        updateRemainingBookingsDisplay(response.remainingBookings);
                    }
                } catch (error) {
                    console.error('ë‚¨ì€ ì˜ˆì•½ íšŸìˆ˜ ì¡°íšŒ ì˜¤ë¥˜:', error);
                }
            }

            function initializeCalendar() {
                const calendar = document.getElementById('calendar');
                const currentMonthElement = document.getElementById('currentMonth');
                const prevButton = document.getElementById('prevMonth');
                const nextButton = document.getElementById('nextMonth');

                // í˜„ì¬ ë‚ ì§œ ìƒíƒœ ì´ˆê¸°í™”
                if (!currentDate) {
                    currentDate = new Date();
                }

                // ê¸°ì¡´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì œê±° í›„ ìƒˆë¡œ ì¶”ê°€
                const newPrevButton = prevButton.cloneNode(true);
                const newNextButton = nextButton.cloneNode(true);
                prevButton.parentNode.replaceChild(newPrevButton, prevButton);
                nextButton.parentNode.replaceChild(newNextButton, nextButton);

                newPrevButton.addEventListener('click', async function () {
                    // ì´ì „ ë‹¬ë¡œ ì´ë™ (í•œ ë‹¬ì”©)
                    currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1);
                    renderCalendar(currentDate);

                    // í•„ìˆ˜: ë‹¬ë ¥ ìƒíƒœ ì—…ë°ì´íŠ¸ì™€ ì˜ˆì•½ ëª©ë¡ì„ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•˜ê³  ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
                    await updateCalendarStatus(); // ë””ë°”ìš´ìŠ¤ ëŒ€ì‹  ì§ì ‘ í˜¸ì¶œë¡œ ë³€ê²½
                    loadBookings(); // ì˜ˆì•½ ëª©ë¡ ë‹¤ì‹œ ë¡œë“œ

                    // í•´ë‹¹ ì›”ì˜ ë‚¨ì€ ì˜ˆì•½ íšŸìˆ˜ ê°±ì‹  ìš”ì²­
                    updateMonthlyRemainingBookings();
                });

                newNextButton.addEventListener('click', async function () {
                    // ë‹¤ìŒ ë‹¬ë¡œ ì´ë™ (í•œ ë‹¬ì”©)
                    currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1);
                    renderCalendar(currentDate);

                    // í•„ìˆ˜: ë‹¬ë ¥ ìƒíƒœ ì—…ë°ì´íŠ¸ì™€ ì˜ˆì•½ ëª©ë¡ì„ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•˜ê³  ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
                    await updateCalendarStatus(); // ë””ë°”ìš´ìŠ¤ ëŒ€ì‹  ì§ì ‘ í˜¸ì¶œë¡œ ë³€ê²½
                    loadBookings(); // ì˜ˆì•½ ëª©ë¡ ë‹¤ì‹œ ë¡œë“œ

                    // í•´ë‹¹ ì›”ì˜ ë‚¨ì€ ì˜ˆì•½ íšŸìˆ˜ ê°±ì‹  ìš”ì²­
                    updateMonthlyRemainingBookings();
                });

                renderCalendar(currentDate);
            }

            async function initializeAdminCalendar() {
                const adminCalendar = document.getElementById('adminCalendar');
                const adminCurrentMonthElement = document.getElementById('adminCurrentMonth');
                const prevButton = document.getElementById('adminPrevMonth');
                const nextButton = document.getElementById('adminNextMonth');

                // í˜„ì¬ ë‚ ì§œ ìƒíƒœ ì´ˆê¸°í™”
                if (!adminCurrentDate) {
                    adminCurrentDate = new Date();
                }

                // ê¸°ì¡´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì œê±° í›„ ìƒˆë¡œ ì¶”ê°€
                const newPrevButton = prevButton.cloneNode(true);
                const newNextButton = nextButton.cloneNode(true);
                prevButton.parentNode.replaceChild(newPrevButton, prevButton);
                nextButton.parentNode.replaceChild(newNextButton, nextButton);

                // ì´ì „ ë‹¬ ë²„íŠ¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— updateCalendarStatus ì¶”ê°€
                newPrevButton.addEventListener('click', async function () {
                    adminCurrentDate = new Date(adminCurrentDate.getFullYear(),
                        adminCurrentDate.getMonth() - 1, 1);
                    // ìƒíƒœ ì—…ë°ì´íŠ¸ í›„ ë‹¬ë ¥ ë Œë”ë§
                    await updateCalendarStatus();  // ì´ ë¶€ë¶„ ì¶”ê°€
                    renderAdminCalendar(adminCurrentDate);
                });

                // ë‹¤ìŒ ë‹¬ ë²„íŠ¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— updateCalendarStatus ì¶”ê°€
                newNextButton.addEventListener('click', async function () {
                    adminCurrentDate = new Date(adminCurrentDate.getFullYear(),
                        adminCurrentDate.getMonth() + 1, 1);
                    // ìƒíƒœ ì—…ë°ì´íŠ¸ í›„ ë‹¬ë ¥ ë Œë”ë§
                    await updateCalendarStatus();  // ì´ ë¶€ë¶„ ì¶”ê°€
                    renderAdminCalendar(adminCurrentDate);
                });

                // ì¤‘ìš”: ì´ˆê¸° ë Œë”ë§ ì „ì— ì˜ˆì•½ ìƒíƒœ ì—…ë°ì´íŠ¸
                await updateCalendarStatus();  // ì´ ë¶€ë¶„ ì¶”ê°€
                renderAdminCalendar(adminCurrentDate);

                // ë””ë²„ê·¸ ë¡œê·¸
                console.log('ê´€ë¦¬ì ë‹¬ë ¥ ì´ˆê¸°í™” ì™„ë£Œ:', {
                    ë‹¬ë ¥ìš”ì†Œ: adminCalendar,
                    ë‚ ì§œ: adminCurrentDate
                });
            }

            // ì¼ë°˜ ì‚¬ìš©ììš© ë‚ ì§œ í´ë¦­ í•¸ë“¤ëŸ¬
            function addDateClickHandler(element, year, month, day) {
                element.addEventListener('click', function () {
                    // ê¸°ì¡´ ì„ íƒ í´ë˜ìŠ¤ ì œê±°
                    const selected = document.querySelector('.selected');
                    if (selected) {
                        selected.classList.remove('selected');
                    }

                    // í˜„ì¬ ì„ íƒì— ì„ íƒ í´ë˜ìŠ¤ ì¶”ê°€
                    element.classList.add('selected');

                    // ì„ íƒëœ ë‚ ì§œ í‘œì‹œ
                    document.getElementById('selectedDate').value = `${year}ë…„ ${month + 1}ì›” ${day}ì¼`;

                    // ì´ì „ ì˜ˆì•½ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
                    const startTimeSelect = document.getElementById('startTime');
                    const endTimeSelect = document.getElementById('endTime');
                    const peopleInput = document.getElementById('people');
                    const placeInput = document.getElementById('place');

                    // ì €ì¥ëœ ê°’ì´ ìˆìœ¼ë©´ ë¶ˆëŸ¬ì˜¤ê¸°
                    const savedStartTime = localStorage.getItem('lastBookingStartTime');
                    const savedEndTime = localStorage.getItem('lastBookingEndTime');
                    const savedPeople = localStorage.getItem('lastBookingPeople');
                    const savedPlace = localStorage.getItem('lastBookingPlace');

                    // ì‹œì‘ ì‹œê°„ ì„¤ì • (ì‹œì‘ ì‹œê°„ ì˜µì…˜ì´ ìˆëŠ”ì§€ í™•ì¸)
                    if (savedStartTime && startTimeSelect.querySelector(`option[value="${savedStartTime}"]`)) {
                        startTimeSelect.value = savedStartTime;
                        // ì‹œì‘ ì‹œê°„ ë³€ê²½ ì´ë²¤íŠ¸ ë°œìƒì‹œì¼œ ì¢…ë£Œ ì‹œê°„ ì˜µì…˜ ì—…ë°ì´íŠ¸
                        startTimeSelect.dispatchEvent(new Event('change'));

                        // ì¢…ë£Œ ì‹œê°„ ì„¤ì • (ì¢…ë£Œ ì‹œê°„ ì˜µì…˜ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ í›„)
                        if (savedEndTime) {
                            // ì•½ê°„ì˜ ì§€ì—° ì¶”ê°€ (ì‹œì‘ ì‹œê°„ ë³€ê²½ ì´ë²¤íŠ¸ê°€ ì²˜ë¦¬ëœ í›„)
                            setTimeout(() => {
                                // ì˜µì…˜ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
                                if (endTimeSelect.querySelector(`option[value="${savedEndTime}"]`)) {
                                    endTimeSelect.value = savedEndTime;
                                }
                            }, 50);
                        }
                    }

                    // ì¸ì›ìˆ˜ ì„¤ì •
                    if (savedPeople) {
                        peopleInput.value = savedPeople;
                    }

                    // ì¥ì†Œ ì„¤ì •
                    if (savedPlace) {
                        placeInput.value = savedPlace;
                    }
                });
            }

            // ê´€ë¦¬ììš© ë‚ ì§œ í´ë¦­ í•¸ë“¤ëŸ¬
            function addAdminDateClickHandler(element, dateString, targetRegion) {
                // ê¸°ì¡´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì œê±° (ì¤‘ìš”!)
                const clonedElement = element.cloneNode(true);
                element.parentNode.replaceChild(clonedElement, element);

                // ìƒˆ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
                clonedElement.addEventListener('click', async (e) => {
                    e.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€
                    e.stopPropagation(); // ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì§€

                    console.log(`ë‚ ì§œ í´ë¦­: ${dateString}`);

                    if (!dateString || !dateString.match(/^\d{4}-\d{2}-\d{2}$/)) {
                        console.error('ì˜ëª»ëœ ë‚ ì§œ í˜•ì‹:', dateString);
                        showAlert('ì˜¬ë°”ë¥´ì§€ ì•Šì€ ë‚ ì§œ í˜•ì‹ì…ë‹ˆë‹¤.', 'error');
                        return;
                    }

                    try {
                        // í˜„ì¬ ëª¨ë‹¬ì´ ì—´ë ¤ìˆìœ¼ë©´ ë‹«ê¸°
                        const currentModal = document.getElementById('dateBookingsModal');
                        if (currentModal && currentModal.classList.contains('show')) {
                            closeDateBookingsModal();
                            // ì•½ê°„ì˜ ë”œë ˆì´ ì¶”ê°€ (ëª¨ë‹¬ ì „í™˜ ì‹œ ì¶©ëŒ ë°©ì§€)
                            await new Promise(resolve => setTimeout(resolve, 300));
                        }

                        // ì„ íƒëœ ì§€ì—­ ì •ë³´ ì €ì¥
                        if (targetRegion) {
                            sessionStorage.setItem('selectedTargetRegion', targetRegion);
                        }

                        console.log(`ë‚ ì§œ ${dateString} ì˜ˆì•½ ë¡œë“œ ì¤‘, ì§€ì—­: ${targetRegion}`);

                        // í˜„ì¬ ì„ íƒëœ ë‚ ì§œ ì €ì¥
                        currentSelectedDate = dateString;

                        // ì˜ˆì•½ ì •ë³´ ë¡œë“œ
                        await loadDateBookings(dateString);

                        // ëª¨ë‹¬ í‘œì‹œ
                        showDateBookingsModal();

                        // ëª¨ë‹¬ ë²„íŠ¼ ì„¤ì •
                        setupModalButtons(dateString);

                    } catch (error) {
                        console.error('ë‚ ì§œ í´ë¦­ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                        showAlert('ì˜ˆì•½ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                });

                return clonedElement; // ìˆ˜ì •ëœ ìš”ì†Œ ë°˜í™˜
            }

            // ì¼ë°˜ ì‚¬ìš©ììš© ìº˜ë¦°ë” ë Œë”ë§
            function renderCalendar(date) {
                const calendar = document.getElementById('calendar');
                const currentMonthElement = document.getElementById('currentMonth');

                const year = date.getFullYear();
                const month = date.getMonth();

                currentMonthElement.textContent = `${year}ë…„ ${month + 1}ì›”`;

                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);

                calendar.innerHTML = '';

                // ì²«ì§¸ ë‚ ì˜ ìš”ì¼ë§Œí¼ ë¹ˆ ì¹¸ ì¶”ê°€
                for (let i = 0; i < firstDay.getDay(); i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'h-12 rounded-lg';
                    calendar.appendChild(emptyDay);
                }

                // ë‚ ì§œ ì±„ìš°ê¸°
                for (let currentDay = 1; currentDay <= lastDay.getDate(); currentDay++) {
                    const dayElement = document.createElement('div');
                    const selectedDateObj = new Date(year, month, currentDay);
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);

                    const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(currentDay).padStart(2, '0')}`;
                    const dateStatus = bookingStatus[dateString];

                    if (selectedDateObj < today) {
                        dayElement.className = 'calendar-day past h-12 flex items-center justify-center';
                        dayElement.title = 'ì§€ë‚œ ë‚ ì§œ';
                    } else if (dateStatus?.isFull) {
                        dayElement.className = 'calendar-day full h-12 flex items-center justify-center';
                        dayElement.title = 'ì˜ˆì•½ ë§ˆê° (2ê±´ ëª¨ë‘ ì˜ˆì•½ë¨)';
                    } else if (dateStatus?.isPartiallyBlocked && dateStatus?.bookingCount >= 1) {
                        dayElement.className = 'calendar-day full h-12 flex items-center justify-center';
                        dayElement.title = 'ì˜ˆì•½ ë§ˆê° (ë¶€ë¶„ ë§ˆê° + ì˜ˆì•½ 1ê±´)';
                    } else if (dateStatus?.isFullyBlocked) {
                        dayElement.className = 'calendar-day blocked h-12 flex items-center justify-center';
                        dayElement.title = 'ê´€ë¦¬ì ì „ì²´ ë§ˆê°';
                    } else if (dateStatus?.isPartiallyBlocked) {
                        // ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œì—ì„œëŠ” ë…¸ë€ìƒ‰(1ê°œë§ˆê°)ìœ¼ë¡œ í‘œì‹œ
                        dayElement.className = 'calendar-day booked h-12 flex items-center justify-center cursor-pointer';
                        dayElement.title = 'ë¶€ë¶„ ë§ˆê° (1ê°œë§Œ ì˜ˆì•½ ê°€ëŠ¥)';
                        addDateClickHandler(dayElement, year, month, currentDay);
                    } else if (dateStatus?.hasBooking) {
                        dayElement.className = 'calendar-day booked h-12 flex items-center justify-center cursor-pointer';
                        dayElement.title = `${dateStatus.bookingCount}ê°œ ì˜ˆì•½ë¨`;
                        addDateClickHandler(dayElement, year, month, currentDay);
                    } else {
                        dayElement.className = 'calendar-day h-12 flex items-center justify-center cursor-pointer rounded-lg hover:bg-blue-100 transition-colors text-gray-700';
                        dayElement.title = 'ì˜ˆì•½ ê°€ëŠ¥';
                        addDateClickHandler(dayElement, year, month, currentDay);
                    }

                    dayElement.textContent = currentDay;

                    if (
                        !dateStatus?.isFullyBlocked &&
                        currentDay === today.getDate() &&
                        date.getMonth() === today.getMonth() &&
                        date.getFullYear() === today.getFullYear()
                    ) {
                        dayElement.classList.add('font-bold');
                    }

                    calendar.appendChild(dayElement);
                }
            }

            // ê´€ë¦¬ììš© ìº˜ë¦°ë” ë Œë”ë§
            function renderAdminCalendar(date) {
                // ì…ë ¥ê°’ ê²€ì¦
                if (!date || !(date instanceof Date)) {
                    console.error('ìœ íš¨í•˜ì§€ ì•Šì€ ë‚ ì§œì…ë‹ˆë‹¤');
                    return;
                }

                const adminCalendar = document.getElementById('adminCalendar');
                if (!adminCalendar) {
                    console.error('adminCalendar ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }

                const adminCurrentMonthElement = document.getElementById('adminCurrentMonth');

                // ê´€ë¦¬ì ìœ í˜•ê³¼ ì„ íƒëœ ì§€ì—­ í™•ì¸
                const adminRegion = sessionStorage.getItem('region');
                let targetRegion = adminRegion;

                if (adminRegion === 'all') {
                    const regionFilter = document.getElementById('regionFilter');
                    if (regionFilter) {
                        targetRegion = regionFilter.value;
                    }
                }

                console.log('[renderAdminCalendar] ì§€ì—­:', targetRegion, 'ê´€ë¦¬ì ìœ í˜•:', adminRegion === 'all' ? 'ì „ì²´ê´€ë¦¬ì' : 'ì§€ì—­ê´€ë¦¬ì');

                const year = date.getFullYear();
                const month = date.getMonth();
                const today = new Date();
                today.setHours(0, 0, 0, 0);

                adminCurrentMonthElement.textContent = `${year}ë…„ ${month + 1}ì›”`;

                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);

                // ë‹¬ë ¥ ì´ˆê¸°í™”
                adminCalendar.innerHTML = '';

                // ë¹ˆ ë‚ ì§œ ì¹¸ ì¶”ê°€
                for (let i = 0; i < firstDay.getDay(); i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'h-12 rounded-lg';
                    adminCalendar.appendChild(emptyDay);
                }

                // ë‚ ì§œ ì¹¸ ì¶”ê°€
                for (let currentDay = 1; currentDay <= lastDay.getDate(); currentDay++) {
                    const dayElement = document.createElement('div');
                    const selectedDateObj = new Date(year, month, currentDay);
                    const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(currentDay).padStart(2, '0')}`;

                    // ë‚ ì§œ ì‹ë³„ìš© ë°ì´í„° ì†ì„± ì¶”ê°€
                    dayElement.setAttribute('data-date', dateString);

                    // ë””ë²„ê¹…: í•´ë‹¹ ë‚ ì§œì˜ ì˜ˆì•½ ìƒíƒœ ì¶œë ¥
                    if (bookingStatus && bookingStatus[dateString]) {
                        console.log(`ë‚ ì§œ ${dateString} ì˜ˆì•½ ìƒíƒœ:`, bookingStatus[dateString]);
                    }

                    const dateStatus = bookingStatus ? bookingStatus[dateString] : null;
                    const baseClass = 'calendar-day h-12 flex items-center justify-center relative';

                    // ë‚ ì§œ ìƒíƒœì— ë”°ë¥¸ í´ë˜ìŠ¤ ì„¤ì •
                    if (selectedDateObj < today) {
                        dayElement.className = `${baseClass} past`;
                        dayElement.title = 'ì§€ë‚œ ë‚ ì§œ';
                    } else if (dateStatus?.isFull) {
                        dayElement.className = `${baseClass} full cursor-pointer`;
                        dayElement.title = 'ì˜ˆì•½ ë§ˆê° (2ê±´ ëª¨ë‘ ì˜ˆì•½ë¨)';
                    } else if (dateStatus?.isPartiallyBlocked && dateStatus?.bookingCount >= 1) {
                        dayElement.className = `${baseClass} full cursor-pointer`;
                        dayElement.title = 'ì˜ˆì•½ ë§ˆê° (ë¶€ë¶„ ë§ˆê° + ì˜ˆì•½ 1ê±´)';
                    } else if (dateStatus?.isFullyBlocked) {
                        dayElement.className = `${baseClass} blocked cursor-pointer`;
                        dayElement.title = 'ê´€ë¦¬ì ì „ì²´ ë§ˆê°';
                    } else if (dateStatus?.isPartiallyBlocked) {
                        dayElement.className = `${baseClass} partially-blocked cursor-pointer`;
                        dayElement.title = 'ë¶€ë¶„ ë§ˆê° (1ê°œ ì˜ˆì•½ë§Œ ê°€ëŠ¥)';
                        dayElement.style.backgroundColor = '#F97316';
                    } else if (dateStatus?.hasBooking) {
                        dayElement.className = `${baseClass} booked cursor-pointer`;
                        dayElement.title = `${dateStatus.bookingCount}ê°œ ì˜ˆì•½ë¨`;
                    } else {
                        dayElement.className = `${baseClass} cursor-pointer rounded-lg hover:bg-blue-100 transition-colors text-gray-700`;
                        dayElement.title = 'í´ë¦­í•˜ì—¬ ë§ˆê° ì„¤ì •';
                    }

                    // ë‚ ì§œ ìš”ì†Œ ìœ„ì¹˜ ì„¤ì • ê°•ì œí™”
                    dayElement.style.position = 'relative';
                    dayElement.style.overflow = 'visible';

                    // ì˜ˆì•½ ìˆ˜ ë°°ì§€ ì¶”ê°€ (ì¤‘ìš”: bookingCount ê°’ì´ ìˆëŠ”ì§€ í™•ì¸)
                    if (dateStatus?.bookingCount > 0) {
                        addBookingCountBadge(dayElement, dateStatus);
                    }

                    // ë‚ ì§œ í…ìŠ¤íŠ¸ ì¶”ê°€
                    const dateText = document.createElement('span');
                    dateText.textContent = currentDay;
                    dateText.className = 'z-10';
                    // ë°°ì§€ê°€ ì¶”ê°€ëœ í›„ì— ë‚ ì§œ í…ìŠ¤íŠ¸ ì¶”ê°€
                    if (dayElement.firstChild) {
                        dayElement.insertBefore(dateText, dayElement.firstChild);
                    } else {
                        dayElement.appendChild(dateText);
                    }

                    // ë‚ ì§œ í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                    if (selectedDateObj >= today) {
                        // ìƒˆë¡œìš´ ë°©ì‹: ë§ˆê° ëª¨ë‹¬ ì—´ê¸°
                        dayElement.addEventListener('click', async function (e) {
                            e.preventDefault();
                            e.stopPropagation();

                            console.log(`ë‚ ì§œ í´ë¦­: ${dateString}, ì§€ì—­: ${targetRegion}`);
                            currentSelectedDate = dateString;

                            try {
                                // ë°ì´í„° ë¡œë“œ
                                await loadDateBookings(dateString);

                                // ì ì‹œ í›„ ëª¨ë‹¬ í‘œì‹œ (ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•œ ì‘ì€ ì§€ì—°)
                                setTimeout(() => {
                                    showDateBookingsModal();
                                    setupModalButtons(dateString);
                                }, 50);
                            } catch (error) {
                                console.error('ë‚ ì§œ í´ë¦­ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                                showAlert('ì˜ˆì•½ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                            }
                        });
                    }

                    // ì˜¤ëŠ˜ ë‚ ì§œ ê°•ì¡°
                    if (
                        currentDay === today.getDate() &&
                        month === today.getMonth() &&
                        year === today.getFullYear()
                    ) {
                        dayElement.classList.add('font-bold');
                    }

                    adminCalendar.appendChild(dayElement);
                }

                console.log('[renderAdminCalendar] ìº˜ë¦°ë” ë Œë”ë§ ì™„ë£Œ');
            }

            // ë‚ ì§œ ìƒíƒœì— ë”°ë¥¸ ì„¤ì • ë°˜í™˜
            function getDayConfiguration(dateObj, dateStatus, baseClass) {
                if (dateObj < new Date().setHours(0, 0, 0, 0)) {
                    return {
                        className: `${baseClass} past`,
                        title: 'ì§€ë‚œ ë‚ ì§œ'
                    };
                }

                // ì˜ˆì•½ ë§ˆê° ìƒíƒœë¥¼ ê°€ì¥ ë¨¼ì € ì²´í¬
                if (dateStatus?.isFull) {
                    return {
                        className: `${baseClass} full cursor-pointer`,
                        title: 'ì˜ˆì•½ ë§ˆê°'
                    };
                }

                if (dateStatus?.isPartiallyBlocked) {
                    // ë¶€ë¶„ ë§ˆê°ì¸ ê²½ìš°
                    if (dateStatus.bookingCount >= 1) {
                        return {
                            className: `${baseClass} full cursor-pointer`,
                            title: 'ì˜ˆì•½ ë§ˆê°'
                        };
                    } else {
                        return {
                            className: `${baseClass} partially-blocked cursor-pointer`,
                            title: 'ë¶€ë¶„ ë§ˆê° (1ê°œ ì˜ˆì•½ë§Œ ê°€ëŠ¥)',
                            backgroundColor: '#F97316'
                        };
                    }
                }

                // ê´€ë¦¬ì ì „ì²´ ë§ˆê°ì„ ë§ˆì§€ë§‰ì— ì²´í¬
                if (dateStatus?.isFullyBlocked) {
                    return {
                        className: `${baseClass} blocked cursor-pointer`,
                        title: 'ì „ì²´ ë§ˆê° (í´ë¦­í•˜ì—¬ í•´ì œ)'
                    };
                }

                if (dateStatus?.hasBooking) {
                    return {
                        className: `${baseClass} booked cursor-pointer`,
                        title: `${dateStatus.bookingCount}ê°œ ì˜ˆì•½ë¨`
                    };
                }

                return {
                    className: `${baseClass} cursor-pointer rounded-lg hover:bg-blue-100 transition-colors text-gray-700`,
                    title: 'í´ë¦­í•˜ì—¬ ë§ˆê° ì„¤ì •'
                };
            }

            // ëª¨ë‹¬ í‘œì‹œ í•¨ìˆ˜ ì •ì˜
            function showDateBookingsModal() {
                try {
                    console.log('ëª¨ë‹¬ í‘œì‹œ ì‹œì‘');
                    const modal = document.getElementById('dateBookingsModal');
                    if (!modal) {
                        console.error('ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                        return;
                    }

                    const calendarContainer = document.getElementById('adminCalendar')?.parentElement;
                    if (calendarContainer) {
                        calendarContainer.classList.add('modal-open');
                    }

                    // ëª…ì‹œì ì¸ ìŠ¤íƒ€ì¼ ì„¤ì •ìœ¼ë¡œ ëª¨ë‹¬ í‘œì‹œ ë³´ì¥
                    modal.style.display = 'flex';

                    // CSS íŠ¸ëœì§€ì…˜ì„ ìœ„í•œ ì§€ì—°ëœ í´ë˜ìŠ¤ ì¶”ê°€
                    setTimeout(() => {
                        modal.classList.add('show');
                    }, 10);

                    // ë°°ê²½ ìŠ¤í¬ë¡¤ ë°©ì§€
                    document.body.style.overflow = 'hidden';

                    console.log('ëª¨ë‹¬ í‘œì‹œ ì™„ë£Œ');
                } catch (error) {
                    console.error('ëª¨ë‹¬ í‘œì‹œ ì˜¤ë¥˜:', error);
                }
            }

            // ëª¨ë‹¬ ë²„íŠ¼ ì„¤ì •
            function setupModalButtons(dateString) {
                // ì „ì²´ ê´€ë¦¬ìê°€ ì„ íƒí•œ ì§€ì—­ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const adminRegion = sessionStorage.getItem('region');
                let targetRegion = adminRegion;

                if (adminRegion === 'all') {
                    const regionFilter = document.getElementById('regionFilter');
                    if (regionFilter) {
                        targetRegion = regionFilter.value;
                    }
                }

                console.log(`Setting up modal buttons for date: ${dateString}, region: ${targetRegion}`);

                document.getElementById('partialBlockDateBtn').onclick = async () => {
                    if (confirm('ì´ ë‚ ì§œë¥¼ ë¶€ë¶„ ë§ˆê° ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (1ê°œ ì˜ˆì•½ë§Œ ê°€ëŠ¥)')) {
                        await blockDate(dateString, 'partial');
                        closeDateBookingsModal();
                    }
                };

                document.getElementById('fullBlockDateBtn').onclick = async () => {
                    if (confirm('ì´ ë‚ ì§œë¥¼ ì „ì²´ ë§ˆê° ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        await blockDate(dateString, 'full');
                        closeDateBookingsModal();
                    }
                };

                document.getElementById('unblockDateBtn').onclick = async () => {
                    if (confirm('ë§ˆê°ì„ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        await unblockDate(dateString);
                        closeDateBookingsModal();
                    }
                };
            }

            // ì˜ˆì•½ ìˆ˜ ë°°ì§€ ì¶”ê°€
            function addBookingCountBadge(dayElement, dateStatus) {
                if (!dateStatus?.bookingCount || dateStatus.bookingCount <= 0) return;

                const countBadge = document.createElement('div');
                // ë±ƒì§€ ê°€ì‹œì„± ê°œì„ 
                countBadge.className = 'absolute top-1 right-1 px-1.5 py-0.5 rounded-full text-xs font-bold bg-white shadow-md z-30';

                if (dateStatus.isPartiallyBlocked) {
                    countBadge.textContent = `${dateStatus.bookingCount}/1`;
                    // ë” ëª…í™•í•œ ìƒ‰ìƒ ì‚¬ìš©
                    countBadge.style.backgroundColor = '#FEF3C7';
                    countBadge.style.color = '#92400E';

                    // ë¶€ë¶„ ë§ˆê° + ì˜ˆì•½ ìˆìŒ = ë§ˆê°
                    if (dateStatus.bookingCount >= 1) {
                        countBadge.style.backgroundColor = '#FEE2E2';
                        countBadge.style.color = '#B91C1C';
                    }
                } else if (dateStatus.bookingCount >= 2) {
                    // ì˜ˆì•½ ê½‰ ì°¬ ê²½ìš°
                    countBadge.textContent = `${dateStatus.bookingCount}/2`;
                    countBadge.style.backgroundColor = '#FEE2E2';
                    countBadge.style.color = '#B91C1C';
                } else {
                    // ì¼ë°˜ ì˜ˆì•½
                    countBadge.textContent = `${dateStatus.bookingCount}/2`;
                    countBadge.style.backgroundColor = '#DBEAFE';
                    countBadge.style.color = '#1E40AF';
                }

                dayElement.appendChild(countBadge);
                return countBadge;
            }

            // ì˜¤ëŠ˜ ë‚ ì§œ í™•ì¸
            function isToday(currentDay, date, today) {
                return (
                    currentDay === today.getDate() &&
                    date.getMonth() === today.getMonth() &&
                    date.getFullYear() === today.getFullYear()
                );
            }



            // ì‹œê°„ ì„ íƒ ì´ˆê¸°í™”
            function initializeTimeSelects() {
                const startTimeSelect = document.getElementById('startTime');
                const endTimeSelect = document.getElementById('endTime');

                function generateTimeOptions() {
                    const times = [];
                    for (let hour = 9; hour < 18; hour++) {
                        for (let minute = 0; minute < 60; minute += 10) {
                            const timeString = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                            times.push(timeString);
                        }
                    }
                    return times;
                }

                const timeOptions = generateTimeOptions();

                startTimeSelect.innerHTML = '<option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>' +
                    timeOptions.map(time => `<option value="${time}">${time}</option>`).join('');

                startTimeSelect.addEventListener('change', function () {
                    const selectedIndex = timeOptions.indexOf(this.value);
                    endTimeSelect.innerHTML = '<option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>' +
                        timeOptions.slice(selectedIndex + 1).map(time => `<option value="${time}">${time}</option>`).join('');
                });
            }

            // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” í•¨ìˆ˜
            async function initializeAdminDashboard(region, username) {
                try {
                    // ì˜ˆì•½ ì„¤ì • ë¡œë“œ
                    await loadAdminBookingSettings();

                    // ê´€ë¦¬ì ìº˜ë¦°ë” ì´ˆê¸°í™”
                    initializeAdminCalendar();

                    // í†µê³„ ë¡œë“œ
                    await loadRegionStatistics();

                    // ì˜ˆì•½ ìƒíƒœ ì—…ë°ì´íŠ¸
                    await initializeAdminCalendar();

                    await Promise.all([
                        loadPendingUsers(),
                        loadPendingBookings(),
                        loadAllUsers()
                    ]);

                    // ì¶”ê°€: ì‚¬ìš©ì ê²€ìƒ‰ ê¸°ëŠ¥ ì´ˆê¸°í™”
                    initializeUserSearch();

                    // ì˜ˆì•½ ìƒíƒœ í† ê¸€ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                    const toggleButton = document.getElementById('toggleBookingStatus');
                    if (toggleButton) {
                        toggleButton.removeEventListener('click', toggleBookingStatus);
                        toggleButton.addEventListener('click', toggleBookingStatus);
                    }

                    // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ëª¨ë‹¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
                    document.getElementById('closeChangePassword').addEventListener('click', closeChangePasswordModal);

                } catch (error) {
                    console.error('Admin dashboard initialization error:', error);
                    showAlert('ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            }

            // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ê´€ë ¨ í•¨ìˆ˜ë“¤
            function showChangePasswordModal() {
                openModal('changePasswordModal');
            }

            function closeChangePasswordModal() {
                closeModal('changePasswordModal');
                document.getElementById('changePasswordForm').reset();
            }

            // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í¼ ì œì¶œ
            document.getElementById('changePasswordForm').addEventListener('submit', async function (e) {
                e.preventDefault();

                try {
                    const currentPassword = document.getElementById('currentPassword').value;
                    const newPassword = document.getElementById('newPassword').value;
                    const confirmPassword = document.getElementById('confirmPassword').value;

                    // ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ í™•ì¸
                    if (newPassword !== confirmPassword) {
                        showAlert('ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                        return;
                    }

                    // ë¹„ë°€ë²ˆí˜¸ ë³µì¡ë„ ê²€ì¦
                    if (!/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(newPassword)) {
                        showAlert('ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸ê³¼ ìˆ«ìë¥¼ í¬í•¨í•˜ì—¬ 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error');
                        return;
                    }

                    showLoading();

                    const response = await apiRequest('/api/admin/change-password', {
                        method: 'PUT',
                        body: JSON.stringify({
                            currentPassword,
                            newPassword
                        })
                    });

                    if (response.success) {
                        showAlert('ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                        closeChangePasswordModal();
                    }
                } catch (error) {
                    console.error('Password change error:', error);
                    showAlert(error.message || 'ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            });

            // ë‚ ì§œ í¬ë§· í•¨ìˆ˜
            function formatDate(dateStr) {
                const date = new Date(dateStr);
                return `${date.getFullYear()}ë…„ ${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`;
            }

            // ì—‘ì…€ ë°ì´í„° ìƒì„± í•¨ìˆ˜
            async function generateExcelData(year, month) {
                try {
                    const response = await apiRequest(`/api/admin/bookings/month/${year}/${month}`);
                    if (!response.success) {
                        throw new Error('ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨');
                    }

                    const bookings = response.data;
                    const ws = XLSX.utils.aoa_to_sheet([
                        ['ë‚ ì§œ', 'ë‹¨ì²´ëª…', 'ì‹œê°„', 'ì¥ì†Œ'] // í—¤ë” í–‰
                    ]);

                    const data = Object.entries(bookings).flatMap(([date, dayBookings]) =>
                        dayBookings.map(booking => [
                            formatDate(date),
                            booking.group_name,
                            `${booking.start_time} - ${booking.end_time}`,
                            booking.place
                        ])
                    );

                    XLSX.utils.sheet_add_aoa(ws, data, { origin: -1 });

                    // ì—´ ë„ˆë¹„ ìë™ ì¡°ì •
                    const wscols = [
                        { wch: 15 }, // ë‚ ì§œ
                        { wch: 20 }, // ë‹¨ì²´ëª…
                        { wch: 15 }, // ì‹œê°„
                        { wch: 20 }  // ì¥ì†Œ
                    ];
                    ws['!cols'] = wscols;

                    return ws;
                } catch (error) {
                    console.error('Excel data generation error:', error);
                    throw error;
                }
            }

            // ì—¬ê¸°ì— downloadApplication í•¨ìˆ˜ ì¶”ê°€
            function downloadApplication() {
                const fileUrl = 'https://raw.githubusercontent.com/sportsbox031/sports/main/ìŠ¤í¬ì¸ ë°•ìŠ¤%20ìˆ˜ìš”ì²˜ë“±ë¡%20ì‹ ì²­ì„œ.hwp';

                window.open(fileUrl, '_blank');
                showAlert('ë‹¤ìš´ë¡œë“œê°€ ì‹œì‘ë©ë‹ˆë‹¤. íŒŒì¼ì´ ìë™ìœ¼ë¡œ ì—´ë¦¬ì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'info');
            }

            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            document.addEventListener('DOMContentLoaded', async function () {
                // ì‹œêµ° ë¶„ë¥˜ ë°ì´í„°
                const REGION_MAPPING = {
                    south: [
                        'ê³¼ì²œì‹œ', 'ê´‘ëª…ì‹œ', 'ê´‘ì£¼ì‹œ', 'êµ°í¬ì‹œ', 'ê¹€í¬ì‹œ', 'ë¶€ì²œì‹œ', 'ì„±ë‚¨ì‹œ',
                        'ìˆ˜ì›ì‹œ', 'ì‹œí¥ì‹œ', 'ì•ˆì‚°ì‹œ', 'ì•ˆì„±ì‹œ', 'ì•ˆì–‘ì‹œ', 'ì–‘í‰êµ°', 'ì—¬ì£¼ì‹œ', 'ì˜¤ì‚°ì‹œ',
                        'ìš©ì¸ì‹œ', 'ì˜ì™•ì‹œ', 'ì´ì²œì‹œ', 'í‰íƒì‹œ', 'í•˜ë‚¨ì‹œ', 'í™”ì„±ì‹œ'
                    ],
                    north: [
                        'ê³ ì–‘ì‹œ', 'êµ¬ë¦¬ì‹œ', 'ë‚¨ì–‘ì£¼ì‹œ', 'ë™ë‘ì²œì‹œ', 'ì–‘ì£¼ì‹œ', 'ì˜ì •ë¶€ì‹œ',
                        'íŒŒì£¼ì‹œ', 'í¬ì²œì‹œ', 'ê°€í‰êµ°', 'ì—°ì²œêµ°'
                    ]
                };

                // ê³µì§€ì‚¬í•­ ë¡œë“œ
                loadHomeNotices();
                checkAdminStatus();

                // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
                document.getElementById('noticeDetailModal').addEventListener('click', function (e) {
                    if (e.target === this) {
                        closeNoticeDetail();
                    }
                });

                // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
                document.addEventListener('keydown', function (e) {
                    if (e.key === 'Escape' && !document.getElementById('noticeDetailModal').classList.contains('hidden')) {
                        closeNoticeDetail();
                    }
                });

                // ëª¨ë‹¬ ê´€ë ¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    // ëª¨ë‹¬ ë‚´ë¶€ í´ë¦­ ì‹œ ì´ë²¤íŠ¸ ì „íŒŒ ë°©ì§€
                    const modalContent = modal.querySelector('.bg-white');
                    if (modalContent) {
                        modalContent.addEventListener('click', function (e) {
                            e.stopPropagation();
                        });
                    }
                });

                // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
                document.addEventListener('keydown', function (e) {
                    if (e.key === 'Escape') {
                        const visibleModal = document.querySelector('.modal.show');
                        if (visibleModal) {
                            if (visibleModal.id === 'noticeDetailModal') {
                                closeNoticeDetail();
                            } else if (visibleModal.id === 'signupModal') {
                                document.getElementById('closeSignup').click();
                            } else if (visibleModal.id === 'noticeWriteModal') {
                                closeNoticeWriteModal();
                            } else if (visibleModal.id === 'userProfileModal') {
                                closeUserProfileModal();
                            } else if (visibleModal.id === 'changePasswordModal') {
                                closeChangePasswordModal();
                            } else if (visibleModal.id === 'dateBookingsModal') {
                                closeDateBookingsModal();
                            } else {
                                // ì¼ë°˜ì ì¸ ëª¨ë‹¬ ë‹«ê¸°
                                visibleModal.classList.remove('show');
                                setTimeout(() => {
                                    visibleModal.style.display = 'none';
                                    document.body.style.overflow = '';
                                }, 300);
                            }
                        }
                    }
                });

                // ë¡œê·¸ì¸ ë²„íŠ¼ê³¼ ì˜ˆì•½ ë²„íŠ¼ì— ëª…ì‹œì ì¸ ì´ë²¤íŠ¸ ì¤‘ì§€ ì¶”ê°€
                document.querySelectorAll('button[onclick="showLoginScreen()"]').forEach(button => {
                    const originalOnclick = button.onclick;
                    button.onclick = function (e) {
                        e.stopPropagation(); // ì´ë²¤íŠ¸ ì „íŒŒ ì¤‘ì§€
                        if (originalOnclick) originalOnclick.call(this, e);
                    };
                });

                // ì—¬ê¸°ì— ì§€ì—­ í•„í„° ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                document.getElementById('regionFilter')?.addEventListener('change', async function (e) {
                    try {
                        const selectedRegion = e.target.value;
                        console.log(`[regionFilter] ì§€ì—­ ë³€ê²½ë¨: ${selectedRegion}`);

                        // ì˜ˆì•½ ì„¤ì • ìƒíƒœ ë¡œë“œ
                        const response = await apiRequest('/api/admin/booking-settings');
                        if (response.success) {
                            const settings = response.data;
                            const regionSettings = settings[selectedRegion];
                            updateBookingStatusUI(regionSettings?.is_active || false);
                        }

                        // ì„ íƒëœ ì§€ì—­ì— ëŒ€í•œ ìº˜ë¦°ë” ìƒíƒœ ì¦‰ì‹œ ìƒˆë¡œê³ ì¹¨ (ë””ë°”ìš´ìŠ¤ ì—†ì´ ì§ì ‘ í˜¸ì¶œ)
                        await refreshCalendarStatus(selectedRegion);

                        // ë‹¤ë¥¸ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
                        await Promise.all([
                            loadRegionStatistics(),
                            loadPendingBookings()
                        ]);
                    } catch (error) {
                        console.error('Region filter change error:', error);
                        showAlert('ì§€ì—­ ì„¤ì • ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                });

                // ì‹œêµ° ì„ íƒì— ë”°ë¥¸ ì§€ì—­ ìë™ ë¶„ë¥˜ í•¨ìˆ˜
                function determineRegion(city) {
                    if (REGION_MAPPING.south.includes(city)) return 'south';
                    if (REGION_MAPPING.north.includes(city)) return 'north';
                    return null;
                }

                // í™ˆí™”ë©´ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸
                document.querySelectorAll('nav a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', function (e) {
                        e.preventDefault();
                        const targetId = this.getAttribute('href').substring(1);
                        const targetElement = document.getElementById(targetId);
                        if (targetElement) {
                            const headerOffset = 80;
                            const elementPosition = targetElement.getBoundingClientRect().top;
                            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                            window.scrollTo({
                                top: offsetPosition,
                                behavior: 'smooth'
                            });
                        }
                    });
                });

                // ë¡œê·¸ì¸ í¼ ì œì¶œ
                document.getElementById('loginForm').addEventListener('submit', async function (e) {
                    e.preventDefault();
                    try {
                        showLoading();
                        const username = document.getElementById('username').value;
                        const password = document.getElementById('password').value;
                        await login(username, password);
                    } catch (error) {
                        console.error('Login submission error:', error);
                        showAlert('ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                    } finally {
                        hideLoading();
                    }
                });

                // íšŒì›ê°€ì… ëª¨ë‹¬ ì»¨íŠ¸ë¡¤
                document.getElementById('showSignup').addEventListener('click', function () {
                    document.getElementById('signupModal').classList.add('show');
                    initializeCitySelect(); // í•¨ìˆ˜ í˜¸ì¶œ ì¶”ê°€
                }); // ë‹«ëŠ” ê´„í˜¸ ì¶”ê°€

                document.getElementById('closeSignup').addEventListener('click', function () {
                    document.getElementById('signupModal').classList.remove('show');
                    document.getElementById('signupForm').reset();
                    document.getElementById('regionInfo').textContent = '';
                });

                // ì‹œêµ° ì„ íƒ ì´ë²¤íŠ¸
                document.getElementById('city')?.addEventListener('change', function () {
                    const city = this.value;
                    const regionInfo = document.getElementById('regionInfo');

                    // REGION_MAPPING ì •ì˜ (ë°±ì—”ë“œì™€ ë™ì¼í•˜ê²Œ)
                    const REGION_MAPPING = {
                        south: [
                            'ê³¼ì²œì‹œ', 'ê´‘ëª…ì‹œ', 'ê´‘ì£¼ì‹œ', 'êµ°í¬ì‹œ', 'ê¹€í¬ì‹œ', 'ë¶€ì²œì‹œ', 'ì„±ë‚¨ì‹œ',
                            'ìˆ˜ì›ì‹œ', 'ì‹œí¥ì‹œ', 'ì•ˆì‚°ì‹œ', 'ì•ˆì„±ì‹œ', 'ì•ˆì–‘ì‹œ', 'ì–‘í‰êµ°', 'ì—¬ì£¼ì‹œ', 'ì˜¤ì‚°ì‹œ',
                            'ìš©ì¸ì‹œ', 'ì˜ì™•ì‹œ', 'ì´ì²œì‹œ', 'í‰íƒì‹œ', 'í•˜ë‚¨ì‹œ', 'í™”ì„±ì‹œ'
                        ],
                        north: [
                            'ê³ ì–‘ì‹œ', 'êµ¬ë¦¬ì‹œ', 'ë‚¨ì–‘ì£¼ì‹œ', 'ë™ë‘ì²œì‹œ', 'ì–‘ì£¼ì‹œ', 'ì˜ì •ë¶€ì‹œ',
                            'íŒŒì£¼ì‹œ', 'í¬ì²œì‹œ', 'ê°€í‰êµ°', 'ì—°ì²œêµ°'
                        ]
                    };

                    // ì§€ì—­ ê²°ì • í•¨ìˆ˜
                    function determineRegion(city) {
                        if (REGION_MAPPING.south.includes(city)) return 'south';
                        if (REGION_MAPPING.north.includes(city)) return 'north';
                        return null;
                    }

                    const region = determineRegion(city);

                    if (region) {
                        regionInfo.textContent = `${region === 'south' ? 'ë‚¨ë¶€' : 'ë¶ë¶€'} ì§€ì—­`;
                        regionInfo.className = `text-sm font-medium mt-1 ${region === 'south' ? 'text-blue-600' : 'text-green-600'
                            }`;
                    } else {
                        regionInfo.textContent = '';
                    }
                });

                // íšŒì›ê°€ì… í¼ ì œì¶œ
                const signupForm = document.getElementById('signupForm');
                if (signupForm) {
                    console.log('íšŒì›ê°€ì… í¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì´ˆê¸°í™”');

                    // ê¸°ì¡´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì œê±°ë¥¼ ìœ„í•´ í¼ ë³µì œ
                    const newForm = signupForm.cloneNode(true);
                    signupForm.parentNode.replaceChild(newForm, signupForm);

                    // í¼ ì œì¶œ ì§„í–‰ ì¤‘ì¸ì§€ ì¶”ì í•˜ëŠ” í”Œë˜ê·¸
                    let isSubmitting = false;

                    // ìƒˆ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡
                    newForm.addEventListener('submit', async function (e) {
                        e.preventDefault();

                        // ì¤‘ë³µ ì œì¶œ ë°©ì§€
                        if (isSubmitting) {
                            console.log('ì´ë¯¸ í¼ ì œì¶œì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤');
                            return;
                        }

                        // ëª¨ë“  í•„ìˆ˜ í•„ë“œ ê°’ ê°€ì ¸ì˜¤ê¸°
                        const groupName = document.getElementById('groupName').value.trim();
                        const password = document.getElementById('signupPassword').value;
                        const manager = document.getElementById('manager').value.trim();
                        const city = document.getElementById('city').value;
                        const contact = document.getElementById('contact').value.trim();
                        const region = determineRegion(city);

                        console.log('íšŒì›ê°€ì… í¼ ë°ì´í„° ê²€ì¦ ì‹œì‘');

                        // ë‹¨ì²´ëª… ìœ íš¨ì„± ê²€ì‚¬
                        if (!groupName) {
                            showAlert('ë‹¨ì²´ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error', 3000);
                            document.getElementById('groupName').focus();
                            return;
                        }

                        if (groupName.length < 2) {
                            showAlert('ë‹¨ì²´ëª…ì€ 2ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error', 3000);
                            document.getElementById('groupName').focus();
                            return;
                        }

                        // ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬ ê°•í™”
                        if (!password) {
                            showAlert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error', 3000);
                            document.getElementById('signupPassword').focus();
                            return;
                        }

                        if (password.length < 6) {
                            showAlert('ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error', 3000);
                            document.getElementById('signupPassword').focus();
                            return;
                        }

                        // íŠ¹ìˆ˜ë¬¸ì, ìˆ«ì í¬í•¨ ê²€ì‚¬ ì¶”ê°€
                        if (!/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(password)) {
                            showAlert('ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸ê³¼ ìˆ«ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.', 'error', 3000);
                            document.getElementById('signupPassword').focus();
                            return;
                        }

                        // ë‹´ë‹¹ìëª… ìœ íš¨ì„± ê²€ì‚¬
                        if (!manager) {
                            showAlert('ë‹´ë‹¹ìëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error', 3000);
                            document.getElementById('manager').focus();
                            return;
                        }

                        if (manager.length < 2) {
                            showAlert('ë‹´ë‹¹ìëª…ì€ 2ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error', 3000);
                            document.getElementById('manager').focus();
                            return;
                        }

                        // ì‹œ/êµ° ì„ íƒ ê²€ì‚¬
                        if (!city) {
                            showAlert('ì‹œ/êµ°ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error', 3000);
                            document.getElementById('city').focus();
                            return;
                        }

                        if (!region) {
                            showAlert('ì˜¬ë°”ë¥¸ ì‹œ/êµ°ì„ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error', 3000);
                            document.getElementById('city').focus();
                            return;
                        }

                        // ì—°ë½ì²˜ ìœ íš¨ì„± ê²€ì‚¬ ê°•í™”
                        if (!contact) {
                            showAlert('ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error', 3000);
                            document.getElementById('contact').focus();
                            return;
                        }

                        // ì—°ë½ì²˜ í˜•ì‹ ê²€ì‚¬ (ì§€ì—­ë²ˆí˜¸ ë˜ëŠ” íœ´ëŒ€í° ë²ˆí˜¸)
                        const digits = contact.replace(/\D/g, '');
                        if (digits.length < 9 || digits.length > 11) {
                            showAlert('ì˜¬ë°”ë¥¸ ì—°ë½ì²˜ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'error', 3000);
                            document.getElementById('contact').focus();
                            return;
                        }

                        // ì—°ë½ì²˜ í˜•ì‹ í†µì¼ (í•˜ì´í”ˆ ì¶”ê°€)
                        const formattedContact = formatContact(contact);

                        console.log('íšŒì›ê°€ì… í¼ ë°ì´í„° ê²€ì¦ ì™„ë£Œ');

                        try {
                            // ì œì¶œ ì‹œì‘ í”Œë˜ê·¸ ì„¤ì •
                            isSubmitting = true;

                            // í¼ ë²„íŠ¼ ë¹„í™œì„±í™”
                            const submitButton = this.querySelector('button[type="submit"]');
                            if (submitButton) {
                                submitButton.disabled = true;
                                submitButton.textContent = 'ì²˜ë¦¬ ì¤‘...';
                            }

                            // ë¡œë”© í‘œì‹œ
                            showLoading();

                            const formData = {
                                groupName: groupName,
                                password: password,
                                manager: manager,
                                contact: formattedContact,
                                city: city,
                                region: region
                            };

                            console.log('íšŒì›ê°€ì… API ìš”ì²­ ì‹œì‘:', {
                                ...formData,
                                password: '********' // ë¹„ë°€ë²ˆí˜¸ëŠ” ë¡œê·¸ì— í‘œì‹œí•˜ì§€ ì•ŠìŒ
                            });

                            // ì§ì ‘ API í˜¸ì¶œ (signup í•¨ìˆ˜ ëŒ€ì‹  apiRequest ì§ì ‘ ì‚¬ìš©)
                            const response = await apiRequest('/api/signup', {
                                method: 'POST',
                                body: JSON.stringify({
                                    group_name: formData.groupName,
                                    password: formData.password,
                                    manager: formData.manager,
                                    contact: formData.contact,
                                    city: formData.city
                                })
                            });

                            console.log('íšŒì›ê°€ì… API ì‘ë‹µ:', response);

                            if (response.success) {
                                showAlert('íšŒì›ê°€ì… ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ì ìŠ¹ì¸ì„ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.', 'success');
                                document.getElementById('signupModal').classList.remove('show');
                                newForm.reset();
                            } else {
                                throw new Error(response.message || 'íšŒì›ê°€ì… ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                            }
                        } catch (error) {
                            console.error('íšŒì›ê°€ì… ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                            showAlert(error.message || 'íšŒì›ê°€ì… ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 3000);
                        } finally {
                            // ë¡œë”© ìˆ¨ê¸°ê¸°
                            hideLoading();

                            // ì œì¶œ ì™„ë£Œ í”Œë˜ê·¸ ì„¤ì •
                            isSubmitting = false;

                            // ë²„íŠ¼ ì¬í™œì„±í™”
                            const submitButton = this.querySelector('button[type="submit"]');
                            if (submitButton) {
                                submitButton.disabled = false;
                                submitButton.textContent = 'ê°€ì…í•˜ê¸°';
                            }
                        }
                    });

                    console.log('íšŒì›ê°€ì… í¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì • ì™„ë£Œ');
                }


                // ì˜ˆì•½ í¼ ì œì¶œ
                document.getElementById('bookingForm').addEventListener('submit', function (e) {
                    e.preventDefault();
                    const selectedDateText = document.getElementById('selectedDate').value;
                    const dateParts = selectedDateText.match(/(\d+)ë…„ (\d+)ì›” (\d+)ì¼/);

                    if (!dateParts) {
                        showAlert('ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error', 3000);
                        return;
                    }

                    // í˜„ì¬ ì…ë ¥ê°’ ì €ì¥ (localStorageì—)
                    const startTime = document.getElementById('startTime').value;
                    const endTime = document.getElementById('endTime').value;
                    const people = document.getElementById('people').value;
                    const place = document.getElementById('place').value;

                    // ìœ íš¨í•œ ê°’ë§Œ ì €ì¥
                    if (startTime && endTime && people && place) {
                        localStorage.setItem('lastBookingStartTime', startTime);
                        localStorage.setItem('lastBookingEndTime', endTime);
                        localStorage.setItem('lastBookingPeople', people);
                        localStorage.setItem('lastBookingPlace', place);
                    }

                    const bookingData = {
                        date: `${dateParts[1]}-${String(dateParts[2]).padStart(2, '0')}-${String(dateParts[3]).padStart(2, '0')}`,
                        startTime: startTime,
                        endTime: endTime,
                        people: people,
                        place: place,
                        region: sessionStorage.getItem('region')
                    };

                    createBooking(bookingData);
                });

                // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼
                document.getElementById('logoutBtn')?.addEventListener('click', logout);
                document.getElementById('adminLogoutBtn')?.addEventListener('click', logout);

                // ë‚ ì§œë³„ ì˜ˆì•½ ëª¨ë‹¬ ì»¨íŠ¸ë¡¤
                document.getElementById('closeDateBookingsModal')?.addEventListener('click', closeDateBookingsModal);

                // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
                document.addEventListener('keydown', function (e) {
                    if (e.key === 'Escape') {
                        closeDateBookingsModal();
                        document.getElementById('signupModal').classList.remove('show');
                        document.getElementById('contactModal').classList.remove('show');
                    }
                });

                // í”„ë¡œí•„ ëª¨ë‹¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì´ˆê¸°í™”
                document.getElementById('closeUserProfile').addEventListener('click', closeUserProfileModal);

                // ì‹œê°„ ì„ íƒ ì´ˆê¸°í™”
                initializeTimeSelects();

                // ìë™ ë¡œê·¸ì¸ ì²´í¬
                const token = sessionStorage.getItem('token');
                const role = sessionStorage.getItem('role');

                if (token && role) {
                    try {
                        const isValid = await validateStoredToken();
                        if (isValid) {
                            showDashboard(role);
                        } else {
                            logout();
                            showAlert('ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.', 'info', 3000);
                        }
                    } catch (error) {
                        logout();
                        console.error('Auto login error:', error);
                    }
                }
            });

            // ë””ë²„ê·¸ ëª¨ë“œ ì„¤ì •
            if (DEBUG) {
                window.onerror = function (msg, url, lineNo, columnNo, error) {
                    console.error('Error: ' + msg + '\nURL: ' + url + '\nLine: ' + lineNo + '\nColumn: ' + columnNo + '\nError object: ' + JSON.stringify(error));
                    return false;
                };

                // ê°œë°œ ë„êµ¬ë¥¼ ìœ„í•œ ì „ì—­ ë³€ìˆ˜ ë…¸ì¶œ
                window.debug = {
                    showHomeScreen,
                    showLoginScreen,
                    showDashboard,
                    bookingStatus,
                    currentUser,
                    resetState: () => {
                        sessionStorage.clear();
                        location.reload();
                    }
                };
            }

            // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œ ìƒíƒœ ë³µì›
            window.addEventListener('pageshow', function (event) {
                if (event.persisted) {
                    // ë’¤ë¡œê°€ê¸°ë¡œ í˜ì´ì§€ ë³µì› ì‹œ
                    const token = sessionStorage.getItem('token');
                    const role = sessionStorage.getItem('role');

                    if (token && role) {
                        validateStoredToken().then(isValid => {
                            if (isValid) {
                                showDashboard(role);
                            } else {
                                logout();
                            }
                        });
                    } else {
                        showHomeScreen();
                    }
                }
            });

            // ë¸Œë¼ìš°ì € ë‹«ê¸° ì „ ì •ë¦¬
            window.addEventListener('beforeunload', function () {
                if (DEBUG) {
                    console.log('Page unloading, cleaning up...');
                }
            });

            // ë¬¸ì˜ì‚¬í•­ ê´€ë ¨ ì „ì—­ ë³€ìˆ˜
            let currentInquiryId = null;
            let inquiryData = [];
            let userInquiries = [];
            let adminInquiries = [];

            function convertLinksToHyperlinks(text) {
                if (!text) return text;

                // ê°œì„ ëœ URL íŒ¨í„´ ì •ê·œì‹ - ê³µë°±, <, > ë“±ì—ì„œ ëë‚˜ë„ë¡ ìˆ˜ì •
                const urlPattern = /(https?:\/\/[^\s<>]+|www\.[^\s<>]+)/g;

                return text.replace(urlPattern, function (url) {
                    // URL ëì˜ ë¶ˆí•„ìš”í•œ ë¬¸ì ì œê±° (ë§ˆì¹¨í‘œ, ì‰¼í‘œ, ê´„í˜¸ ë“±)
                    url = url.replace(/[.,;:!?)\]}>]+$/, '');

                    let href = url;
                    // wwwë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš° https:// ì¶”ê°€
                    if (url.startsWith('www.')) {
                        href = 'https://' + url;
                    }
                    return `<a href="${href}" target="_blank" rel="noopener noreferrer" style="color: #3B82F6; text-decoration: underline;">${url}</a>`;
                });
            }

            // ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ í‘œì‹œ í•¨ìˆ˜
            window.showInquiryPage = function () {
                console.log('ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ ì—´ê¸° ì‹œì‘');
                try {
                    // ë‹¤ë¥¸ í˜ì´ì§€ë“¤ ìˆ¨ê¸°ê¸°
                    const mainContainer = document.getElementById('mainContainer');
                    if (mainContainer) {
                        const homeScreen = mainContainer.querySelector('#homeScreen');
                        if (homeScreen) homeScreen.classList.add('hidden');
                    }

                    const loginSystem = document.getElementById('loginAndReservationSystem');
                    if (loginSystem) loginSystem.classList.add('hidden');

                    // ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ í‘œì‹œ - ê°•ë ¥í•œ ë°©ë²•ìœ¼ë¡œ
                    const inquiryPage = document.getElementById('inquiryPage');
                    if (inquiryPage) {
                        inquiryPage.classList.remove('hidden');
                        inquiryPage.style.display = 'block';
                        inquiryPage.style.visibility = 'visible';
                        inquiryPage.style.opacity = '1';

                        console.log('inquiryPage ìš”ì†Œ í‘œì‹œ ì²˜ë¦¬ ì™„ë£Œ');
                        console.log('inquiryPage ìŠ¤íƒ€ì¼:',
                            window.getComputedStyle(inquiryPage).display,
                            window.getComputedStyle(inquiryPage).visibility);
                    } else {
                        console.error('inquiryPage ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                        return; // ìš”ì†Œê°€ ì—†ìœ¼ë©´ ì—¬ê¸°ì„œ ì¢…ë£Œ
                    }

                    // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
                    const token = sessionStorage.getItem('token');
                    const username = sessionStorage.getItem('username');

                    // ë¡œê·¸ì¸ ë²„íŠ¼ê³¼ ë„¤ë¹„ê²Œì´ì…˜ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
                    const loginButton = document.getElementById('inquiryLoginButton');
                    const loggedInNav = document.getElementById('inquiryLoggedInNav');
                    const writeButtonContainer = document.getElementById('inquiryWriteButtonContainer');

                    if (token && username) {
                        // ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œ
                        if (loginButton) loginButton.classList.add('hidden');
                        if (loggedInNav) {
                            loggedInNav.classList.remove('hidden');
                            loggedInNav.innerHTML = `
                    <span class="text-gray-700 font-medium">${username}</span>
                    <button onclick="showDashboard('${sessionStorage.getItem('role')}')" 
                        class="bg-indigo-100 text-indigo-700 px-4 py-2 rounded-lg">
                        ëŒ€ì‹œë³´ë“œ
                    </button>
                    <button onclick="logout()" 
                        class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg">
                        ë¡œê·¸ì•„ì›ƒ
                    </button>
                `;
                        }
                        if (writeButtonContainer) writeButtonContainer.classList.remove('hidden');
                    } else {
                        // ë¹„ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œ
                        if (loginButton) loginButton.classList.remove('hidden');
                        if (loggedInNav) loggedInNav.classList.add('hidden');
                        if (writeButtonContainer) writeButtonContainer.classList.add('hidden');
                    }

                    // ë¬¸ì˜ì‚¬í•­ ëª©ë¡ ë¡œë“œ
                    loadInquiries();

                } catch (error) {
                    console.error('ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ í‘œì‹œ ì˜¤ë¥˜:', error);
                    console.error(error.stack); // ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ ì¶œë ¥
                    alert('ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');

                    // ì˜¤ë¥˜ ì‹œ í™ˆí™”ë©´ìœ¼ë¡œ ë³µê·€
                    showHomeScreen();
                }
            };

            // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ë¬¸ì˜ì‚¬í•­ í•¨ìˆ˜ ì„¤ì • í™•ì¸
            document.addEventListener('DOMContentLoaded', function () {
                console.log('DOMContentLoaded: showInquiryPage í•¨ìˆ˜ ì¡´ì¬ ì—¬ë¶€ =', typeof window.showInquiryPage === 'function');
            });

            // ë¬¸ì˜ì‚¬í•­ ëª©ë¡ ë¡œë“œ
            async function loadInquiries() {
                try {
                    showLoading();
                    console.log('API ìš”ì²­ ì‹œì‘: ë¬¸ì˜ì‚¬í•­ ëª©ë¡');

                    // ì»¤ìŠ¤í…€ API ìš”ì²­ í•¨ìˆ˜ ì‚¬ìš© (fetch ëŒ€ì‹ )
                    const data = await apiRequest('/api/public/inquiries');
                    console.log('API ì‘ë‹µ ìˆ˜ì‹ :', data);

                    if (data.success) {
                        inquiryData = data.data || [];
                        console.log(`ë¬¸ì˜ì‚¬í•­ ${inquiryData.length}ê°œ ë¡œë“œë¨`);
                        renderInquiryList();
                    } else {
                        // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
                        document.getElementById('inquiryList').innerHTML = `
                <tr>
                    <td colspan="6" class="px-6 py-10 text-center">
                        <div class="flex flex-col items-center">
                            <i class="fas fa-exclamation-circle text-red-500 text-4xl mb-4"></i>
                            <p class="text-lg font-medium text-red-500">ë¬¸ì˜ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</p>
                            <p class="text-gray-500 mt-2">${data.message || 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'}</p>
                            <button onclick="loadInquiries()" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                                ë‹¤ì‹œ ì‹œë„
                            </button>
                        </div>
                    </td>
                </tr>
            `;
                    }
                } catch (error) {
                    console.error('Inquiries loading error:', error);
                    // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
                    document.getElementById('inquiryList').innerHTML = `
            <tr>
                <td colspan="6" class="px-6 py-10 text-center">
                    <div class="flex flex-col items-center">
                        <i class="fas fa-exclamation-circle text-red-500 text-4xl mb-4"></i>
                        <p class="text-lg font-medium text-red-500">ë¬¸ì˜ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤</p>
                        <p class="text-gray-500 mt-2">${error.message || 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'}</p>
                        <button onclick="loadInquiries()" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                            ë‹¤ì‹œ ì‹œë„
                        </button>
                    </div>
                </td>
            </tr>
        `;
                } finally {
                    hideLoading();
                }
            }

            // ë¬¸ì˜ì‚¬í•­ ëª©ë¡ ë Œë”ë§
            function renderInquiryList() {
                const tbody = document.getElementById('inquiryList');
                if (!tbody) return;

                if (!inquiryData || inquiryData.length === 0) {
                    tbody.innerHTML = `
            <tr>
                <td colspan="6" class="px-6 py-10 text-center text-gray-500">
                    ë¬¸ì˜ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.
                </td>
            </tr>
        `;
                    return;
                }

                // í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ID
                const userId = parseInt(sessionStorage.getItem('userId')) || 0;
                const isAdmin = sessionStorage.getItem('role') === 'admin';

                tbody.innerHTML = inquiryData.map((inquiry, index) => {
                    // ë¹„ë°€ê¸€ ì ‘ê·¼ ê¶Œí•œ í™•ì¸
                    const canAccess = !inquiry.is_private || inquiry.user_id === userId || isAdmin;

                    return `
            <tr class="${canAccess ? 'cursor-pointer hover:bg-gray-50' : ''}" 
                ${canAccess ? `onclick="viewInquiry(${inquiry.id})"` : ''}>
                <td class="px-6 py-4 whitespace-nowrap">${inquiry.id}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                        ${getCategoryClass(inquiry.category)}">
                        ${getCategoryText(inquiry.category)}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    ${inquiry.is_private ?
                            '<span class="w-2 h-2 bg-red-500 rounded-full inline-block mr-1"></span>' :
                            ''}
                    ${canAccess ?
                            inquiry.title :
                            '<span class="text-gray-400">ë¹„ë°€ê¸€ì…ë‹ˆë‹¤</span>'}
                    ${inquiry.has_answer ?
                            '<span class="ml-2 px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">ë‹µë³€ì™„ë£Œ</span>' :
                            ''}
                </td>
                <td class="px-6 py-4 whitespace-nowrap">${inquiry.author || 'ìµëª…'}</td>
                <td class="px-6 py-4 whitespace-nowrap">${formatDate(inquiry.created_at)}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                        ${inquiry.has_answer ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                        ${inquiry.has_answer ? 'ë‹µë³€ì™„ë£Œ' : 'ë‹µë³€ëŒ€ê¸°'}
                    </span>
                </td>
            </tr>
        `;
                }).join('');
            }

            // ë¬¸ì˜ì‚¬í•­ ìƒì„¸ ë³´ê¸°
            async function viewInquiry(inquiryId) {
                try {
                    showLoading();

                    // ë¬¸ì˜ì‚¬í•­ ìƒì„¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                    const response = await apiRequest(`/api/inquiries/${inquiryId}`);

                    if (response.success) {
                        const inquiry = response.data;
                        currentInquiryId = inquiry.id;

                        // ëª¨ë‹¬ì— ë°ì´í„° ì±„ìš°ê¸°
                        document.getElementById('detailInquiryTitle').textContent = inquiry.title;
                        document.getElementById('detailInquiryCategory').textContent = getCategoryText(inquiry.category);
                        document.getElementById('detailInquiryCategory').className = `px-2 py-1 rounded-full text-xs font-medium ${getCategoryClass(inquiry.category, true)}`;
                        document.getElementById('detailInquiryAuthor').textContent = inquiry.author || 'ìµëª…';
                        document.getElementById('detailInquiryDate').textContent = formatDate(inquiry.created_at);
                        document.getElementById('detailInquiryContent').textContent = inquiry.content;

                        // ì²¨ë¶€íŒŒì¼ í‘œì‹œ
                        const attachmentSection = document.getElementById('detailInquiryAttachment');
                        if (inquiry.attachment_url) {
                            document.getElementById('detailInquiryFileName').textContent = inquiry.attachment_name || 'ì²¨ë¶€íŒŒì¼';
                            document.getElementById('detailInquiryFileLink').href = inquiry.attachment_url;
                            attachmentSection.classList.remove('hidden');
                        } else {
                            attachmentSection.classList.add('hidden');
                        }

                        // ë‹µë³€ í‘œì‹œ
                        if (inquiry.answer) {
                            document.getElementById('inquiryNoAnswer').classList.add('hidden');
                            document.getElementById('inquiryAnswerContent').classList.remove('hidden');
                            document.getElementById('answerAuthor').textContent = inquiry.answer_author || 'ê´€ë¦¬ì';
                            document.getElementById('answerDate').textContent = formatDate(inquiry.answer_date);
                            document.getElementById('answerContent').textContent = inquiry.answer;
                        } else {
                            document.getElementById('inquiryNoAnswer').classList.remove('hidden');
                            document.getElementById('inquiryAnswerContent').classList.add('hidden');
                        }

                        // ê´€ë¦¬ìì¸ ê²½ìš° ë‹µë³€ ì…ë ¥ ì˜ì—­ í‘œì‹œ
                        const isAdmin = sessionStorage.getItem('role') === 'admin';
                        document.getElementById('adminAnswerSection').classList.toggle('hidden', !isAdmin || inquiry.has_answer);

                        // ì‘ì„±ìì¸ ê²½ìš° ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ í‘œì‹œ
                        const userId = parseInt(sessionStorage.getItem('userId')) || 0;
                        const isOwner = inquiry.user_id === userId;
                        document.getElementById('inquiryOwnerActions').classList.toggle('hidden', !isOwner);

                        // ëª¨ë‹¬ í‘œì‹œ
                        openModal('inquiryDetailModal');
                    } else {
                        showAlert('ë¬¸ì˜ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                } catch (error) {
                    console.error('Inquiry detail loading error:', error);
                    showAlert('ë¬¸ì˜ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            // ì¹´í…Œê³ ë¦¬ í´ë˜ìŠ¤ ë° í…ìŠ¤íŠ¸
            function getCategoryClass(category, isDetail = false) {
                const baseClass = isDetail ? '' : 'bg-opacity-50 ';
                switch (category) {
                    case 'program':
                        return baseClass + 'bg-blue-100 text-blue-800';
                    case 'reservation':
                        return baseClass + 'bg-green-100 text-green-800';
                    case 'other':
                        return baseClass + 'bg-purple-100 text-purple-800';
                    default:
                        return baseClass + 'bg-gray-100 text-gray-800';
                }
            }

            function getCategoryText(category) {
                switch (category) {
                    case 'program':
                        return 'í”„ë¡œê·¸ë¨ ë¬¸ì˜';
                    case 'reservation':
                        return 'ì˜ˆì•½ ë¬¸ì˜';
                    case 'other':
                        return 'ê¸°íƒ€ ë¬¸ì˜';
                    default:
                        return 'ê¸°íƒ€';
                }
            }

            // ë¬¸ì˜ì‚¬í•­ ì‘ì„± ëª¨ë‹¬ í‘œì‹œ
            function showInquiryWriteModal() {
                // ë¡œê·¸ì¸ í™•ì¸
                if (!sessionStorage.getItem('token')) {
                    showAlert('ë¬¸ì˜ì‚¬í•­ ì‘ì„±ì€ ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'error');
                    return;
                }

                // í¼ ì´ˆê¸°í™”
                document.getElementById('inquiryWriteForm').reset();
                document.getElementById('inquirySelectedFileName').textContent = 'ì„ íƒëœ íŒŒì¼ ì—†ìŒ';
                document.getElementById('inquirySelectedFileName').className = 'text-sm text-gray-600';

                // ëª¨ë‹¬ í‘œì‹œ
                openModal('inquiryWriteModal');
            }

            // ë¬¸ì˜ì‚¬í•­ ì‘ì„± ëª¨ë‹¬ ë‹«ê¸°
            function closeInquiryWriteModal() {
                console.log('ë¬¸ì˜ì‚¬í•­ ì‘ì„± ëª¨ë‹¬ ë‹«ê¸°');

                // í¼ ì´ˆê¸°í™”
                document.getElementById('inquiryWriteForm').reset();
                document.getElementById('inquirySelectedFileName').textContent = 'ì„ íƒëœ íŒŒì¼ ì—†ìŒ';
                document.getElementById('inquirySelectedFileName').className = 'text-sm text-gray-600';

                // ì œì¶œ í”Œë˜ê·¸ ì´ˆê¸°í™” (ì¤‘ìš”!)
                isSubmittingInquiry = false;

                // ëª¨ë‹¬ ë‹«ê¸°
                closeModal('inquiryWriteModal');
            }

            // ë¬¸ì˜ì‚¬í•­ ìƒì„¸ ëª¨ë‹¬ ë‹«ê¸°
            function closeInquiryDetailModal() {
                closeModal('inquiryDetailModal');
            }

            // ë¬¸ì˜ì‚¬í•­ ì‘ì„± í¼ ì œì¶œ
            function initializeInquirySystem() {
                console.log('ë¬¸ì˜ì‚¬í•­ ì‹œìŠ¤í…œ ì´ˆê¸°í™”');

                // ê¸°ì¡´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì œê±°ë¥¼ ìœ„í•´ í¼ ë³µì œ
                const inquiryForm = document.getElementById('inquiryWriteForm');
                if (inquiryForm) {
                    const newForm = inquiryForm.cloneNode(true);
                    inquiryForm.parentNode.replaceChild(newForm, inquiryForm);

                    // ìƒˆ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡
                    newForm.addEventListener('submit', async function (e) {
                        e.preventDefault();
                        e.stopPropagation(); // ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì§€

                        console.log('ë¬¸ì˜ì‚¬í•­ í¼ ì œì¶œ ì‹œì‘');

                        // ì´ì¤‘ ì œì¶œ ë°©ì§€
                        if (isSubmittingInquiry) {
                            console.log('ì´ë¯¸ ì œì¶œ ì¤‘ì…ë‹ˆë‹¤');
                            return;
                        }
                        isSubmittingInquiry = true;

                        // í¼ ë²„íŠ¼ ë¹„í™œì„±í™”
                        const submitButton = this.querySelector('button[type="submit"]');
                        if (submitButton) {
                            submitButton.disabled = true;
                            submitButton.textContent = 'ì²˜ë¦¬ ì¤‘...';
                        }

                        try {
                            showLoading();

                            const formData = new FormData();
                            formData.append('category', document.getElementById('writeInquiryCategory').value);
                            formData.append('title', document.getElementById('inquiryTitle').value);
                            formData.append('content', document.getElementById('inquiryContent').value);
                            formData.append('is_private', document.getElementById('inquiryIsPrivate').checked ? '1' : '0');

                            // ì²¨ë¶€íŒŒì¼ì´ ìˆëŠ” ê²½ìš° ì¶”ê°€
                            const fileInput = document.getElementById('inquiryFile');
                            if (fileInput.files.length > 0) {
                                formData.append('attachment', fileInput.files[0]);
                            }

                            console.log('API ìš”ì²­ ì „ì†¡');

                            // API ìš”ì²­
                            const response = await fetch(`${API_BASE_URL}/api/inquiries`, {
                                method: 'POST',
                                headers: {
                                    'Authorization': `Bearer ${sessionStorage.getItem('token')}`
                                },
                                body: formData
                            });

                            console.log('API ì‘ë‹µ ìˆ˜ì‹ ');

                            const data = await response.json();

                            if (data.success) {
                                showAlert('ë¬¸ì˜ì‚¬í•­ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                                closeInquiryWriteModal();

                                // í˜„ì¬ í˜ì´ì§€ì— ë”°ë¼ ìƒˆë¡œê³ ì¹¨
                                if (document.getElementById('inquiryPage').classList.contains('hidden')) {
                                    // ëŒ€ì‹œë³´ë“œì—ì„œ ì‘ì„±í•œ ê²½ìš°
                                    console.log('ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ ë¬¸ì˜ì‚¬í•­ ìƒˆë¡œê³ ì¹¨');
                                    loadUserInquiries();
                                } else {
                                    // ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ì—ì„œ ì‘ì„±í•œ ê²½ìš°
                                    console.log('ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨');
                                    loadInquiries();
                                }
                            } else {
                                throw new Error(data.message || 'ë¬¸ì˜ì‚¬í•­ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                            }
                        } catch (error) {
                            console.error('Inquiry creation error:', error);
                            showAlert(error.message || 'ë¬¸ì˜ì‚¬í•­ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                        } finally {
                            hideLoading();
                            isSubmittingInquiry = false; // í”Œë˜ê·¸ ì´ˆê¸°í™”

                            // ë²„íŠ¼ ìƒíƒœ ë³µì›
                            const submitButton = this.querySelector('button[type="submit"]');
                            if (submitButton) {
                                submitButton.disabled = false;
                                submitButton.textContent = 'ë¬¸ì˜í•˜ê¸°';
                            }

                            console.log('ë¬¸ì˜ì‚¬í•­ í¼ ì œì¶œ ì™„ë£Œ');
                        }
                    });

                    console.log('ë¬¸ì˜ì‚¬í•­ í¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¬ì„¤ì • ì™„ë£Œ');
                }
            }

            // íŒŒì¼ ì„ íƒ ì‹œ íŒŒì¼ëª… í‘œì‹œ
            document.getElementById('inquiryFile').addEventListener('change', function () {
                const fileNameSpan = document.getElementById('inquirySelectedFileName');
                if (this.files.length > 0) {
                    const fileName = this.files[0].name;
                    const fileSize = (this.files[0].size / 1024 / 1024).toFixed(2); // MB ë‹¨ìœ„
                    fileNameSpan.textContent = `${fileName} (${fileSize}MB)`;
                    fileNameSpan.classList.remove('text-gray-600');
                    fileNameSpan.classList.add('text-blue-600');
                } else {
                    fileNameSpan.textContent = 'ì„ íƒëœ íŒŒì¼ ì—†ìŒ';
                    fileNameSpan.classList.remove('text-blue-600');
                    fileNameSpan.classList.add('text-gray-600');
                }
            });

            // ê´€ë¦¬ì ë‹µë³€ í¼ ì œì¶œ
            document.getElementById('inquiryAnswerForm').addEventListener('submit', async function (e) {
                e.preventDefault();

                if (!currentInquiryId) {
                    showAlert('ë¬¸ì˜ì‚¬í•­ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                    return;
                }

                const answerContent = document.getElementById('adminAnswerContent').value.trim();
                if (!answerContent) {
                    showAlert('ë‹µë³€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                    return;
                }

                try {
                    showLoading();

                    const response = await apiRequest(`/api/admin/inquiries/${currentInquiryId}/answer`, {
                        method: 'POST',
                        body: JSON.stringify({ answer: answerContent })
                    });

                    if (response.success) {
                        showAlert('ë‹µë³€ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                        closeInquiryDetailModal();

                        // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì¸ ê²½ìš° ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                        if (!document.getElementById('adminDashboard').classList.contains('hidden')) {
                            loadAdminInquiries();
                        } else {
                            // ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ì¸ ê²½ìš°
                            loadInquiries();
                        }
                    } else {
                        throw new Error(response.message || 'ë‹µë³€ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('Inquiry answer error:', error);
                    showAlert(error.message || 'ë‹µë³€ ë“±ë¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            });

            // ë¬¸ì˜ì‚¬í•­ ì‚­ì œ
            async function deleteInquiry() {
                if (!currentInquiryId) {
                    showAlert('ë¬¸ì˜ì‚¬í•­ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                    return;
                }

                try {
                    showLoading();

                    const response = await apiRequest(`/api/inquiries/${currentInquiryId}`, {
                        method: 'DELETE'
                    });

                    if (response.success) {
                        showAlert('ë¬¸ì˜ì‚¬í•­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                        closeInquiryDetailModal();

                        // í˜„ì¬ í˜ì´ì§€ì— ë”°ë¼ ìƒˆë¡œê³ ì¹¨
                        if (!document.getElementById('userDashboard').classList.contains('hidden')) {
                            // ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œì¸ ê²½ìš°
                            loadUserInquiries();
                        } else if (!document.getElementById('adminDashboard').classList.contains('hidden')) {
                            // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì¸ ê²½ìš°
                            loadAdminInquiries();
                        } else {
                            // ë¬¸ì˜ì‚¬í•­ í˜ì´ì§€ì¸ ê²½ìš°
                            loadInquiries();
                        }
                    } else {
                        throw new Error(response.message || 'ë¬¸ì˜ì‚¬í•­ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('Inquiry deletion error:', error);
                    showAlert(error.message || 'ë¬¸ì˜ì‚¬í•­ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                } finally {
                    hideLoading();
                }
            }

            function deleteUserInquiry(inquiryId) {
                if (confirm('ì •ë§ ì´ ë¬¸ì˜ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    currentInquiryId = inquiryId; // í˜„ì¬ ì„ íƒëœ IDë¥¼ ì„¤ì •
                    deleteInquiry(); // ê¸°ì¡´ì˜ deleteInquiry í•¨ìˆ˜ í˜¸ì¶œ
                }
            }

            // ê´€ë¦¬ì ë¬¸ì˜ì‚¬í•­ ì‚­ì œ í•¨ìˆ˜
            function deleteAdminInquiry(inquiryId) {
                if (confirm('ì •ë§ ì´ ë¬¸ì˜ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    currentInquiryId = inquiryId; // í˜„ì¬ ì„ íƒëœ IDë¥¼ ì„¤ì •
                    deleteInquiry(); // ê¸°ì¡´ì˜ deleteInquiry í•¨ìˆ˜ í˜¸ì¶œ
                }
            }

            // ì‚¬ìš©ì ëŒ€ì‹œë³´ë“œ: ë‚´ ë¬¸ì˜ì‚¬í•­ ëª©ë¡ ë¡œë“œ
            async function loadUserInquiries() {
                try {
                    const response = await apiRequest('/api/user/inquiries');

                    if (response.success) {
                        userInquiries = response.data || [];

                        const tbody = document.getElementById('userInquiriesList');
                        if (!tbody) return;

                        if (userInquiries.length === 0) {
                            tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="px-6 py-10 text-center text-gray-500">
                            ì‘ì„±í•œ ë¬¸ì˜ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
                            return;
                        }

                        tbody.innerHTML = userInquiries.map(inquiry => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                            ${getCategoryClass(inquiry.category)}">
                            ${getCategoryText(inquiry.category)}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        ${inquiry.is_private ?
                                '<span class="w-2 h-2 bg-red-500 rounded-full inline-block mr-1"></span>' :
                                ''}
                        <a href="javascript:viewInquiry(${inquiry.id})" class="text-indigo-600 hover:text-indigo-900">
                            ${inquiry.title}
                        </a>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">${formatDate(inquiry.created_at)}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                            ${inquiry.has_answer ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                            ${inquiry.has_answer ? 'ë‹µë³€ì™„ë£Œ' : 'ë‹µë³€ëŒ€ê¸°'}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <button onclick="viewInquiry(${inquiry.id})" 
                            class="text-indigo-600 hover:text-indigo-900 mr-3">
                            ë³´ê¸°
                        </button>
                        <button onclick="deleteUserInquiry(${inquiry.id})" 
                            class="text-red-600 hover:text-red-900">
                            ì‚­ì œ
                        </button>
                    </td>
                </tr>
            `).join('');
                    } else {
                        showAlert('ë¬¸ì˜ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                    }
                } catch (error) {
                    console.error('User inquiries loading error:', error);
                    document.getElementById('userInquiriesList').innerHTML = `
            <tr>
                <td colspan="5" class="px-6 py-10 text-center text-gray-500">
                    ë¬¸ì˜ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
                </td>
            </tr>
        `;
                }
            }

            // ë¬¸ì˜ì‚¬í•­ ê´€ë¦¬ì í˜ì´ì§€ë„¤ì´ì…˜ ê´€ë ¨ ë³€ìˆ˜
            let currentInquiryPage = 1;
            const inquiryItemsPerPage = 10;

            // ë¬¸ì˜ì‚¬í•­ ëª©ë¡ ë Œë”ë§ í•¨ìˆ˜
            function renderAdminInquiries(inquiries, page = 1) {
                const tbody = document.getElementById('adminInquiriesList');
                const totalPages = Math.ceil(inquiries.length / inquiryItemsPerPage);
                const startIndex = (page - 1) * inquiryItemsPerPage;
                const endIndex = startIndex + inquiryItemsPerPage;
                const currentPageItems = inquiries.slice(startIndex, endIndex);

                // í˜„ì¬ í˜ì´ì§€ ì €ì¥
                currentInquiryPage = page;

                if (!tbody) return;

                if (currentPageItems.length === 0) {
                    tbody.innerHTML = `
            <tr>
                <td colspan="7" class="px-6 py-10 text-center text-gray-500">
                    ë“±ë¡ëœ ë¬¸ì˜ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.
                </td>
            </tr>
        `;
                    return;
                }

                tbody.innerHTML = currentPageItems.map((inquiry, index) => `
        <tr>
            <td class="px-6 py-4 whitespace-nowrap">${startIndex + index + 1}</td> <!-- ìˆœì°¨ì ì¸ ë²ˆí˜¸ ì‚¬ìš© -->
            <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                    ${getCategoryClass(inquiry.category)}">
                    ${getCategoryText(inquiry.category)}
                </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
                ${inquiry.is_private ?
                        '<span class="w-2 h-2 bg-red-500 rounded-full inline-block mr-1"></span>' :
                        ''}
                <a href="javascript:viewInquiry(${inquiry.id})" class="text-indigo-600 hover:text-indigo-900">
                    ${inquiry.title}
                </a>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">${inquiry.author || 'ìµëª…'}</td>
            <td class="px-6 py-4 whitespace-nowrap">${formatDate(inquiry.created_at)}</td>
            <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                    ${inquiry.has_answer ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                    ${inquiry.has_answer ? 'ë‹µë³€ì™„ë£Œ' : 'ë‹µë³€ëŒ€ê¸°'}
                </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
                <button onclick="viewInquiry(${inquiry.id})" 
                    class="text-indigo-600 hover:text-indigo-900 mr-3">
                    ${inquiry.has_answer ? 'ìƒì„¸ë³´ê¸°' : 'ë‹µë³€í•˜ê¸°'}
                </button>
                <button onclick="deleteAdminInquiry(${inquiry.id})" 
                    class="text-red-600 hover:text-red-900">
                    ì‚­ì œ
                </button>
            </td>
        </tr>
    `).join('');

                // í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§
                renderPagination(page, totalPages);
            }

            // í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§ í•¨ìˆ˜
            function renderPagination(currentPage, totalPages) {
                const paginationContainer = document.querySelector('#inquiryManagementSection .mt-6.flex.justify-center nav');
                if (!paginationContainer) return;

                let paginationHtml = `
        <button onclick="changePage(${Math.max(1, currentPage - 1)})" 
            class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50 ${currentPage === 1 ? 'opacity-50 cursor-not-allowed' : ''}">
            <i class="fas fa-chevron-left text-gray-500"></i>
        </button>
    `;

                // í‘œì‹œí•  í˜ì´ì§€ ë²”ìœ„ ê²°ì • (ìµœëŒ€ 5ê°œ)
                const startPage = Math.max(1, currentPage - 2);
                const endPage = Math.min(totalPages, startPage + 4);

                for (let i = startPage; i <= endPage; i++) {
                    paginationHtml += `
            <button onclick="changePage(${i})" 
                class="w-10 h-10 flex items-center justify-center rounded-lg ${i === currentPage ? 'bg-primary text-white' : 'border border-gray-300 hover:bg-gray-50'}">
                ${i}
            </button>
        `;
                }

                paginationHtml += `
        <button onclick="changePage(${Math.min(totalPages, currentPage + 1)})" 
            class="w-10 h-10 flex items-center justify-center rounded-lg border border-gray-300 hover:bg-gray-50 ${currentPage === totalPages ? 'opacity-50 cursor-not-allowed' : ''}">
            <i class="fas fa-chevron-right text-gray-500"></i>
        </button>
    `;

                paginationContainer.innerHTML = paginationHtml;
            }

            // í˜ì´ì§€ ë³€ê²½ í•¨ìˆ˜
            function changePage(page) {
                // í˜„ì¬ í‘œì‹œëœ ë¬¸ì˜ì‚¬í•­ ë°ì´í„°ì™€ í•¨ê»˜ ë‹¤ì‹œ ë Œë”ë§
                renderAdminInquiries(adminInquiries, page);
            }

            // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ: ëª¨ë“  ë¬¸ì˜ì‚¬í•­ ëª©ë¡ ë¡œë“œ
            async function loadAdminInquiries() {
                try {
                    // í•„í„° ê°’ ê°€ì ¸ì˜¤ê¸°
                    const statusFilter = document.getElementById('adminInquiryStatusFilter').value || 'all';
                    const categoryFilter = document.getElementById('adminInquiryCategoryFilter').value || 'all';
                    const searchTerm = document.getElementById('adminInquirySearch').value || '';

                    const response = await apiRequest('/api/admin/inquiries', {
                        method: 'POST',
                        body: JSON.stringify({
                            status: statusFilter,
                            category: categoryFilter,
                            search: searchTerm
                        })
                    });

                    if (response.success) {
                        adminInquiries = response.data || [];
                        // ì²« í˜ì´ì§€ë¶€í„° ë Œë”ë§
                        renderAdminInquiries(adminInquiries, 1);
                    } else {
                        showAlert('ë¬¸ì˜ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                        document.getElementById('adminInquiriesList').innerHTML = `
                <tr>
                    <td colspan="7" class="px-6 py-10 text-center text-gray-500">
                        ë¬¸ì˜ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
                    </td>
                </tr>
            `;
                    }
                } catch (error) {
                    console.error('Admin inquiries fetch error:', error);
                    document.getElementById('adminInquiriesList').innerHTML = `
            <tr>
                <td colspan="7" class="px-6 py-10 text-center text-gray-500">
                    ë¬¸ì˜ì‚¬í•­ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.
                </td>
            </tr>
        `;
                }
            }

            // ì‚¬ìš©ì & ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” í•¨ìˆ˜ì— ë¬¸ì˜ì‚¬í•­ ë¡œë“œ ì¶”ê°€
            const originalInitUserDashboard = window.initializeUserDashboard;
            window.initializeUserDashboard = async function () {
                await originalInitUserDashboard.apply(this, arguments);
                // ì‚¬ìš©ì ë¬¸ì˜ì‚¬í•­ ë¡œë“œ
                await loadUserInquiries();
            };

            const originalInitAdminDashboard = window.initializeAdminDashboard;
            window.initializeAdminDashboard = async function () {
                await originalInitAdminDashboard.apply(this, arguments);

                // ê´€ë¦¬ì ë¬¸ì˜ì‚¬í•­ ì„¹ì…˜ í‘œì‹œ (ê´€ë¦¬ìë§Œ)
                const inquiryManagementSection = document.getElementById('inquiryManagementSection');
                if (inquiryManagementSection) {
                    inquiryManagementSection.style.display = 'block';
                }

                // ê´€ë¦¬ì ë¬¸ì˜ì‚¬í•­ ë¡œë“œ
                await loadAdminInquiries();
            };

        </script>

        <!-- íŒì—… ëª¨ë‹¬ -->
        <div id="welcomePopup" class="fixed inset-0 z-[9999] overflow-y-auto" aria-labelledby="modal-title"
            role="dialog" aria-modal="true">
            <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
                <!-- ë°°ê²½ ì˜¤ë²„ë ˆì´ -->
                <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>

                <!-- ëª¨ë‹¬ ì»¨í…ì¸  -->
                <div
                    class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-1">
                        <div class="bg-white p-6">
                            <!-- ìƒë‹¨ íƒ€ì´í‹€ê³¼ ë‹«ê¸° ë²„íŠ¼ -->
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold text-gray-900 flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary mr-2"
                                        fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    9ì›” ì˜ˆì•½ ì•ˆë‚´
                                </h3>
                                <button type="button" id="closePopup"
                                    class="text-gray-400 hover:text-gray-500 focus:outline-none">
                                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>

                            <!-- ë‚´ìš© -->
                            <div class="mt-2">
                                <div class="bg-blue-50 p-4 rounded-lg mb-4">
                                    <h4 class="text-blue-700 font-semibold mb-2">9ì›” ì˜ˆì•½ ì•ˆë‚´</h4>
                                    <p class="text-sm text-gray-700 mb-2">
                                        ì•ˆë…•í•˜ì„¸ìš”.<br>
                                        9ì›” ì˜ˆì•½ì´ 8ì›” 20ì¼ ì˜¤ì „ 9ì‹œë¶€í„° ì‹œì‘ë©ë‹ˆë‹¤.
                                    </p>
                                    <p class="text-sm text-blue-700 font-semibold">
                                        â€» 9ì›” í•œ ë‹¬ê°„ì˜ ì˜ˆì•½ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.
                                    </p>
                                </div>

                                <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-4">
                                    <div class="flex">
                                        <div class="flex-shrink-0">
                                            <svg class="h-5 w-5 text-yellow-500" xmlns="http://www.w3.org/2000/svg"
                                                viewBox="0 0 20 20" fill="currentColor">
                                                <path fill-rule="evenodd"
                                                    d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                                    clip-rule="evenodd" />
                                            </svg>
                                        </div>
                                        <div class="ml-3">
                                            <p class="text-sm text-yellow-700">
                                                ì£¼ì˜ì‚¬í•­<br>
                                                10ì›” ì´í›„ ì˜ˆì•½ê±´ì€ ëª¨ë‘ ì¼ê´„ ì·¨ì†Œë©ë‹ˆë‹¤.<br>
                                                ì˜ˆì•½ ì‹œ ì°¸ê³  ë¶€íƒë“œë¦½ë‹ˆë‹¤.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- í•˜ë‹¨ ë²„íŠ¼ -->
                            <div class="mt-4">
                                <button id="confirmPopup" type="button"
                                    class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary text-base font-medium text-white hover:bg-primary/90 focus:outline-none sm:text-sm">
                                    í™•ì¸í–ˆìŠµë‹ˆë‹¤
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- íŒì—… ìŠ¤í¬ë¦½íŠ¸ -->
        <script>
            // í˜ì´ì§€ ë¡œë“œ ì‹œ íŒì—… í‘œì‹œ
            document.addEventListener('DOMContentLoaded', function () {
                const popup = document.getElementById('welcomePopup');
                const closeBtn = document.getElementById('closePopup');
                const confirmBtn = document.getElementById('confirmPopup');

                // ë‹«ê¸° ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
                closeBtn.addEventListener('click', function () {
                    closeWelcomePopup();
                });

                // í™•ì¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
                confirmBtn.addEventListener('click', function () {
                    closeWelcomePopup();
                });

                // ESC í‚¤ ëˆ„ë¥¼ ë•Œ íŒì—… ë‹«ê¸°
                document.addEventListener('keydown', function (event) {
                    if (event.key === 'Escape') {
                        closeWelcomePopup();
                    }
                });

                // íŒì—… ë‹«ê¸° í•¨ìˆ˜
                function closeWelcomePopup() {
                    popup.classList.add('opacity-0');
                    setTimeout(() => {
                        popup.style.display = 'none';
                    }, 300);

                    // ì¿ í‚¤ ì €ì¥ (24ì‹œê°„ ë™ì•ˆ ë‹¤ì‹œ ë³´ì§€ ì•Šê¸°)
                    const date = new Date();
                    date.setTime(date.getTime() + (24 * 60 * 60 * 1000));
                    document.cookie = "welcomePopupShown=true; expires=" + date.toUTCString() + "; path=/";
                }

                // ì¿ í‚¤ í™•ì¸ (ì´ë¯¸ ë³¸ ì‚¬ìš©ìì—ê²ŒëŠ” í‘œì‹œí•˜ì§€ ì•ŠìŒ)
                function getCookie(name) {
                    const value = `; ${document.cookie}`;
                    const parts = value.split(`; ${name}=`);
                    if (parts.length === 2) return parts.pop().split(';').shift();
                }

                // íŒì—…ì„ ì´ë¯¸ ë´¤ëŠ”ì§€ í™•ì¸
                const popupShown = getCookie('welcomePopupShown');
                if (popupShown) {
                    popup.style.display = 'none';
                } else {
                    popup.style.display = 'block';
                    popup.classList.add('opacity-100');
                }
            });
        </script>

</body>

</html>
